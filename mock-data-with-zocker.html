<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width" name=viewport> <meta content="" http-equiv=content-security-policy> <link href=./_app/immutable/assets/Metadata.a576926e.css rel=stylesheet> <link href=./_app/immutable/assets/3.affff02e.css rel=stylesheet> <link href=./_app/immutable/entry/start.3858d677.js rel=modulepreload> <link href=./_app/immutable/chunks/index.fae6157f.js rel=modulepreload> <link href=./_app/immutable/chunks/singletons.1db90c5f.js rel=modulepreload> <link href=./_app/immutable/chunks/index.71ef68dd.js rel=modulepreload> <link href=./_app/immutable/entry/app.dc1012b5.js rel=modulepreload> <link href=./_app/immutable/chunks/preload-helper.41c905a7.js rel=modulepreload> <link href=./_app/immutable/nodes/0.d209e8b5.js rel=modulepreload> <link href=./_app/immutable/nodes/2.d757c264.js rel=modulepreload> <link href=./_app/immutable/chunks/Metadata.f1eb02aa.js rel=modulepreload> <link href=./_app/immutable/chunks/stores.f0397ada.js rel=modulepreload> <link href=./_app/immutable/chunks/Icon.a577d665.js rel=modulepreload> <link href=./_app/immutable/chunks/theme.66b0c148.js rel=modulepreload> <link href=./_app/immutable/nodes/3.543cf056.js rel=modulepreload> <link href=./_app/immutable/nodes/12.a19bf1f0.js rel=modulepreload><title>Never write Mock Data again, with Zocker</title><!-- HEAD_svelte-1quh51c_START --><script>if("localStorage"in window){const a="dark"===localStorage.getItem("theme"),b="light"===localStorage.getItem("theme"),c=!a&&!b;if(a)document.documentElement.classList.add("dark");else if(b)document.documentElement.classList.remove("dark");else if(c){const d=window.matchMedia("(prefers-color-scheme: dark)");d.matches?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))}}</script><!-- HEAD_svelte-1quh51c_END --><!-- HEAD_svelte-170d11p_START --><meta content="Never write Mock Data again, with Zocker" name=og:title><meta content="Never write Mock Data again, with Zocker" name=twitter:title><meta content=website name=og:type> <meta content=/og/Never%20write%20Mock%20Data%20again,%20with%20Zocker.png name=og:image><link href=/_app/immutable/assets/favicon.8fdfb9af.png rel=icon><meta content="Over tha last couple weeks I've been building a library to generate mock data for my projects. Today I'm happy to announce the first stable release of Zocker, a Schema first Mock Data Generator." name=description><meta content="Loris Sigrist" name=author><meta content=2023-05-09T00:00:00.000Z name=date><!-- HEAD_svelte-170d11p_END --> </head> <body data-sveltekit-preload-data=hover> <header class="flex flex-row container justify-between mx-auto print:hidden px-4 py-4"><div class="flex items-center flex-row gap-4" id=header-start><a href=/ class="flex items-center flex-row gap-3"><img alt="Loris Sigrist looking very handsome" class="aspect-square rounded-full w-9" height=412 src=/_app/immutable/assets/avatar.4558b389.png style=background-color:#ababab width=412> <span class="font-bold text-md">Loris Sigrist</span></a></div> <div class="flex items-center gap-2 flex-row sm:gap-4" id=header-end><a href=https://sigrist.dev/dithering target=_blank class="flex items-center gap-2 rounded-md dark:text-gray-200 hover:bg-gray-100 hover:dark:bg-gray-800 p-1 sm:px-3 text-gray-800"><span class="hidden sm:block">Dither Studio</span></a> <a href=https://zocker.sigrist.dev/ target=_blank class="flex items-center gap-2 rounded-md dark:text-gray-200 hover:bg-gray-100 hover:dark:bg-gray-800 p-1 sm:px-3 text-gray-800"><span class="hidden sm:block">Zocker</span></a> <a href=https://t18s.sigrist.dev/ target=_blank class="flex items-center gap-2 rounded-md dark:text-gray-200 hover:bg-gray-100 hover:dark:bg-gray-800 p-1 sm:px-3 text-gray-800"><span class="hidden sm:block">t18s</span></a> <a href=https://www.github.com/LorisSigrist target=_blank class="flex items-center gap-2 rounded-md dark:text-gray-200 hover:bg-gray-100 hover:dark:bg-gray-800 p-1 sm:px-3 text-gray-800"><span><svg class="h-4 w-4" fill=none height=1024 viewBox="0 0 1024 1024" width=1024 xmlns=http://www.w3.org/2000/svg><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z" clip-rule=evenodd fill=currentColor fill-rule=evenodd transform=scale(64)></path></svg></span> <span class="hidden sm:block">Github</span></a> <a href=mailto:loris@sigrist.dev class="flex items-center gap-2 rounded-md bg-black dark:bg-white dark:text-black md:px-3 px-1 py-1 text-white"><svg class="h-4 w-4" fill=none height=100% viewBox="0 0 24 24" width=100% xmlns=http://www.w3.org/2000/svg aria-hidden=true stroke=currentColor stroke-width=1.5><path d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" stroke-linecap=round stroke-linejoin=round></path></svg> <span class="hidden md:block">Contact</span></a> <button class="rounded-md hover:bg-gray-100 hover:dark:bg-gray-800 aspect-square p-2" title="Toggle Theme"> <div class="contents dark:hidden"><svg class="h-4 w-4" fill=none height=100% viewBox="0 0 24 24" width=100% xmlns=http://www.w3.org/2000/svg aria-hidden=true stroke=currentColor stroke-width=1.5 slot=light><path d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" stroke-linecap=round stroke-linejoin=round></path></svg></div> <div class="hidden dark:contents"><svg class="h-4 w-4" fill=none height=100% viewBox="0 0 24 24" width=100% xmlns=http://www.w3.org/2000/svg aria-hidden=true stroke=currentColor stroke-width=1.5 slot=dark><path d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" stroke-linecap=round stroke-linejoin=round></path></svg></div></button></div></header> <article class="container mx-auto px-4 dark:prose-invert max-w-[70ch] my-8 print:m-0 print:p-0 print:w-100 prose prose-slate"><h1 id=never-write-mock-data-again-with-zocker><a href=#never-write-mock-data-again-with-zocker>Never write Mock-Data again, with Zocker</a></h1> <p>The trend of zod-driven-development continues! This time, we’re going to use zod to generate sensible mock-data for our tests.</p> <h2 id=writing-mock-data-is-the-worst><a href=#writing-mock-data-is-the-worst>Writing Mock Data is the worst</a></h2> <p>When writing tests, you often need to provide some mock-data to test your code against. This can be a real pain, especially if you need lot’s of it, and if it’s complex.</p> <p>Most mock-data generation libraries, such as the excellent <a href=https://www.npmjs.com/package/@faker-js/faker target=_blank rel="noopener noreferrer">faker</a>, supply only individual fields, not entire data-structures.</p> <p>Manually assembling these fields into a data-structure is tedious, and maintenance-heavy. </p> <h2 id=enter-zocker><a href=#enter-zocker>Enter Zocker</a></h2> <p><a href=https://zocker.sigrist.dev target=_blank rel="noopener noreferrer">Zocker</a> is a library I’ve built to forever eliminate the pain of writing and maintaining mock-data. It uses your zod-schemas as a guide to generate sensible and realistic mock-data for you. This way you can focus on writing tests, not on writing mock-data. Data generation does not get harder if you need more data, or if your data gets more complex. It’s all handled for you.</p> <h3 id=getting-started><a href=#getting-started>Getting Started</a></h3> <p>Obviously, install it first:</p> <pre class=language-bash><!-- HTML_TAG_START --><code class=language-bash><span class="token function">npm</span> <span class="token function">install</span> --save-dev zocker</code><!-- HTML_TAG_END --></pre> <p>Then, in your test-file, import the <code>zocker</code> function and pass it your zod-schema:</p> <pre class=language-typescript><!-- HTML_TAG_START --><code class=language-typescript><span class="token keyword">import</span> <span class="token punctuation">{</span> z <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zod'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> zocker <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zocker'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> schema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	age<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	isAwesome<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">boolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mockData <span class="token operator">=</span> <span class="token function">zocker</span><span class="token punctuation">(</span>schema<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { name: "Jimmy Smith", age: 42, isAwesome: true }</span></code><!-- HTML_TAG_END --></pre> <p>And voilà! You have your mock-data.</p> <p>That was obviously a very simple example. Zocker can handle much more complex schemas, including cyclic schemas, anys, unkowns, regular expressions, and much more. This here works just fine:</p> <pre class=language-typescript><!-- HTML_TAG_START --><code class=language-typescript><span class="token keyword">const</span> difficult_schema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	id<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	age<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">multipleOf</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	isAwesome<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">boolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	friends<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	zip<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">regex</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token language-regex regex-source">^[0-9]{5}$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	children<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
		z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		z<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> difficult_schema<span class="token punctuation">)</span>
	<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mockData <span class="token operator">=</span> <span class="token function">zocker</span><span class="token punctuation">(</span>schema<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre> <h3 id=supplying-values><a href=#supplying-values>Supplying values</a></h3> <p>When testing specific edge-cases, you often want to supply your own values for certain fields. </p> <p>This can be done by “supplying” your own value, or generator function, for a schema. That value is then used whenever a value is needed for a (sub)schema that matches the given schema by reference.</p> <p>This is easier to undestand with an example:</p> <pre class=language-typescript><!-- HTML_TAG_START --><code class=language-typescript><span class="token keyword">const</span> user <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	age<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mockData <span class="token operator">=</span> <span class="token function">zocker</span><span class="token punctuation">(</span>schema<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">supply</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>shape<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">'Jimmy Smith'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// { name: "Jimmy Smith", age: 42 } - The name is now fixed</span></code><!-- HTML_TAG_END --></pre> <h3 id=limitations><a href=#limitations>Limitations</a></h3> <p>There are a few limitations though. Zocker will never be able to generate data for preprocess or refinement functions. At least not out of the box. We can however supply our own values for those (sub)schemas, and side-step the issue.</p> <h3 id=repeatability><a href=#repeatability>Repeatability</a></h3> <p>By default, zocker will generate a new random value for each schema. This is great for most cases, but can lead to flaky tests if you’re not careful. If you want to generate the same data every time, you can set a seed using the <code>setSeed</code> method. This will generate the same data every time.</p> <pre class=language-typescript><!-- HTML_TAG_START --><code class=language-typescript><span class="token keyword">const</span> mockData <span class="token operator">=</span> <span class="token function">zocker</span><span class="token punctuation">(</span>schema<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSeed</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre> <h2 id=conclusion><a href=#conclusion>Conclusion</a></h2> <p>I hope this article has given you a taste of what zocker can do. If you want to learn more, check out the <a href=https://zocker.sigrist.dev target=_blank rel="noopener noreferrer">documentation</a>. In my own use, zocker has been a huge time-saver. I hope it can help you too!</article> <div class="bg-blue-700 h-3 progress-bar svelte-6gbik3"></div> <script>{__sveltekit_fj5clb={base:new URL(".",location).pathname.slice(0,-1),env:{}};const a=document.currentScript.parentElement,b=[null,null,null,null];Promise.all([import("./_app/immutable/entry/start.3858d677.js"),import("./_app/immutable/entry/app.dc1012b5.js")]).then(([e,r])=>{e.start(r,a,{node_ids:[0,2,3,12],data:b,form:null,error:null})}),"serviceWorker"in navigator&&addEventListener("load",function(){navigator.serviceWorker.register("./service-worker.js")})}</script> 
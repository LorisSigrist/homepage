import{S as Ze,i as je,s as $e,a as I,k as d,J as et,h as a,c as S,l as _,m as v,n as i,b as A,G as c,U as C,H as Ce,o as tt,V as rt,q as F,r as X,T as Ge,W as ot,X as ke,Y as O,Z as Me,_ as it,u as Oe,$ as me,a0 as nt,a1 as Je,a2 as st}from"../chunks/index.919e2970.js";/* empty css                          */const at=""+new URL("../assets/img.58b560b7.jpg",import.meta.url).href,lt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAARtJREFUGBkBEAHv/gQAgKB/aX+hf1t/oX9pf6F/BL+Bv4G/gb+Bv4G/gb+Bv4EEcX8xf3F/MX9xfzF/cX8xfwS/gb+Bv4G/gb+Bv4G/gb+BBB1/XX8Nf01/HX9dfw1/TX8Ev4G/gb+Bv4G/gb+Bv4G/gQRxfzF/cX8xf3F/MX9xfzF/BL+Bv4G/gb+Bv4G/gb+Bv4EECH9Ifxh/WH8Ef0R/FH9UfwS/gb+Bv4G/gb+Bv4G/gb+BBHF/MX9xfzF/cX8xf3F/MX8Ev4G/gb+Bv4G/gb+Bv4G/gQQdf11/DX9Nfx1/XX8Nf01/BL+Bv4G/gb+Bv4G/gb+Bv4EEcX8xf3F/MX9xfzF/cX8xfwS/gb+Bv4G/gb+Bv4G/gb+BIZOCkuKxtP8AAAAASUVORK5CYII=",ze={width:16,height:16},ut=""+new URL("../assets/blue_noise.b61cfddd.png",import.meta.url).href,Ve={width:470,height:470},ct=""+new URL("../assets/white_noise.2f37d8a6.png",import.meta.url).href,Ye={width:256,height:256},ft=`precision highp float;

attribute vec2 position;
varying vec2 fragCoord;

// Just a simple vertex shader that passes on the 2d position to the fragment shader
void main() {
    fragCoord.x = position.x * 0.5 + 0.5;
    fragCoord.y = position.y * 0.5 + 0.5;
    
    gl_Position = vec4(position, 0.0, 1.0);
}`,ht=`precision highp float;
varying vec2 fragCoord;

uniform sampler2D uSampler;
uniform float uThreshold;
uniform sampler2D uNoiseSampler;
uniform vec2 uNoiseSamplerSize;

uniform float uNoise;
uniform float uMonochrome;

uniform vec2 uSize;

uniform vec3 uDarkColor;
uniform vec3 uLightColor;

void main(void) {
    //Map the current image pixel to the noise texture
    vec2 imgPixel = vec2(fragCoord.x * uSize.x, fragCoord.y * uSize.y);
    vec2 noisePixel = vec2( mod(imgPixel.x, uNoiseSamplerSize.x),  mod(imgPixel.y, uNoiseSamplerSize.y));
    
    vec2 noiseUV = vec2(noisePixel.x / uNoiseSamplerSize.x, noisePixel.y / uNoiseSamplerSize.y);
    float noise = (texture2D(uNoiseSampler, noiseUV).r - 0.5) * 2.0 * uNoise;

    //Get the color of the current pixel from the image
    vec4 color = texture2D(uSampler, fragCoord);

   // Convert to grayscale using the NTSC standard coefficients
    float gray = dot(color.rgb, vec3(0.299, 0.587, 0.114));    

    color.r = color.r * (1.0 - uMonochrome) + gray * uMonochrome;
    color.g = color.g * (1.0 - uMonochrome) + gray * uMonochrome;
    color.b = color.b * (1.0 - uMonochrome) + gray * uMonochrome;

    vec3 thresholds = vec3(
        step(uThreshold, color.r + noise),
        step(uThreshold, color.g + noise),
        step(uThreshold, color.b + noise)
    );

    if(uMonochrome > 0.0) {
        color.rgb = vec3(
            mix(uDarkColor.r, uLightColor.r, thresholds.r),
            mix(uDarkColor.g, uLightColor.g, thresholds.g),
            mix(uDarkColor.b, uLightColor.b, thresholds.b)
        );
    } else {
        color.rgb = thresholds;
    }

    gl_FragColor = color;
}`;function mt(e,n,o){const t=We(e,e.VERTEX_SHADER,n),f=We(e,e.FRAGMENT_SHADER,o),s=e.createProgram();if(!s)throw new Error("Failed to create shader program");if(e.attachShader(s,t),e.attachShader(s,f),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS))throw Error(`Unable to initialize the shader program: ${e.getProgramInfoLog(s)}`);return s}function We(e,n,o){const t=e.createShader(n);if(!t)throw new Error("Failed to create shader");if(e.shaderSource(t,o),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))throw Error(`An error occurred compiling the shaders: ${e.getShaderInfoLog(t)}`);return t}function Ue(e,n,o=()=>{}){const t=e.createTexture();if(!t)throw new Error("Failed to create texture");e.bindTexture(e.TEXTURE_2D,t);const f=0,s=e.RGBA,h=1,l=1,p=0,E=e.RGBA,m=e.UNSIGNED_BYTE,D=new Uint8Array([0,0,255,255]);e.texImage2D(e.TEXTURE_2D,f,s,h,l,p,E,m,D);const g=new Image;return g.onload=()=>{e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,f,s,E,m,g),de(g.width)&&de(g.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),o()},g.src=n,t}function dt(e){const n=e.createTexture();if(!n)throw new Error("Failed to create texture");e.bindTexture(e.TEXTURE_2D,n);const o=0,t=e.RGBA,f=1,s=1,h=0,l=e.RGBA,p=e.UNSIGNED_BYTE,E=new Uint8Array([0,0,255,255]);return e.texImage2D(e.TEXTURE_2D,o,t,f,s,h,l,p,E),n}function _t(e,n,o){const f=e.RGBA,s=e.RGBA,h=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,f,s,h,o),de(o.width)&&de(o.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR))}function de(e){return(e&e-1)===0}function pt(e){const n=e.createBuffer(),o=e.createBuffer(),t=[-1,1,-1,-1,1,-1,1,1],f=[3,2,1,3,1,0];return e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(f),e.STATIC_DRAW),{vertex_buffer:n,index_buffer:o}}function Et(e,n){let o=n;const t=e.getContext("webgl",{preserveDrawingBuffer:!0});if(!t){alert("WebGL not supported");return}const f=()=>{_t(t,R,o.image)};t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT);const s=mt(t,ft,ht),{vertex_buffer:h,index_buffer:l}=pt(t),p=t.getAttribLocation(s,"position");t.vertexAttribPointer(p,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(p);const E=t.getUniformLocation(s,"uSampler"),m=t.getUniformLocation(s,"uThreshold"),D=t.getUniformLocation(s,"uNoiseSampler"),g=t.getUniformLocation(s,"uNoise"),b=t.getUniformLocation(s,"uSize"),z=t.getUniformLocation(s,"uNoiseSamplerSize"),V=t.getUniformLocation(s,"uMonochrome"),J=t.getUniformLocation(s,"uDarkColor"),G=t.getUniformLocation(s,"uLightColor"),R=dt(t);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),f();const Y=Ue(t,lt,T);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0);const y=Ue(t,ut,T);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0);const k=Ue(t,ct,T);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.useProgram(s);let L=null;const B=()=>{switch(t.viewport(0,0,o.width,o.height),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.bindBuffer(t.ARRAY_BUFFER,h),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,l),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,R),t.uniform1i(E,0),o.mode){case"bayer":t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,Y),t.uniform1i(D,1),t.uniform2f(z,ze.width,ze.height);break;case"blue_noise":t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,y),t.uniform1i(D,1),t.uniform2f(z,Ve.width,Ve.height);break;case"white_noise":t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,k),t.uniform1i(D,1),t.uniform2f(z,Ye.width,Ye.height);break}t.uniform1f(m,o.threshold),t.uniform1f(g,o.noiseIntensity),t.uniform2f(b,o.width,o.height),t.uniform1f(V,o.monochrome?1:0),t.uniform3f(J,...He(o.colorDark)),t.uniform3f(G,...He(o.colorLight)),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)};function T(){L=requestAnimationFrame(()=>{B(),L=null})}return T(),{update(U){const M=o.image!==U.image;o=U,M&&f(),T()},destroy(){L!==null&&cancelAnimationFrame(L)}}}function He(e){const n=parseInt(e.slice(1,3),16)/255,o=parseInt(e.slice(3,5),16)/255,t=parseInt(e.slice(5,7),16)/255;return[n,o,t]}const{document:Ke}=rt;function qe(e){let n,o,t,f,s,h,l,p,E,m,D,g,b,z,V,J,G,R,Y,y,k,L,B,T,U,M,Z,j,_e,oe,ee,W,$,pe,Ee,te,x,ie,P,H,Te,K,ve,q,Ae,ne,N,se,ae,Q,ge,be,Be,w=e[3]&&Qe(e);return{c(){n=d("img"),t=I(),f=d("div"),s=d("label"),h=F("Threshold "),l=F(e[1]),p=I(),E=d("div"),m=d("input"),D=I(),g=d("div"),b=d("label"),z=F("Noise Intensity "),V=F(e[2]),J=I(),G=d("div"),R=d("input"),Y=I(),y=d("div"),k=d("div"),L=d("input"),B=I(),T=d("div"),U=d("label"),M=F("Monochrome"),Z=I(),j=d("p"),_e=F("If the dither should be monochrome, or in color"),oe=I(),w&&w.c(),ee=I(),W=d("div"),$=d("label"),pe=F("Width"),Ee=I(),te=d("div"),x=d("input"),ie=I(),P=d("select"),H=d("option"),Te=F("Bayer"),K=d("option"),ve=F("Blue Noise"),q=d("option"),Ae=F("White Noise"),ne=I(),N=d("canvas"),ae=I(),Q=d("button"),ge=F("Save"),this.h()},l(r){n=_(r,"IMG",{src:!0,alt:!0,class:!0}),t=S(r),f=_(r,"DIV",{});var u=v(f);s=_(u,"LABEL",{for:!0,class:!0});var re=v(s);h=X(re,"Threshold "),l=X(re,e[1]),re.forEach(a),p=S(u),E=_(u,"DIV",{class:!0});var we=v(E);m=_(we,"INPUT",{type:!0,min:!0,id:!0,max:!0,step:!0,class:!0}),we.forEach(a),u.forEach(a),D=S(r),g=_(r,"DIV",{});var le=v(g);b=_(le,"LABEL",{for:!0,class:!0});var Re=v(b);z=X(Re,"Noise Intensity "),V=X(Re,e[2]),Re.forEach(a),J=S(le),G=_(le,"DIV",{class:!0});var Ie=v(G);R=_(Ie,"INPUT",{type:!0,min:!0,id:!0,max:!0,step:!0,class:!0}),Ie.forEach(a),le.forEach(a),Y=S(r),y=_(r,"DIV",{class:!0});var ue=v(y);k=_(ue,"DIV",{class:!0});var Se=v(k);L=_(Se,"INPUT",{type:!0,class:!0}),Se.forEach(a),B=S(ue),T=_(ue,"DIV",{class:!0});var ce=v(T);U=_(ce,"LABEL",{for:!0,class:!0});var De=v(U);M=X(De,"Monochrome"),De.forEach(a),Z=S(ce),j=_(ce,"P",{id:!0,class:!0});var Le=v(j);_e=X(Le,"If the dither should be monochrome, or in color"),Le.forEach(a),ce.forEach(a),ue.forEach(a),oe=S(r),w&&w.l(r),ee=S(r),W=_(r,"DIV",{});var fe=v(W);$=_(fe,"LABEL",{for:!0,class:!0});var ye=v($);pe=X(ye,"Width"),ye.forEach(a),Ee=S(fe),te=_(fe,"DIV",{class:!0});var Ne=v(te);x=_(Ne,"INPUT",{type:!0,min:!0,id:!0,step:!0,class:!0}),Ne.forEach(a),fe.forEach(a),ie=S(r),P=_(r,"SELECT",{});var he=v(P);H=_(he,"OPTION",{});var xe=v(H);Te=X(xe,"Bayer"),xe.forEach(a),K=_(he,"OPTION",{});var Pe=v(K);ve=X(Pe,"Blue Noise"),Pe.forEach(a),q=_(he,"OPTION",{});var Fe=v(q);Ae=X(Fe,"White Noise"),Fe.forEach(a),he.forEach(a),ne=S(r),N=_(r,"CANVAS",{class:!0,width:!0,height:!0}),v(N).forEach(a),ae=S(r),Q=_(r,"BUTTON",{class:!0});var Xe=v(Q);ge=X(Xe,"Save"),Xe.forEach(a),this.h()},h(){var r;Ge(n.src,o=(r=e[8])==null?void 0:r.src)||i(n,"src",o),i(n,"alt",""),i(n,"class","w-full pixelated svelte-1gkt69q"),i(s,"for","threshold"),i(s,"class","block text-sm font-medium leading-6 text-gray-900"),i(m,"type","range"),i(m,"min","0"),i(m,"id","threshold"),i(m,"max","1"),i(m,"step","0.01"),i(m,"class","block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),i(E,"class","mt-2"),i(b,"for","noise"),i(b,"class","block text-sm font-medium leading-6 text-gray-900"),i(R,"type","range"),i(R,"min","0"),i(R,"id","noise"),i(R,"max","1.5"),i(R,"step","0.01"),i(R,"class","block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),i(G,"class","mt-2"),i(L,"type","checkbox"),i(L,"class","h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600"),i(k,"class","flex h-6 items-center"),i(U,"for","comments"),i(U,"class","font-medium text-gray-900"),i(j,"id","comments-description"),i(j,"class","text-gray-500"),i(T,"class","ml-3 text-sm leading-6"),i(y,"class","relative flex items-start"),i($,"for","width"),i($,"class","block text-sm font-medium leading-6 text-gray-900"),i(x,"type","number"),i(x,"min","10"),i(x,"id","width"),i(x,"step","1"),i(x,"class","block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),i(te,"class","mt-2"),H.__value="bayer",H.value=H.__value,K.__value="blue_noise",K.value=K.__value,q.__value="white_noise",q.value=q.__value,e[7]===void 0&&ot(()=>e[19].call(P)),i(N,"class","w-full svelte-1gkt69q"),i(N,"width",e[0]),i(N,"height",e[9]),ke(N,"pixelated",e[6]),i(Q,"class","")},m(r,u){A(r,n,u),A(r,t,u),A(r,f,u),c(f,s),c(s,h),c(s,l),c(f,p),c(f,E),c(E,m),O(m,e[1]),A(r,D,u),A(r,g,u),c(g,b),c(b,z),c(b,V),c(g,J),c(g,G),c(G,R),O(R,e[2]),A(r,Y,u),A(r,y,u),c(y,k),c(k,L),L.checked=e[3],c(y,B),c(y,T),c(T,U),c(U,M),c(T,Z),c(T,j),c(j,_e),A(r,oe,u),w&&w.m(r,u),A(r,ee,u),A(r,W,u),c(W,$),c($,pe),c(W,Ee),c(W,te),c(te,x),O(x,e[0]),A(r,ie,u),A(r,P,u),c(P,H),c(H,Te),c(P,K),c(K,ve),c(P,q),c(q,Ae),Me(P,e[7],!0),A(r,ne,u),A(r,N,u),A(r,ae,u),A(r,Q,u),c(Q,ge),be||(Be=[C(m,"change",e[13]),C(m,"input",e[13]),C(R,"change",e[14]),C(R,"input",e[14]),C(L,"change",e[15]),C(x,"input",e[18]),C(P,"change",e[19]),it(se=Et.call(null,N,{image:e[8],threshold:e[1],noiseIntensity:e[2],monochrome:e[3],colorLight:e[4],colorDark:e[5],mode:e[7],width:e[0],height:e[9]})),C(Q,"click",e[11])],be=!0)},p(r,u){var re;u&256&&!Ge(n.src,o=(re=r[8])==null?void 0:re.src)&&i(n,"src",o),u&2&&Oe(l,r[1]),u&2&&O(m,r[1]),u&4&&Oe(V,r[2]),u&4&&O(R,r[2]),u&8&&(L.checked=r[3]),r[3]?w?w.p(r,u):(w=Qe(r),w.c(),w.m(ee.parentNode,ee)):w&&(w.d(1),w=null),u&1&&me(x.value)!==r[0]&&O(x,r[0]),u&128&&Me(P,r[7]),u&1&&i(N,"width",r[0]),u&512&&i(N,"height",r[9]),se&&nt(se.update)&&u&959&&se.update.call(null,{image:r[8],threshold:r[1],noiseIntensity:r[2],monochrome:r[3],colorLight:r[4],colorDark:r[5],mode:r[7],width:r[0],height:r[9]}),u&64&&ke(N,"pixelated",r[6])},d(r){r&&a(n),r&&a(t),r&&a(f),r&&a(D),r&&a(g),r&&a(Y),r&&a(y),r&&a(oe),w&&w.d(r),r&&a(ee),r&&a(W),r&&a(ie),r&&a(P),r&&a(ne),r&&a(N),r&&a(ae),r&&a(Q),be=!1,Je(Be)}}}function Qe(e){let n,o,t,f,s;return{c(){n=d("input"),o=I(),t=d("input"),this.h()},l(h){n=_(h,"INPUT",{type:!0}),o=S(h),t=_(h,"INPUT",{type:!0}),this.h()},h(){i(n,"type","color"),i(t,"type","color")},m(h,l){A(h,n,l),O(n,e[4]),A(h,o,l),A(h,t,l),O(t,e[5]),f||(s=[C(n,"input",e[16]),C(t,"input",e[17])],f=!0)},p(h,l){l&16&&O(n,h[4]),l&32&&O(t,h[5])},d(h){h&&a(n),h&&a(o),h&&a(t),f=!1,Je(s)}}}function Tt(e){let n,o,t,f,s,h,l=e[8]&&qe(e);return{c(){n=I(),o=d("div"),t=d("input"),f=I(),l&&l.c(),this.h()},l(p){et("svelte-1hm2pfs",Ke.head).forEach(a),n=S(p),o=_(p,"DIV",{class:!0});var m=v(o);t=_(m,"INPUT",{type:!0,id:!0,accept:!0}),f=S(m),l&&l.l(m),m.forEach(a),this.h()},h(){Ke.title="Dithering",i(t,"type","file"),i(t,"id","image-input"),i(t,"accept","image/*"),i(o,"class","max-w-xl mx-auto px-4")},m(p,E){A(p,n,E),A(p,o,E),c(o,t),c(o,f),l&&l.m(o,null),s||(h=C(t,"input",e[10]),s=!0)},p(p,[E]){p[8]?l?l.p(p,E):(l=qe(p),l.c(),l.m(o,null)):l&&(l.d(1),l=null)},i:Ce,o:Ce,d(p){p&&a(n),p&&a(o),l&&l.d(),s=!1,h()}}}function vt(e,n,o){let t,f=.33,s=.3,h=!1,l="#ede6cc",p="#21263f",E=!0,m=600,D=1,g="blue_noise",b=null;function z(B){const T=B.target.files[0];if(!T)return;const U=new FileReader;U.onload=M=>{if(typeof U.result!="string")return;const Z=new Image;Z.onload=()=>{o(8,b=Z),o(12,D=b.width/b.height)},Z.src=U.result},U.readAsDataURL(T)}tt(()=>{const B=new Image;B.onload=()=>{o(8,b=B),o(12,D=b.width/b.height)},B.src=at,o(6,E=Number.isInteger(window.devicePixelRatio))});function V(){const B=document.querySelector("canvas");if(!B)return;const T=document.createElement("canvas");T.width=B.width,T.height=B.height;const U=T.getContext("2d");if(!U)return;U.drawImage(B,0,0,m,t);const M=document.createElement("a");M.download="dithered.png",M.href=T.toDataURL("image/png"),M.click()}function J(){f=me(this.value),o(1,f)}function G(){s=me(this.value),o(2,s)}function R(){h=this.checked,o(3,h)}function Y(){l=this.value,o(4,l)}function y(){p=this.value,o(5,p)}function k(){m=me(this.value),o(0,m)}function L(){g=st(this),o(7,g)}return e.$$.update=()=>{e.$$.dirty&4097&&o(9,t=m/D)},[m,f,s,h,l,p,E,g,b,t,z,V,D,J,G,R,Y,y,k,L]}class bt extends Ze{constructor(n){super(),je(this,n,vt,Tt,$e,{})}}export{bt as component};

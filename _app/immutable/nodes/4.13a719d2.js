var Pn=Object.defineProperty;var Nn=(t,e,n)=>e in t?Pn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ee=(t,e,n)=>(Nn(t,typeof e!="symbol"?e+"":e,n),n);import{S as le,i as ue,s as fe,k as y,q as Q,a as P,y as W,l as k,m as I,r as J,h as b,c as N,z,n as h,b as O,G as v,A as V,M as ee,g as D,d as R,O as Ge,B as H,P as gn,L as On,C as et,D as tt,E as nt,F as it,Q as Et,R as Ie,p as Se,T as Ue,U as At,V as Le,o as Bn,w as Z,W as ct,H as re,v as Xe,f as Fe,X as x,Y as $,e as rt,Z as Un,u as Ne,_ as st,$ as Dt,a0 as Xn,a1 as Bt,a2 as Fn}from"../chunks/index.ac0a233c.js";import{I as Te,P as _n,A as Wn,X as pn,L as zn,C as Je,b as Ke,c as bn,a as Vn}from"../chunks/Icon.8a6fbf2e.js";function Hn(){return{title:"Dithering",author:"Loris Sigrist",description:"Dither your Images right in the browser!"}}const Qr=Object.freeze(Object.defineProperty({__proto__:null,load:Hn},Symbol.toStringTag,{value:"Module"}));async function Yn(t,e,n="png"){const i=new OffscreenCanvas(t.width,t.height),o=i.getContext("2d");if(!o)return;o.drawImage(t,0,0,t.width,t.height);const s=await i.convertToBlob({type:"image/"+n,quality:1}),r=URL.createObjectURL(s),a=document.createElement("a");a.download=`${e}.${n}`,a.href=r,a.click(),a.remove(),URL.revokeObjectURL(r)}function vn(t){return new Promise((e,n)=>{t.type.startsWith("image/")||n(new Error("Not an image file"));const i=new FileReader;i.onload=o=>{if(typeof i.result!="string")return;const s=new Image;s.onload=()=>{e(s)},s.onerror=r=>{n(r)},s.src=i.result},i.onerror=o=>{n(o)},i.readAsDataURL(t)})}function Ut(t){const n=new OffscreenCanvas(t.width,t.height).getContext("2d");if(!n)throw new Error("Could not get canvas context");return n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height)}function de(t){const e=parseInt(t.slice(1,3),16),n=parseInt(t.slice(3,5),16),i=parseInt(t.slice(5,7),16);return[e,n,i]}function jn([t,e,n]){const i=o=>{const s=o.toString(16);return s.length==1?"0"+s:s};return"#"+i(t)+i(e)+i(n)}const Gn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAyNJREFUaEPVWjFW3DAQ/dOyqSEvB6AiTUJITcEtSJ8azkFq+uQUUFADCQ2pOAHbL2l/noy9q9Va1owseZMt4O16JM+fP39Gliwo+zkGcElyX0RAEpH/TyLyFcBNqdvL2IlIfheR0wGnY2D8338A+DLGlzFAmOt853A3Pvie5ZN5EMmFiMxyQSjHvQB4Y2HIAuSQ5H0i9zVpNKSdtfEAPgH4qQGkAkLyF4APHYhu4olAPYjIxxQYDZAXkjslnU5oZOmzp6E/AGZDYFJAsgWt1II6zdr5ov4OAVmQnJVkIgVOwVS0CPQCIXkL4CimiVAjE2vmTkQ+h2nWB+SA5GNNJhSRb0wifcZdeg/gtw9mA4gTxZaqk6l0A1jzfe3LRM0uKnAjU2t6CRlpqlRKA6nrNdMyKBhL/30gzyT3pnBCG/lUEwQwB/DW2S2B+FRoq9UUoBUlu8HQ/CF5JiIXqUGlr2uZGahebopzAN86ICthDPCpZWrivuKqnSyB1EwTbeQVmoiZiJDcFZH5f1atwhL+zjFyRfKkJiOJHN/o4BnMXDtGVPrQTL7NFYFjpPpSPaYRTXC0NlmM/IvVaxJGQo1oo2yxy2LEcoOm675W+eZTuql281VjxG+KVuA59pMzom2O1pKdZCS1ZI9d96Pqp1ZOtDVjHCNXAE40xrk2Q0CskY9o7NoxsktyPrazDzEzASPNEuW1I1b85AAxMrW5+s3VRNgkJ9bIssCfkbyoRUoNjXjV71xEXh+sVr1qdcJUkpmc1DIEdfWo2+rkGcCeYQK1aQ0grYY2Nx9C0VsXhkOoagBp79e7HeSq1yK1fa+mwTO0ADFUq8ENuo1qbGWmr3pZgBgCFd8ybVEcAHg0TJg0rQAkvYndgrkVkaNSfbIwkDsAqmOFJsIl9TIGSKAZ20GP31isGunLszFAgvmyjt46ZlwUdpJCGDAoBGTwvDN1GNqBaY6nc8GMBPIAoMjxdAfmEMB9DpgRQMq+MBA435z2xtZihTRS9RWONR8tzzBGRlTpHgYsa5A/iXvNCcDpyLXWVl9z6vP9mOQlgH3/Yg8jTwCKvnj2F9CvAivl1accAAAAAElFTkSuQmCC",qn=""+new URL("../assets/cat.58b560b7.jpg",import.meta.url).href,Zn="data:image/avif;base64,AAAAHGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZgAAAOptZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAImlsb2MAAAAAREAAAQABAAAAAAEOAAEAAAAAAAAApwAAACNpaW5mAAAAAAABAAAAFWluZmUCAAAAAAEAAGF2MDEAAAAAamlwcnAAAABLaXBjbwAAABNjb2xybmNseAACAAIABoAAAAAMYXYxQ4EEDAAAAAAUaXNwZQAAAAAAAAJyAAACcgAAABBwaXhpAAAAAAMICAgAAAAXaXBtYQAAAAAAAAABAAEEgYIDhAAAAK9tZGF0EgAKChkmZxnHggQEDQgylgERQAEEEEEA9NBi7JFlrqXV1mwMry34uIYK7WRdWYJ/ZZ0EIyWW8aLm92oz5LY0W+l2FiKsHpp4BB3Vrk+iwHuzboac7wmSHHHRWklZdZ2hpEAi4E31lf1tjXnXie8fh4lzApbqjH5Pj7ZN6761WygYVdc2zvJOsflFZstng6rQU/oulDZSO6fQWKvzpO9pseyXBLfms64=",Qn=""+new URL("../assets/david.0e7e3b46.png",import.meta.url).href;function Xt(t,e,n){const i=t.slice();return i[5]=e[n],i}function Ft(t){let e,n,i,o,s;function r(){return t[3](t[5])}return{c(){e=y("button"),n=y("img"),this.h()},l(a){e=k(a,"BUTTON",{class:!0});var l=I(e);n=k(l,"IMG",{class:!0,src:!0,alt:!0}),l.forEach(b),this.h()},h(){h(n,"class","aspect-square h-24 w-24 object-cover rounded-md shadow-md border-2 border-white"),On(n.src,i=t[5])||h(n,"src",i),h(n,"alt",""),h(e,"class","hover:opacity-75 transition-opacity")},m(a,l){O(a,e,l),v(e,n),o||(s=ee(e,"click",r),o=!0)},p(a,l){t=a},d(a){a&&b(e),o=!1,s()}}}function Jn(t){let e,n,i,o,s,r,a,l,u,f,c,d,m,p,g,E,_,w,A=t[0],T=[];for(let M=0;M<A.length;M+=1)T[M]=Ft(Xt(t,A,M));return f=new Te({props:{src:_n,class:"w-12 h-12 text-gray-400"}}),{c(){e=y("div"),n=y("div"),i=y("p"),o=Q("Select or Drop an Image to Start"),s=P(),r=y("div");for(let M=0;M<T.length;M+=1)T[M].c();a=P(),l=y("label"),u=y("div"),W(f.$$.fragment),c=P(),d=y("span"),m=Q("Choose an Image"),p=P(),g=y("input"),this.h()},l(M){e=k(M,"DIV",{class:!0});var Y=I(e);n=k(Y,"DIV",{class:!0});var L=I(n);i=k(L,"P",{class:!0});var B=I(i);o=J(B,"Select or Drop an Image to Start"),B.forEach(b),s=N(L),r=k(L,"DIV",{class:!0});var U=I(r);for(let j=0;j<T.length;j+=1)T[j].l(U);a=N(U),l=k(U,"LABEL",{for:!0,class:!0});var X=I(l);u=k(X,"DIV",{class:!0});var te=I(u);z(f.$$.fragment,te),te.forEach(b),c=N(X),d=k(X,"SPAN",{class:!0});var oe=I(d);m=J(oe,"Choose an Image"),oe.forEach(b),p=N(X),g=k(X,"INPUT",{type:!0,class:!0,id:!0,accept:!0}),X.forEach(b),U.forEach(b),L.forEach(b),Y.forEach(b),this.h()},h(){h(i,"class","text-2xl text-gray-500 text-center"),h(u,"class","grid place-items-center h-full w-full"),h(d,"class","sr-only"),h(g,"type","file"),h(g,"class","sr-only"),h(g,"id","image-input"),h(g,"accept","image/*"),h(l,"for","image-input"),h(l,"class","block spect-square h-24 w-24 object-cover rounded-md shadow-md border-2 border-white bg-white hover:bg-gray-100"),h(r,"class","flex gap-3 justify-center flex-wrap"),h(n,"class","grid gap-4"),h(e,"class","w-full h-full grid place-items-center px-8")},m(M,Y){O(M,e,Y),v(e,n),v(n,i),v(i,o),v(n,s),v(n,r);for(let L=0;L<T.length;L+=1)T[L]&&T[L].m(r,null);v(r,a),v(r,l),v(l,u),V(f,u,null),v(l,c),v(l,d),v(d,m),v(l,p),v(l,g),E=!0,_||(w=ee(g,"input",t[1]),_=!0)},p(M,[Y]){if(Y&5){A=M[0];let L;for(L=0;L<A.length;L+=1){const B=Xt(M,A,L);T[L]?T[L].p(B,Y):(T[L]=Ft(B),T[L].c(),T[L].m(r,a))}for(;L<T.length;L+=1)T[L].d(1);T.length=A.length}},i(M){E||(D(f.$$.fragment,M),E=!0)},o(M){R(f.$$.fragment,M),E=!1},d(M){M&&b(e),Ge(T,M),H(f),_=!1,w()}}}function Kn(t){const e=[qn,Zn,Qn],n=gn();async function i(r){const a=r.target.files[0];if(a)try{n("image",await vn(a))}catch(l){alert("Failed to load image"),console.error(l)}}async function o(r){const a=new Image;a.onload=()=>{n("image",a)},a.src=r}return[e,i,o,r=>o(r)]}class xn extends le{constructor(e){super(),ue(this,e,Kn,Jn,fe,{})}}function $n(t){let e,n,i,o,s;const r=t[3].default,a=et(r,t,t[2],null);return{c(){e=y("button"),a&&a.c(),this.h()},l(l){e=k(l,"BUTTON",{type:!0,class:!0});var u=I(e);a&&a.l(u),u.forEach(b),this.h()},h(){e.disabled=t[0],h(e,"type","button"),h(e,"class",n=t[1][t[0]?"disabled":"normal"]+" rounded-md px-2.5 py-1.5 text-sm font-semibold focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 flex items-center justify-center gap-2")},m(l,u){O(l,e,u),a&&a.m(e,null),i=!0,o||(s=ee(e,"click",t[4]),o=!0)},p(l,[u]){a&&a.p&&(!i||u&4)&&tt(a,r,l,l[2],i?it(r,l[2],u,null):nt(l[2]),null),(!i||u&1)&&(e.disabled=l[0]),(!i||u&1&&n!==(n=l[1][l[0]?"disabled":"normal"]+" rounded-md px-2.5 py-1.5 text-sm font-semibold focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 flex items-center justify-center gap-2"))&&h(e,"class",n)},i(l){i||(D(a,l),i=!0)},o(l){R(a,l),i=!1},d(l){l&&b(e),a&&a.d(l),o=!1,s()}}}function ei(t,e,n){let{$$slots:i={},$$scope:o}=e,{disabled:s=!1}=e;const r={normal:"bg-indigo-600 text-white shadow-sm hover:bg-indigo-500",disabled:"bg-gray-200 text-gray-400 shadow-none cursor-not-allowed"};function a(l){Et.call(this,t,l)}return t.$$set=l=>{"disabled"in l&&n(0,s=l.disabled),"$$scope"in l&&n(2,o=l.$$scope)},[s,r,o,i,a]}class Wt extends le{constructor(e){super(),ue(this,e,ei,$n,fe,{disabled:0})}}var ti=class extends EventTarget{dispatchTypedEvent(t,e){return super.dispatchEvent(e)}};class Re{constructor(e){this.id=-1,this.nativePointer=e,this.pageX=e.pageX,this.pageY=e.pageY,this.clientX=e.clientX,this.clientY=e.clientY,self.Touch&&e instanceof Touch?this.id=e.identifier:Ye(e)&&(this.id=e.pointerId)}getCoalesced(){if("getCoalescedEvents"in this.nativePointer){const e=this.nativePointer.getCoalescedEvents().map(n=>new Re(n));if(e.length>0)return e}return[this]}}const Ye=t=>"pointerId"in t,_t=t=>"changedTouches"in t,zt=()=>{};class ni{constructor(e,{start:n=()=>!0,move:i=zt,end:o=zt,rawUpdates:s=!1,avoidPointerEvents:r=!1}={}){this._element=e,this.startPointers=[],this.currentPointers=[],this._excludeFromButtonsCheck=new Set,this._pointerStart=a=>{if(Ye(a)&&a.buttons===0)this._excludeFromButtonsCheck.add(a.pointerId);else if(!(a.buttons&1))return;const l=new Re(a);this.currentPointers.some(u=>u.id===l.id)||this._triggerPointerStart(l,a)&&(Ye(a)?((a.target&&"setPointerCapture"in a.target?a.target:this._element).setPointerCapture(a.pointerId),this._element.addEventListener(this._rawUpdates?"pointerrawupdate":"pointermove",this._move),this._element.addEventListener("pointerup",this._pointerEnd),this._element.addEventListener("pointercancel",this._pointerEnd)):(window.addEventListener("mousemove",this._move),window.addEventListener("mouseup",this._pointerEnd)))},this._touchStart=a=>{for(const l of Array.from(a.changedTouches))this._triggerPointerStart(new Re(l),a)},this._move=a=>{if(!_t(a)&&(!Ye(a)||!this._excludeFromButtonsCheck.has(a.pointerId))&&a.buttons===0){this._pointerEnd(a);return}const l=this.currentPointers.slice(),u=_t(a)?Array.from(a.changedTouches).map(c=>new Re(c)):[new Re(a)],f=[];for(const c of u){const d=this.currentPointers.findIndex(m=>m.id===c.id);d!==-1&&(f.push(c),this.currentPointers[d]=c)}f.length!==0&&this._moveCallback(l,f,a)},this._triggerPointerEnd=(a,l)=>{if(!_t(l)&&l.buttons&1)return!1;const u=this.currentPointers.findIndex(c=>c.id===a.id);if(u===-1)return!1;this.currentPointers.splice(u,1),this.startPointers.splice(u,1),this._excludeFromButtonsCheck.delete(a.id);const f=!(l.type==="mouseup"||l.type==="touchend"||l.type==="pointerup");return this._endCallback(a,l,f),!0},this._pointerEnd=a=>{if(this._triggerPointerEnd(new Re(a),a))if(Ye(a)){if(this.currentPointers.length)return;this._element.removeEventListener(this._rawUpdates?"pointerrawupdate":"pointermove",this._move),this._element.removeEventListener("pointerup",this._pointerEnd),this._element.removeEventListener("pointercancel",this._pointerEnd)}else window.removeEventListener("mousemove",this._move),window.removeEventListener("mouseup",this._pointerEnd)},this._touchEnd=a=>{for(const l of Array.from(a.changedTouches))this._triggerPointerEnd(new Re(l),a)},this._startCallback=n,this._moveCallback=i,this._endCallback=o,this._rawUpdates=s&&"onpointerrawupdate"in window,self.PointerEvent&&!r?this._element.addEventListener("pointerdown",this._pointerStart):(this._element.addEventListener("mousedown",this._pointerStart),this._element.addEventListener("touchstart",this._touchStart),this._element.addEventListener("touchmove",this._move),this._element.addEventListener("touchend",this._touchEnd),this._element.addEventListener("touchcancel",this._touchEnd))}stop(){this._element.removeEventListener("pointerdown",this._pointerStart),this._element.removeEventListener("mousedown",this._pointerStart),this._element.removeEventListener("touchstart",this._touchStart),this._element.removeEventListener("touchmove",this._move),this._element.removeEventListener("touchend",this._touchEnd),this._element.removeEventListener("touchcancel",this._touchEnd),this._element.removeEventListener(this._rawUpdates?"pointerrawupdate":"pointermove",this._move),this._element.removeEventListener("pointerup",this._pointerEnd),this._element.removeEventListener("pointercancel",this._pointerEnd),window.removeEventListener("mousemove",this._move),window.removeEventListener("mouseup",this._pointerEnd)}_triggerPointerStart(e,n){return this._startCallback(e,n)?(this.currentPointers.push(e),this.startPointers.push(e),!0):!1}}function yt(t,e,n){return Math.min(Math.max(t,e),n)}function Vt(t,e){return e?Math.sqrt((e.clientX-t.clientX)**2+(e.clientY-t.clientY)**2):0}function Ht(t,e){return e?{clientX:(t.clientX+e.clientX)/2,clientY:(t.clientY+e.clientY)/2}:t}const ft=class extends ti{constructor(n){super();Ee(this,"element");Ee(this,"transform",new DOMMatrix);Ee(this,"pointerTracker");this.element=n,this.element.addEventListener("wheel",this.onWheel.bind(this)),this.pointerTracker=new ni(this.element,{start:(i,o)=>this.pointerTracker.currentPointers.length===2?!1:(o.preventDefault(),!0),move:i=>{this.onPointerMove(i,this.pointerTracker.currentPointers)},avoidPointerEvents:this.isSafari()}),this.element.addEventListener("wheel",this.onWheel.bind(this))}get x(){return this.transform.e}get y(){return this.transform.f}get scale(){return this.transform.a}set x(n){this.transform.e=n}set y(n){this.transform.f=n}set scale(n){this.transform.a=n,this.transform.d=n}onWheel(n){n.preventDefault();const i=this.element.getBoundingClientRect();let{deltaY:o}=n;const{ctrlKey:s,deltaMode:r}=n;r===1&&(o*=15);const a=o>0,l=s?100:300,u=1-(a?-o:o)/l,f=a?1/u:u,c=n.clientX-i.left,d=n.clientY-i.top;this.applyTransformation({scaleDiff:f,originX:c,originY:d})}applyTransformation(n={}){const{panX:i=0,panY:o=0,originX:s=0,originY:r=0,scaleDiff:a=1}=n,l=new DOMMatrix().translate(s,r).scale(a).translate(-s,-r),u=new DOMMatrix().translate(i,o);l.multiplySelf(u),l.multiplySelf(this.transform);const f=l.a,c=l.e,d=l.f;this.updateTransform(f,c,d)}onPointerMove(n,i){const o=this.element.getBoundingClientRect(),s=Ht(n[0],n[1]),r=Ht(i[0],i[1]),a=s.clientX-o.left,l=s.clientY-o.top,u=Vt(n[0],n[1]),f=Vt(i[0],i[1]),c=u?f/u:1;this.applyTransformation({originX:a,originY:l,scaleDiff:c,panX:r.clientX-s.clientX,panY:r.clientY-s.clientY})}updateTransform(n,i,o){if(n<ft.MIN_SCALE||n>ft.MAX_SCALE||n===this.scale&&i===this.x&&o===this.y)return;this.x=i,this.y=o,this.scale=n;const s=new CustomEvent("panzoom:change",{bubbles:!0,detail:{x:this.x,y:this.y,scale:this.scale,matrix:this.transform}});this.dispatchTypedEvent("panzoom:change",s)}isSafari(){return/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)}reset(){this.updateTransform(1,0,0)}destroy(){this.pointerTracker.stop()}};let je=ft;Ee(je,"MIN_SCALE",.01),Ee(je,"MAX_SCALE",1e5);const ii=t=>({}),Yt=t=>({}),ri=t=>({}),jt=t=>({});function si(t){let e,n,i,o,s,r,a,l,u,f,c,d,m,p;const g=t[7].left,E=et(g,t,t[6],jt),_=t[7].right,w=et(_,t,t[6],Yt);return c=new Te({props:{src:Wn,class:"w-6 h-6 text-white"}}),{c(){e=y("div"),n=y("div"),i=y("div"),o=y("div"),E&&E.c(),s=P(),r=y("div"),a=y("div"),w&&w.c(),l=P(),u=y("div"),f=y("div"),W(c.$$.fragment),this.h()},l(A){e=k(A,"DIV",{class:!0});var T=I(e);n=k(T,"DIV",{class:!0});var M=I(n);i=k(M,"DIV",{class:!0});var Y=I(i);o=k(Y,"DIV",{style:!0,class:!0});var L=I(o);E&&E.l(L),L.forEach(b),Y.forEach(b),s=N(M),r=k(M,"DIV",{class:!0});var B=I(r);a=k(B,"DIV",{style:!0,class:!0});var U=I(a);w&&w.l(U),U.forEach(b),B.forEach(b),M.forEach(b),l=N(T),u=k(T,"DIV",{class:!0});var X=I(u);f=k(X,"DIV",{class:!0});var te=I(f);z(c.$$.fragment,te),te.forEach(b),X.forEach(b),T.forEach(b),this.h()},h(){h(o,"style",t[3]),h(o,"class","w-full h-full origin-top-left grid place-items-center"),h(i,"class","mask-left svelte-dzs820"),h(a,"style",t[3]),h(a,"class","w-full h-full origin-top-left grid place-items-center"),h(r,"class","mask-right svelte-dzs820"),h(n,"class","w-full h-full grid place-items-center"),h(f,"class","w-12 h-12 rounded-full bg-black grid place-items-center absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"),Ie(f,"rotate-90",t[0]==="vertical"),h(u,"class","handle relative shadow-lg svelte-dzs820"),h(e,"class","pz-container svelte-dzs820"),Ie(e,"vertical",t[0]==="vertical"),Se(e,"--split-point",t[1]+"%")},m(A,T){O(A,e,T),v(e,n),v(n,i),v(i,o),E&&E.m(o,null),v(n,s),v(n,r),v(r,a),w&&w.m(a,null),v(e,l),v(e,u),v(u,f),V(c,f,null),t[8](e),d=!0,m||(p=[Ue(t[5].call(null,n)),Ue(t[4].call(null,u)),ee(u,"pointercancel",At(oi))],m=!0)},p(A,[T]){E&&E.p&&(!d||T&64)&&tt(E,g,A,A[6],d?it(g,A[6],T,ri):nt(A[6]),jt),(!d||T&8)&&h(o,"style",A[3]),w&&w.p&&(!d||T&64)&&tt(w,_,A,A[6],d?it(_,A[6],T,ii):nt(A[6]),Yt),(!d||T&8)&&h(a,"style",A[3]),(!d||T&1)&&Ie(f,"rotate-90",A[0]==="vertical"),(!d||T&1)&&Ie(e,"vertical",A[0]==="vertical"),T&2&&Se(e,"--split-point",A[1]+"%")},i(A){d||(D(E,A),D(w,A),D(c.$$.fragment,A),d=!0)},o(A){R(E,A),R(w,A),R(c.$$.fragment,A),d=!1},d(A){A&&b(e),E&&E.d(A),w&&w.d(A),H(c),t[8](null),m=!1,Le(p)}}}const oi=()=>{};function ai(t,e,n){let{$$slots:i={},$$scope:o}=e,{direction:s="horizontal"}=e,r=null,{split:a=50}=e;function l(d){return d.addEventListener("pointerdown",m=>{const p=s==="vertical"?m.clientY:m.clientX,g=a,E=document.body.style.cursor;document.body.style.cursor=s==="vertical"?"ns-resize":"ew-resize";const _=A=>{const T=r?r.clientWidth:window.innerWidth,M=r?r.clientHeight:window.innerHeight,Y=s==="vertical"?M:T,B=(s==="vertical"?A.clientY:A.clientX)-p,U=g+B/Y*100;n(1,a=yt(U,0,100))},w=()=>{document.body.style.cursor=E,window.removeEventListener("pointermove",_),window.removeEventListener("pointerup",w),window.removeEventListener("pointercancel",w)};window.addEventListener("pointermove",_),window.addEventListener("pointerup",w),window.addEventListener("pointercancel",w)}),{destroy(){d.removeEventListener("pointerdown",()=>{})}}}let u="transform: none;";function f(d){const m=new je(d);function p(g){const{matrix:E}=g.detail;n(3,u=`transform: ${E.toString()};`)}return m.addEventListener("panzoom:change",p),{destroy(){m.removeEventListener("panzoom:change",p),m.destroy()}}}Bn(async()=>{const d=window.matchMedia("(min-width: 768px)");function m(p){n(0,s=p.matches?"horizontal":"vertical")}return d.addEventListener("change",m),m(d),()=>d.removeEventListener("change",m)});function c(d){Z[d?"unshift":"push"](()=>{r=d,n(2,r)})}return t.$$set=d=>{"direction"in d&&n(0,s=d.direction),"split"in d&&n(1,a=d.split),"$$scope"in d&&n(6,o=d.$$scope)},[s,a,r,u,l,f,o,i,c]}class li extends le{constructor(e){super(),ue(this,e,ai,si,fe,{direction:0,split:1})}}function ui(t){let e,n,i,o;return{c(){e=y("canvas"),this.h()},l(s){e=k(s,"CANVAS",{style:!0,width:!0,height:!0,class:!0}),I(e).forEach(b),this.h()},h(){h(e,"style","image-rendering: pixelated;"),h(e,"width",t[3]),h(e,"height",t[4]),h(e,"class",t[2])},m(s,r){O(s,e,r),t[6](e),i||(o=Ue(n=t[5].call(null,e,{imageData:t[1],width:t[3],height:t[4]})),i=!0)},p(s,[r]){r&8&&h(e,"width",s[3]),r&16&&h(e,"height",s[4]),r&4&&h(e,"class",s[2]),n&&ct(n.update)&&r&26&&n.update.call(null,{imageData:s[1],width:s[3],height:s[4]})},i:re,o:re,d(s){s&&b(e),t[6](null),i=!1,o()}}}function fi(t,e,n){let{data:i}=e,{twClass:o=""}=e,{canvas:s=null}=e,{width:r=300}=e,{height:a=300}=e;function l(f,c){let d;const m=()=>{d=new OffscreenCanvas(i.width,i.height),d.getContext("2d").putImageData(c.imageData,0,0)};m();const p=()=>{f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(d,0,0,c.width,c.height)};return p(),{update:g=>{c=g,m(),requestAnimationFrame(p)}}}function u(f){Z[f?"unshift":"push"](()=>{s=f,n(0,s)})}return t.$$set=f=>{"data"in f&&n(1,i=f.data),"twClass"in f&&n(2,o=f.twClass),"canvas"in f&&n(0,s=f.canvas),"width"in f&&n(3,r=f.width),"height"in f&&n(4,a=f.height)},[s,i,o,r,a,l,u]}class ci extends le{constructor(e){super(),ue(this,e,fi,ui,fe,{data:1,twClass:2,canvas:0,width:3,height:4})}}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wn=Symbol("Comlink.proxy"),di=Symbol("Comlink.endpoint"),hi=Symbol("Comlink.releaseProxy"),pt=Symbol("Comlink.finalizer"),$e=Symbol("Comlink.thrown"),En=t=>typeof t=="object"&&t!==null||typeof t=="function",mi={canHandle:t=>En(t)&&t[wn],serialize(t){const{port1:e,port2:n}=new MessageChannel;return yn(t,e),[n,[n]]},deserialize(t){return t.start(),dt(t)}},gi={canHandle:t=>En(t)&&$e in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},An=new Map([["proxy",mi],["throw",gi]]);function _i(t,e){for(const n of t)if(e===n||n==="*"||n instanceof RegExp&&n.test(e))return!0;return!1}function yn(t,e=globalThis,n=["*"]){e.addEventListener("message",function i(o){if(!o||!o.data)return;if(!_i(n,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}const{id:s,type:r,path:a}=Object.assign({path:[]},o.data),l=(o.data.argumentList||[]).map(Pe);let u;try{const f=a.slice(0,-1).reduce((d,m)=>d[m],t),c=a.reduce((d,m)=>d[m],t);switch(r){case"GET":u=c;break;case"SET":f[a.slice(-1)[0]]=Pe(o.data.value),u=!0;break;case"APPLY":u=c.apply(f,l);break;case"CONSTRUCT":{const d=new c(...l);u=Ei(d)}break;case"ENDPOINT":{const{port1:d,port2:m}=new MessageChannel;yn(t,m),u=Tn(d,[d])}break;case"RELEASE":u=void 0;break;default:return}}catch(f){u={value:f,[$e]:0}}Promise.resolve(u).catch(f=>({value:f,[$e]:0})).then(f=>{const[c,d]=lt(f);e.postMessage(Object.assign(Object.assign({},c),{id:s}),d),r==="RELEASE"&&(e.removeEventListener("message",i),kn(e),pt in t&&typeof t[pt]=="function"&&t[pt]())}).catch(f=>{const[c,d]=lt({value:new TypeError("Unserializable return value"),[$e]:0});e.postMessage(Object.assign(Object.assign({},c),{id:s}),d)})}),e.start&&e.start()}function pi(t){return t.constructor.name==="MessagePort"}function kn(t){pi(t)&&t.close()}function dt(t,e){return kt(t,[],e)}function xe(t){if(t)throw new Error("Proxy has been released and is not useable")}function In(t){return Be(t,{type:"RELEASE"}).then(()=>{kn(t)})}const ot=new WeakMap,at="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(ot.get(t)||0)-1;ot.set(t,e),e===0&&In(t)});function bi(t,e){const n=(ot.get(e)||0)+1;ot.set(e,n),at&&at.register(t,e,t)}function vi(t){at&&at.unregister(t)}function kt(t,e=[],n=function(){}){let i=!1;const o=new Proxy(n,{get(s,r){if(xe(i),r===hi)return()=>{vi(o),In(t),i=!0};if(r==="then"){if(e.length===0)return{then:()=>o};const a=Be(t,{type:"GET",path:e.map(l=>l.toString())}).then(Pe);return a.then.bind(a)}return kt(t,[...e,r])},set(s,r,a){xe(i);const[l,u]=lt(a);return Be(t,{type:"SET",path:[...e,r].map(f=>f.toString()),value:l},u).then(Pe)},apply(s,r,a){xe(i);const l=e[e.length-1];if(l===di)return Be(t,{type:"ENDPOINT"}).then(Pe);if(l==="bind")return kt(t,e.slice(0,-1));const[u,f]=Gt(a);return Be(t,{type:"APPLY",path:e.map(c=>c.toString()),argumentList:u},f).then(Pe)},construct(s,r){xe(i);const[a,l]=Gt(r);return Be(t,{type:"CONSTRUCT",path:e.map(u=>u.toString()),argumentList:a},l).then(Pe)}});return bi(o,t),o}function wi(t){return Array.prototype.concat.apply([],t)}function Gt(t){const e=t.map(lt);return[e.map(n=>n[0]),wi(e.map(n=>n[1]))]}const Sn=new WeakMap;function Tn(t,e){return Sn.set(t,e),t}function Ei(t){return Object.assign(t,{[wn]:!0})}function lt(t){for(const[e,n]of An)if(n.canHandle(t)){const[i,o]=n.serialize(t);return[{type:"HANDLER",name:e,value:i},o]}return[{type:"RAW",value:t},Sn.get(t)||[]]}function Pe(t){switch(t.type){case"HANDLER":return An.get(t.name).deserialize(t.value);case"RAW":return t.value}}function Be(t,e,n){return new Promise(i=>{const o=Ai();t.addEventListener("message",function s(r){!r.data||!r.data.id||r.data.id!==o||(t.removeEventListener("message",s),i(r.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:o},e),n)})}function Ai(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function yi(){return new Worker(""+new URL("../workers/renderingWorker-76310ae6.js",import.meta.url).href)}function ki(t,e){const n=t.transferControlToOffscreen(),i=new yi,o=dt(i);let s=null,r=null,a=()=>{};o.errorDiffusionDithering(Tn(n,[n]),e).then(u=>{r=u.update,a=u.destroy,r(s||e)});const l=(u,f)=>{for(const c in u){const d=c;if(u[d]!==f[d])return!0}return!1};return{update:u=>{l&&(r?r(u):s=u)},destroy:()=>{a(),i.terminate()}}}var Ii="precision highp float;attribute vec2 position;varying vec2 fragCoord;void main(){fragCoord.x=position.x*0.5+0.5;fragCoord.y=position.y*0.5+0.5;gl_Position=vec4(position,0.0,1.0);}",Si="precision highp float;varying vec2 fragCoord;uniform sampler2D uSampler;uniform sampler2D uNoiseSampler;uniform sampler2D uPaletteSampler;uniform vec2 uNoiseSamplerSize;uniform float uNoise;uniform vec2 uSize;vec3 samplePalette(vec3 glsl_color){vec3 scaledColor=floor(glsl_color*255.0);vec3 quantized_color=floor(scaledColor/16.0)*16.0;float mappingI=floor((floor(quantized_color.r)+floor(quantized_color.g*16.0)+floor(quantized_color.b*16.0*16.0))/16.0);float mappedX=floor(mappingI/64.0);float mappedY=floor(mod(mappingI,64.0));float halfPixel=0.5/64.0;vec2 uv=vec2((mappedX/64.0)+halfPixel,1.0-(mappedY/64.0)-halfPixel);return texture2D(uPaletteSampler,uv).rgb;}void main(void){vec2 imgPixel=vec2(fragCoord.x*uSize.x,fragCoord.y*uSize.y);vec2 noisePixel=vec2(mod(imgPixel.x,uNoiseSamplerSize.x),mod(imgPixel.y,uNoiseSamplerSize.y));vec2 noiseUV=vec2(noisePixel.x/uNoiseSamplerSize.x,noisePixel.y/uNoiseSamplerSize.y);float noise=(texture2D(uNoiseSampler,noiseUV).r-0.5)*2.0*uNoise;vec4 color=texture2D(uSampler,fragCoord);color.r=clamp(color.r+noise,0.0,1.0);color.g=clamp(color.g+noise,0.0,1.0);color.b=clamp(color.b+noise,0.0,1.0);color.rgb=samplePalette(color.rgb);gl_FragColor=color;}";function qt(t){return(t&t-1)===0}function Ti(t,e,n){const i=Zt(t,t.VERTEX_SHADER,e),o=Zt(t,t.FRAGMENT_SHADER,n),s=t.createProgram();if(!s)throw new Error("Failed to create shader program");if(t.attachShader(s,i),t.attachShader(s,o),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS))throw Error(`Unable to initialize the shader program: ${t.getProgramInfoLog(s)}`);return s}function Zt(t,e,n){const i=t.createShader(e);if(!i)throw new Error("Failed to create shader");if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw Error(`An error occurred compiling the shaders: ${t.getShaderInfoLog(i)}`);return i}function Mi(t){const e=t.createBuffer(),n=t.createBuffer(),i=[-1,1,-1,-1,1,-1,1,1],o=[3,2,1,3,1,0];return t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(o),t.STATIC_DRAW),{vertex_buffer:e,index_buffer:n}}function bt(t,e,n){const i=t.createTexture();if(!i)throw new Error("Failed to create texture");return t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),qt(e.width)&&qt(e.height)?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n)),i}function Ci(t,e){let n=e;const i=t.getContext("webgl",{preserveDrawingBuffer:!0});if(!i){alert("WebGL not supported");return}i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT);const o=Ti(i,Ii,Si),{vertex_buffer:s,index_buffer:r}=Mi(i);i.useProgram(o);const a=i.getAttribLocation(o,"position");i.vertexAttribPointer(a,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(a);const l=i.getUniformLocation(o,"uSampler"),u=i.getUniformLocation(o,"uNoiseSampler"),f=i.getUniformLocation(o,"uNoise"),c=i.getUniformLocation(o,"uSize"),d=i.getUniformLocation(o,"uNoiseSamplerSize"),m=i.getUniformLocation(o,"uPaletteSampler");let p;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0);const g=()=>{p&&i.deleteTexture(p),p=bt(i,n.image,i.LINEAR)};g();let E,_,w=null;const A=()=>{E&&i.deleteTexture(E),E=bt(i,n.thresholdMap,i.NEAREST),_={width:n.thresholdMap.width,height:n.thresholdMap.height}};A();let T;const M=()=>{T&&i.deleteTexture(T),T=bt(i,n.palette,i.NEAREST)};M();const Y=()=>{i.viewport(0,0,n.output_width,n.output_height),i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT),i.bindBuffer(i.ARRAY_BUFFER,s),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,p),i.uniform1i(l,0),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,E),i.uniform1i(u,1),i.activeTexture(i.TEXTURE2),i.bindTexture(i.TEXTURE_2D,T),i.uniform1i(m,2),i.uniform2f(d,_.width,_.height),i.uniform1f(f,n.noiseIntensity),i.uniform2f(c,n.output_width,n.output_height),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0)};function L(){w=requestAnimationFrame(()=>{Y(),w=null})}return L(),{update(B){const U=n.image!==B.image,X=n.thresholdMap!==B.thresholdMap,te=n.palette!==B.palette;n=B,U&&g(),X&&A(),te&&M(),L()},destroy(){w!==null&&cancelAnimationFrame(w)}}}function Di(t){let e,n,i;function o(r){t[5](r)}let s={data:t[1],width:t[2].width,height:t[2].height,twClass:"w-full"};return t[0]!==void 0&&(s.canvas=t[0]),e=new ci({props:s}),Z.push(()=>x(e,"canvas",o)),{c(){W(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,a){V(e,r,a),i=!0},p(r,a){const l={};a&2&&(l.data=r[1]),a&4&&(l.width=r[2].width),a&4&&(l.height=r[2].height),!n&&a&1&&(n=!0,l.canvas=r[0],$(()=>n=!1)),e.$set(l)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){R(e.$$.fragment,r),i=!1},d(r){H(e,r)}}}function Ri(t){let e,n=t[2].thresholdMap&&t[2].palette&&Qt(t);return{c(){n&&n.c(),e=rt()},l(i){n&&n.l(i),e=rt()},m(i,o){n&&n.m(i,o),O(i,e,o)},p(i,o){i[2].thresholdMap&&i[2].palette?n?n.p(i,o):(n=Qt(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:re,o:re,d(i){n&&n.d(i),i&&b(e)}}}function Li(t){let e,n=t[2].palette&&Jt(t);return{c(){n&&n.c(),e=rt()},l(i){n&&n.l(i),e=rt()},m(i,o){n&&n.m(i,o),O(i,e,o)},p(i,o){i[2].palette?n?n.p(i,o):(n=Jt(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:re,o:re,d(i){n&&n.d(i),i&&b(e)}}}function Qt(t){let e,n,i,o,s,r;return{c(){e=y("canvas"),this.h()},l(a){e=k(a,"CANVAS",{class:!0,width:!0,height:!0,"aria-label":!0}),I(e).forEach(b),this.h()},h(){h(e,"class","pixelated w-full svelte-1gkt69q"),h(e,"width",n=t[2].width),h(e,"height",i=t[2].height),h(e,"aria-label","Dithered Image")},m(a,l){O(a,e,l),t[4](e),s||(r=Ue(o=Ci.call(null,e,{image:t[1],noiseIntensity:t[2].noiseIntensity,palette:t[2].palette,output_width:t[2].width,output_height:t[2].height,thresholdMap:t[2].thresholdMap})),s=!0)},p(a,l){l&4&&n!==(n=a[2].width)&&h(e,"width",n),l&4&&i!==(i=a[2].height)&&h(e,"height",i),o&&ct(o.update)&&l&6&&o.update.call(null,{image:a[1],noiseIntensity:a[2].noiseIntensity,palette:a[2].palette,output_width:a[2].width,output_height:a[2].height,thresholdMap:a[2].thresholdMap})},d(a){a&&b(e),t[4](null),s=!1,r()}}}function Jt(t){let e,n,i,o,s,r;return{c(){e=y("canvas"),this.h()},l(a){e=k(a,"CANVAS",{class:!0,width:!0,height:!0}),I(e).forEach(b),this.h()},h(){h(e,"class","pixelated w-full svelte-1gkt69q"),h(e,"width",n=t[2].width),h(e,"height",i=t[2].height)},m(a,l){O(a,e,l),t[3](e),s||(r=Ue(o=ki.call(null,e,{image:t[1],output_width:t[2].width,output_height:t[2].height,palette:t[2].palette,diffusionStrength:t[2].diffusionStrength,diffusionMatrix:t[2].diffusionMatrix,diffusionMatrixOriginX:t[2].diffusionMatrixOriginX})),s=!0)},p(a,l){l&4&&n!==(n=a[2].width)&&h(e,"width",n),l&4&&i!==(i=a[2].height)&&h(e,"height",i),o&&ct(o.update)&&l&6&&o.update.call(null,{image:a[1],output_width:a[2].width,output_height:a[2].height,palette:a[2].palette,diffusionStrength:a[2].diffusionStrength,diffusionMatrix:a[2].diffusionMatrix,diffusionMatrixOriginX:a[2].diffusionMatrixOriginX})},d(a){a&&b(e),t[3](null),s=!1,r()}}}function Pi(t){let e,n,i,o;const s=[Li,Ri,Di],r=[];function a(l,u){return l[2].mode==="error_diffusion"?0:l[2].mode==="ordered"?1:l[2].mode==="none"?2:-1}return~(n=a(t))&&(i=r[n]=s[n](t)),{c(){e=y("div"),i&&i.c(),this.h()},l(l){e=k(l,"DIV",{class:!0,style:!0});var u=I(e);i&&i.l(u),u.forEach(b),this.h()},h(){h(e,"class","shadow-lg bg-gray-200"),Se(e,"width","80vmin"),Se(e,"aspect-ratio",t[1].width/t[1].height)},m(l,u){O(l,e,u),~n&&r[n].m(e,null),o=!0},p(l,[u]){let f=n;n=a(l),n===f?~n&&r[n].p(l,u):(i&&(Xe(),R(r[f],1,1,()=>{r[f]=null}),Fe()),~n?(i=r[n],i?i.p(l,u):(i=r[n]=s[n](l),i.c()),D(i,1),i.m(e,null)):i=null),(!o||u&2)&&Se(e,"aspect-ratio",l[1].width/l[1].height)},i(l){o||(D(i),o=!0)},o(l){R(i),o=!1},d(l){l&&b(e),~n&&r[n].d()}}}function Ni(t,e,n){let{canvas:i=null}=e,{image_data:o}=e,{config:s}=e;function r(u){Z[u?"unshift":"push"](()=>{i=u,n(0,i)})}function a(u){Z[u?"unshift":"push"](()=>{i=u,n(0,i)})}function l(u){i=u,n(0,i)}return t.$$set=u=>{"canvas"in u&&n(0,i=u.canvas),"image_data"in u&&n(1,o=u.image_data),"config"in u&&n(2,s=u.config)},[i,o,s,r,a,l]}class Mn extends le{constructor(e){super(),ue(this,e,Ni,Pi,fe,{canvas:0,image_data:1,config:2})}}function Kt(t,e,n){const i=t.slice();return i[4]=e[n],i}function xt(t){let e,n,i,o=!1,s,r,a=t[4].label+"",l,u,f,c,d,m;return c=Un(t[3][0]),{c(){e=y("label"),n=y("input"),s=P(),r=y("div"),l=Q(a),f=P(),this.h()},l(p){e=k(p,"LABEL",{class:!0});var g=I(e);n=k(g,"INPUT",{type:!0,name:!0,class:!0}),s=N(g),r=k(g,"DIV",{class:!0});var E=I(r);l=J(E,a),E.forEach(b),f=N(g),g.forEach(b),this.h()},h(){h(n,"type","radio"),h(n,"name","tabs"),n.__value=i=t[4].value,n.value=n.__value,h(n,"class","sr-only"),h(r,"class",u="flex items-center justify-center py-2 text-sm font-medium text-gray-700 border-b "+(t[4].value===t[0]?"border-indigo-500 border-b-2":"border-gray-300")+" cursor-pointer hover:bg-gray-900 hover:bg-opacity-5"),h(e,"class","flex-1"),c.p(n)},m(p,g){O(p,e,g),v(e,n),n.checked=n.__value===t[0],v(e,s),v(e,r),v(r,l),v(e,f),d||(m=ee(n,"change",t[2]),d=!0)},p(p,g){g&2&&i!==(i=p[4].value)&&(n.__value=i,n.value=n.__value,o=!0),(o||g&3)&&(n.checked=n.__value===p[0]),g&2&&a!==(a=p[4].label+"")&&Ne(l,a),g&3&&u!==(u="flex items-center justify-center py-2 text-sm font-medium text-gray-700 border-b "+(p[4].value===p[0]?"border-indigo-500 border-b-2":"border-gray-300")+" cursor-pointer hover:bg-gray-900 hover:bg-opacity-5")&&h(r,"class",u)},d(p){p&&b(e),c.r(),d=!1,m()}}}function Oi(t){let e,n=t[1],i=[];for(let o=0;o<n.length;o+=1)i[o]=xt(Kt(t,n,o));return{c(){e=y("nav");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=k(o,"NAV",{class:!0});var s=I(e);for(let r=0;r<i.length;r+=1)i[r].l(s);s.forEach(b),this.h()},h(){h(e,"class","flex w-full")},m(o,s){O(o,e,s);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,null)},p(o,[s]){if(s&3){n=o[1];let r;for(r=0;r<n.length;r+=1){const a=Kt(o,n,r);i[r]?i[r].p(a,s):(i[r]=xt(a),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=n.length}},i:re,o:re,d(o){o&&b(e),Ge(i,o)}}}function Bi(t,e,n){let{tabs:i}=e,{selected:o}=e;const s=[[]];function r(){o=this.__value,n(0,o)}return t.$$set=a=>{"tabs"in a&&n(1,i=a.tabs),"selected"in a&&n(0,o=a.selected)},[o,i,r,s]}class Ui extends le{constructor(e){super(),ue(this,e,Bi,Oi,fe,{tabs:1,selected:0})}}function Xi(t){let e,n,i,o,s,r,a;return{c(){e=y("div"),n=y("label"),i=Q(t[1]),o=P(),s=y("input"),this.h()},l(l){e=k(l,"DIV",{});var u=I(e);n=k(u,"LABEL",{for:!0,class:!0});var f=I(n);i=J(f,t[1]),f.forEach(b),o=N(u),s=k(u,"INPUT",{id:!0,type:!0,min:!0,max:!0,step:!0,name:!0,class:!0}),u.forEach(b),this.h()},h(){h(n,"for",t[6]),h(n,"class","block mb-2 text-sm font-medium text-gray-900 dark:text-white"),h(s,"id",t[6]),h(s,"type","range"),h(s,"min",t[3]),h(s,"max",t[4]),h(s,"step",t[5]),h(s,"name",t[2]),h(s,"class","w-full h-1.5 mb-6 bg-white ring-1 ring-gray-300 shadow-sm rounded-lg appearance-none cursor-pointer accent-indigo-600 dark:bg-gray-700")},m(l,u){O(l,e,u),v(e,n),v(n,i),v(e,o),v(e,s),st(s,t[0]),r||(a=[ee(s,"change",t[7]),ee(s,"input",t[7])],r=!0)},p(l,[u]){u&2&&Ne(i,l[1]),u&8&&h(s,"min",l[3]),u&16&&h(s,"max",l[4]),u&32&&h(s,"step",l[5]),u&4&&h(s,"name",l[2]),u&1&&st(s,l[0])},i:re,o:re,d(l){l&&b(e),r=!1,Le(a)}}}function Fi(t,e,n){let{label:i}=e,{name:o=void 0}=e,{min:s=null}=e,{max:r=null}=e,{value:a=0}=e,{step:l=1}=e,u=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);function f(){a=Dt(this.value),n(0,a)}return t.$$set=c=>{"label"in c&&n(1,i=c.label),"name"in c&&n(2,o=c.name),"min"in c&&n(3,s=c.min),"max"in c&&n(4,r=c.max),"value"in c&&n(0,a=c.value),"step"in c&&n(5,l=c.step)},[a,i,o,s,r,l,u,f]}class Rt extends le{constructor(e){super(),ue(this,e,Fi,Xi,fe,{label:1,name:2,min:3,max:4,value:0,step:5})}}function It(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function $t(t,e,n){const i=t.slice();return i[6]=e[n],i}function en(t){let e,n=t[6].name+"",i,o,s;return{c(){e=y("option"),i=Q(n),this.h()},l(r){e=k(r,"OPTION",{});var a=I(e);i=J(a,n),a.forEach(b),this.h()},h(){e.__value=o=t[6].value,e.value=e.__value,e.selected=s=t[6].value===t[0]},m(r,a){O(r,e,a),v(e,i)},p(r,a){a&2&&n!==(n=r[6].name+"")&&Ne(i,n),a&2&&o!==(o=r[6].value)&&(e.__value=o,e.value=e.__value),a&3&&s!==(s=r[6].value===r[0])&&(e.selected=s)},d(r){r&&b(e)}}}function Wi(t){let e,n,i,o,s,r,a,l=t[1],u=[];for(let f=0;f<l.length;f+=1)u[f]=en($t(t,l,f));return{c(){e=y("div"),n=y("label"),i=Q(t[2]),o=P(),s=y("select");for(let f=0;f<u.length;f+=1)u[f].c();this.h()},l(f){e=k(f,"DIV",{});var c=I(e);n=k(c,"LABEL",{for:!0,class:!0});var d=I(n);i=J(d,t[2]),d.forEach(b),o=N(c),s=k(c,"SELECT",{id:!0,name:!0,class:!0});var m=I(s);for(let p=0;p<u.length;p+=1)u[p].l(m);m.forEach(b),c.forEach(b),this.h()},h(){h(n,"for",t[4]),h(n,"class","block text-sm font-medium leading-6 text-gray-900"),h(s,"id",t[4]),h(s,"name",t[3]),h(s,"class","mt-2 block w-full rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6"),t[0]===void 0&&Xn(()=>t[5].call(s))},m(f,c){O(f,e,c),v(e,n),v(n,i),v(e,o),v(e,s);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(s,null);Bt(s,t[0],!0),r||(a=ee(s,"change",t[5]),r=!0)},p(f,[c]){if(c&4&&Ne(i,f[2]),c&3){l=f[1];let d;for(d=0;d<l.length;d+=1){const m=$t(f,l,d);u[d]?u[d].p(m,c):(u[d]=en(m),u[d].c(),u[d].m(s,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=l.length}c&8&&h(s,"name",f[3]),c&3&&Bt(s,f[0])},i:re,o:re,d(f){f&&b(e),Ge(u,f),r=!1,a()}}}function zi(t,e,n){let{options:i}=e,{selected:o}=e,{label:s}=e,{name:r=void 0}=e;const a=It();function l(){o=Fn(this),n(0,o),n(1,i)}return t.$$set=u=>{"options"in u&&n(1,i=u.options),"selected"in u&&n(0,o=u.selected),"label"in u&&n(2,s=u.label),"name"in u&&n(3,r=u.name)},[o,i,s,r,a,l]}class Cn extends le{constructor(e){super(),ue(this,e,zi,Wi,fe,{options:1,selected:0,label:2,name:3})}}function Vi(t){let e,n,i,o,s,r;function a(c){t[5](c)}let l={label:"Diffusion Mode",options:t[2]};t[1]!==void 0&&(l.selected=t[1]),e=new Cn({props:l}),Z.push(()=>x(e,"selected",a));function u(c){t[6](c)}let f={label:"Diffusion Strength ("+t[0]+")",min:0,max:2,step:.01};return t[0]!==void 0&&(f.value=t[0]),o=new Rt({props:f}),Z.push(()=>x(o,"value",u)),{c(){W(e.$$.fragment),i=P(),W(o.$$.fragment)},l(c){z(e.$$.fragment,c),i=N(c),z(o.$$.fragment,c)},m(c,d){V(e,c,d),O(c,i,d),V(o,c,d),r=!0},p(c,[d]){const m={};!n&&d&2&&(n=!0,m.selected=c[1],$(()=>n=!1)),e.$set(m);const p={};d&1&&(p.label="Diffusion Strength ("+c[0]+")"),!s&&d&1&&(s=!0,p.value=c[0],$(()=>s=!1)),o.$set(p)},i(c){r||(D(e.$$.fragment,c),D(o.$$.fragment,c),r=!0)},o(c){R(e.$$.fragment,c),R(o.$$.fragment,c),r=!1},d(c){H(e,c),c&&b(i),H(o,c)}}}function Hi(t,e,n){let{diffusionStrength:i}=e,{diffusionMatrix:o}=e,{diffusionOriginX:s}=e,r="floyd_steinberg";const a=[{name:"Basic",value:"basic"},{name:"Floyd-Steinberg",value:"floyd_steinberg"},{name:"Atkinson",value:"atkinson"},{name:"Jarvis-Judice-Ninke",value:"jarvis_judice_ninke"}],l={basic:{matrix:[[0,1/2],[1/2,0]],originX:0},floyd_steinberg:{matrix:[[0,0,7/16],[3/16,5/16,1/16]],originX:1},atkinson:{matrix:[[0,0,1/8,1/8],[1/8,1/8,1/8,0],[0,1/8,0,0]],originX:1},jarvis_judice_ninke:{matrix:[[0,0,0,7/48,5/48],[3/48,5/48,7/48,5/48,3/48],[1/48,3/48,5/48,3/48,1/48]],originX:2}};function u(c){r=c,n(1,r)}function f(c){i=c,n(0,i)}return t.$$set=c=>{"diffusionStrength"in c&&n(0,i=c.diffusionStrength),"diffusionMatrix"in c&&n(3,o=c.diffusionMatrix),"diffusionOriginX"in c&&n(4,s=c.diffusionOriginX)},t.$$.update=()=>{if(t.$$.dirty&2){const{matrix:c,originX:d}=l[r];n(3,o=c),n(4,s=d)}},[i,r,a,o,s,u,f]}class Yi extends le{constructor(e){super(),ue(this,e,Hi,Vi,fe,{diffusionStrength:0,diffusionMatrix:3,diffusionOriginX:4})}}function tn(t,e,n){const i=t.slice();i[6]=e[n],i[9]=n;const o=jn(i[6]);return i[7]=o,i}function nn(t){let e,n,i,o,s,r,a,l,u;function f(...d){return t[4](t[9],...d)}r=new Te({props:{src:pn,class:"w-4 h-4 text-white"}});function c(){return t[5](t[9])}return{c(){e=y("li"),n=y("input"),o=P(),s=y("button"),W(r.$$.fragment),this.h()},l(d){e=k(d,"LI",{style:!0,class:!0});var m=I(e);n=k(m,"INPUT",{type:!0,class:!0}),o=N(m),s=k(m,"BUTTON",{class:!0});var p=I(s);z(r.$$.fragment,p),p.forEach(b),m.forEach(b),this.h()},h(){h(n,"type","color"),n.value=i=t[7],h(n,"class","absolute inset-0 w-full h-full opacity-0"),h(s,"class","absolute top-1/2 -translate-y-1/2 right-2 p-1 bg-black bg-opacity-40 rounded-full"),Se(e,"background-color",t[7]),h(e,"class","relative rounded-md h-10")},m(d,m){O(d,e,m),v(e,n),v(e,o),v(e,s),V(r,s,null),a=!0,l||(u=[ee(n,"input",f),ee(s,"click",c)],l=!0)},p(d,m){t=d,(!a||m&1&&i!==(i=t[7]))&&(n.value=i),(!a||m&1)&&Se(e,"background-color",t[7])},i(d){a||(D(r.$$.fragment,d),a=!0)},o(d){R(r.$$.fragment,d),a=!1},d(d){d&&b(e),H(r),l=!1,Le(u)}}}function ji(t){let e,n,i,o,s,r,a,l,u,f,c,d=t[0],m=[];for(let g=0;g<d.length;g+=1)m[g]=nn(tn(t,d,g));const p=g=>R(m[g],1,1,()=>{m[g]=null});return s=new Te({props:{src:_n,class:"w-4 h-4"}}),{c(){e=y("ul");for(let g=0;g<m.length;g+=1)m[g].c();n=P(),i=y("li"),o=y("button"),W(s.$$.fragment),r=P(),a=y("span"),l=Q("Color"),this.h()},l(g){e=k(g,"UL",{class:!0});var E=I(e);for(let T=0;T<m.length;T+=1)m[T].l(E);n=N(E),i=k(E,"LI",{});var _=I(i);o=k(_,"BUTTON",{class:!0});var w=I(o);z(s.$$.fragment,w),r=N(w),a=k(w,"SPAN",{});var A=I(a);l=J(A,"Color"),A.forEach(b),w.forEach(b),_.forEach(b),E.forEach(b),this.h()},h(){h(o,"class","flex items-center justify-center gap-1 w-full h-10 bg-emerald-500 text-white rounded-md"),h(e,"class","grid gap-2 grid-cols-3")},m(g,E){O(g,e,E);for(let _=0;_<m.length;_+=1)m[_]&&m[_].m(e,null);v(e,n),v(e,i),v(i,o),V(s,o,null),v(o,r),v(o,a),v(a,l),u=!0,f||(c=ee(o,"click",t[1]),f=!0)},p(g,[E]){if(E&13){d=g[0];let _;for(_=0;_<d.length;_+=1){const w=tn(g,d,_);m[_]?(m[_].p(w,E),D(m[_],1)):(m[_]=nn(w),m[_].c(),D(m[_],1),m[_].m(e,n))}for(Xe(),_=d.length;_<m.length;_+=1)p(_);Fe()}},i(g){if(!u){for(let E=0;E<d.length;E+=1)D(m[E]);D(s.$$.fragment,g),u=!0}},o(g){m=m.filter(Boolean);for(let E=0;E<m.length;E+=1)R(m[E]);R(s.$$.fragment,g),u=!1},d(g){g&&b(e),Ge(m,g),H(s),f=!1,c()}}}function Gi(){return[Math.random()*255,Math.random()*255,Math.random()*255].map(Math.round)}function qi(t,e,n){let{colors:i}=e;function o(){n(0,i=[...i,Gi()])}function s(u){n(0,i=i.filter((f,c)=>c!==u))}function r(u,f){const d=u.target.value;n(0,i[f]=de(d),i)}const a=(u,f)=>r(f,u),l=u=>s(u);return t.$$set=u=>{"colors"in u&&n(0,i=u.colors)},[i,o,s,r,a,l]}class Zi extends le{constructor(e){super(),ue(this,e,qi,ji,fe,{colors:0})}}const Qi=8,Dn=5,rn=1e3,vt=Dn,_e=Qi-Dn,Ji=.75;function St(t,e){return t<e?-1:t>e?1:0}class Tt{constructor(e){Ee(this,"contents",[]);Ee(this,"isSorted",!1);this.compareFn=e}sort(){this.isSorted||(this.contents.sort(this.compareFn),this.isSorted=!0)}push(e){this.contents.push(e),this.isSorted=!1}peek(e){return this.sort(),e===void 0&&(e=this.contents.length-1),this.contents[e]}pop(){return this.sort(),this.contents.pop()}size(){return this.contents.length}map(e){return this.contents.map(e)}[Symbol.iterator](){return this.sort(),this.contents[Symbol.iterator]()}}class Lt{constructor(e,n,i,o,s,r,a){Ee(this,"_count");Ee(this,"_avg");this.r1=e,this.r2=n,this.g1=i,this.g2=o,this.b1=s,this.b2=r,this.histogram=a}volume(){return(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)}count(e=!1){if(this._count===void 0||e){let n=0;for(const[i,o,s]of this.colors())n+=this.histogram.sampleWithReducedColor(i,o,s);this._count=n}return this._count}copy(){return new Lt(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histogram)}avg(e=!1){if(!this._avg||e){let n=0;const i=1<<_e;let o=0,s=0,r=0;for(const[a,l,u]of this.colors()){let f=this.histogram.sampleWithReducedColor(a,l,u);n+=f,o+=f*(a+.5)*i,s+=f*(l+.5)*i,r+=f*(u+.5)*i}n>0?this._avg=[Math.floor(o/n),Math.floor(s/n),Math.floor(r/n)]:this._avg=[Math.floor(i*(this.r1+this.r2+1)/2),Math.floor(i*(this.g1+this.g2+1)/2),Math.floor(i*(this.b1+this.b2+1)/2)]}return this._avg}contains(e){const n=e[0]>>_e,i=e[1]>>_e,o=e[2]>>_e;return n>=this.r1&&n<=this.r2&&i>=this.g1&&i<=this.g2&&o>=this.b1&&o<=this.b2}*colors(){for(let e=this.r1;e<=this.r2;e++)for(let n=this.g1;n<=this.g2;n++)for(let i=this.b1;i<=this.b2;i++)yield[e,n,i]}}class Ki{constructor(){Ee(this,"boxes");this.boxes=new Tt((e,n)=>St(e.vbox.count()*e.vbox.volume(),n.vbox.count()*n.vbox.volume()))}push(e){this.boxes.push({vbox:e,color:e.avg()})}palette(){return this.boxes.map(e=>e.color)}size(){return this.boxes.size()}map(e){for(const n of this.boxes)if(n.vbox.contains(e))return n.color;return this.nearest(e)}nearest(e){let n,i,o;for(const s of this.boxes)i=Math.sqrt(Math.pow(e[0]-s.color[0],2)+Math.pow(e[1]-s.color[1],2)+Math.pow(e[2]-s.color[2],2)),(n===void 0||i<n)&&(n=i,o=s.color);return o}}class ut{constructor(e){Ee(this,"histogram",new Array(1<<3*vt));for(let n=0;n<e.length;n+=4){let i=e[n]>>_e,o=e[n+1]>>_e,s=e[n+2]>>_e,r=ut.getColorIndex(i,o,s);this.histogram[r]=(this.histogram[r]??0)+1}}sample(e,n,i){const o=e>>_e,s=n>>_e,r=i>>_e;return this.sampleWithReducedColor(o,s,r)}sampleWithReducedColor(e,n,i){const o=ut.getColorIndex(e,n,i);return this.histogram[o]??0}static getColorIndex(e,n,i){return(e<<2*vt)+(n<<vt)+i}}function xi(t,e){let n=1e6,i=0,o=1e6,s=0,r=1e6,a=0;for(let l=0;l<t.length;l+=4){const u=t[l]>>_e,f=t[l+1]>>_e,c=t[l+2]>>_e;u<n?n=u:u>i&&(i=u),f<o?o=f:f>s&&(s=f),c<r?r=c:c>a&&(a=c)}return new Lt(n,i,o,s,r,a,e)}function $i(t,e,n,i,o){const s=o+"1",r=o+"2";for(let a=t[s];a<=t[r];a++)if(e[a]>i/2){let l=t.copy(),u=t.copy(),f=a-t[s],c=t[r]-a,d,m=0;for(f<=c?d=Math.min(t[r]-1,~~(a+c/2)):d=Math.max(t[s],~~(a-1-f/2));!e[d];)d++;for(m=n[d];!m&&e[d-1];)m=n[--d];return l[r]=d,u[s]=l[r]+1,[l,u]}throw new Error("VBox can't be cut")}function er(t,e){if(!e.count())return[e.copy(),void 0];const n=e.r2-e.r1+1,i=e.g2-e.g1+1,o=e.b2-e.b1+1,s=Math.max(n,i,o);if(e.count()==1)return[e.copy(),void 0];let r=0;const a=[],l=[];if(s==n)for(let f=e.r1;f<=e.r2;f++){let c=0;for(let d=e.g1;d<=e.g2;d++)for(let m=e.b1;m<=e.b2;m++)c+=t.sampleWithReducedColor(f,d,m);r+=c,a[f]=r}else if(s==i)for(let f=e.g1;f<=e.g2;f++){let c=0;for(let d=e.r1;d<=e.r2;d++)for(let m=e.b1;m<=e.b2;m++)c+=t.sampleWithReducedColor(d,f,m);r+=c,a[f]=r}else if(s==o)for(let f=e.b1;f<=e.b2;f++){let c=0;for(let d=e.r1;d<=e.r2;d++)for(let m=e.g1;m<=e.g2;m++)c+=t.sampleWithReducedColor(d,m,f);r+=c,a[f]=r}else throw new Error("Not Reached");a.forEach(function(f,c){l[c]=r-f});const u=s==n?"r":s==i?"g":"b";return $i(e,a,l,r,u)}function tr(t,e){if(t.length<4||e<2||e>256)throw new Error("Invalid Arguments. There must be at least one pixel, and the max color must be between 2 and 256");const n=new ut(t),i=xi(t,n),o=new Tt((l,u)=>St(l.count(),u.count()));o.push(i);const s=(l,u)=>{let f=l.size(),c=0,d;for(;c<rn;){if(f>=u||c++>rn)return;if(d=l.pop(),!d||!d.count()){l.push(d),c++;continue}const[m,p]=er(n,d);l.push(m),p&&(l.push(p),f++)}};s(o,Ji*e);const r=new Tt(function(l,u){return St(l.count()*l.volume(),u.count()*u.volume())});for(;o.size();)r.push(o.pop());s(r,e);const a=new Ki;for(;r.size();)a.push(r.pop());return a}function nr(t,e,n=10){const i=ir(t.data,n),o=tr(i,e);return o?o.palette():null}function ir(t,e){const n=Math.floor(t.length/4),i=Math.max(1,Math.round(n/e)),o=new Uint8ClampedArray(i*4);for(let s=0;s<i;s++){const r=Math.round(s*n/i);o[s*4+0]=t[r*4+0],o[s*4+1]=t[r*4+1],o[s*4+2]=t[r*4+2],o[s*4+3]=t[r*4+3]}return o}function rr(){return new Worker(""+new URL("../workers/worker-b8220752.js",import.meta.url).href)}let sn=dt(new rr);async function sr(t){if(!sn)throw new Error("Worker not initialized");return await sn.generatePalette(t)}function on(t){let e,n,i,o,s;return{c(){e=y("span"),n=y("span"),i=Q(t[2]),o=P(),s=Q(t[3]),this.h()},l(r){e=k(r,"SPAN",{id:!0,class:!0});var a=I(e);n=k(a,"SPAN",{class:!0});var l=I(n);i=J(l,t[2]),o=N(l),l.forEach(b),s=J(a,t[3]),a.forEach(b),this.h()},h(){h(n,"class","sr-only"),h(e,"id",t[6]),h(e,"class","text-gray-500")},m(r,a){O(r,e,a),v(e,n),v(n,i),v(n,o),v(e,s)},p(r,a){a&4&&Ne(i,r[2]),a&8&&Ne(s,r[3])},d(r){r&&b(e)}}}function or(t){let e,n,i,o,s,r,a,l,u,f,c,d=t[3]&&on(t);return{c(){e=y("div"),n=y("div"),i=y("input"),s=P(),r=y("div"),a=y("label"),l=Q(t[2]),u=P(),d&&d.c(),this.h()},l(m){e=k(m,"DIV",{class:!0});var p=I(e);n=k(p,"DIV",{class:!0});var g=I(n);i=k(g,"INPUT",{id:!0,"aria-describedby":!0,name:!0,type:!0,class:!0}),g.forEach(b),s=N(p),r=k(p,"DIV",{class:!0});var E=I(r);a=k(E,"LABEL",{for:!0,class:!0});var _=I(a);l=J(_,t[2]),_.forEach(b),u=N(E),d&&d.l(E),E.forEach(b),p.forEach(b),this.h()},h(){h(i,"id",t[5]),h(i,"aria-describedby",o=t[3]?t[6]:void 0),h(i,"name",t[4]),h(i,"type","checkbox"),h(i,"class","h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600"),h(n,"class","flex h-6 items-center"),h(a,"for",t[5]),h(a,"class","font-medium text-gray-900"),h(r,"class","ml-3 text-sm leading-6"),h(e,"class","relative flex items-start")},m(m,p){O(m,e,p),v(e,n),v(n,i),t[9](i),i.checked=t[0],v(e,s),v(e,r),v(r,a),v(a,l),v(r,u),d&&d.m(r,null),f||(c=[ee(i,"input",t[7]),ee(i,"change",t[8]),ee(i,"change",t[10])],f=!0)},p(m,[p]){p&8&&o!==(o=m[3]?m[6]:void 0)&&h(i,"aria-describedby",o),p&16&&h(i,"name",m[4]),p&1&&(i.checked=m[0]),p&4&&Ne(l,m[2]),m[3]?d?d.p(m,p):(d=on(m),d.c(),d.m(r,null)):d&&(d.d(1),d=null)},i:re,o:re,d(m){m&&b(e),t[9](null),d&&d.d(),f=!1,Le(c)}}}function ar(t,e,n){let{checked:i=!1}=e,{label:o}=e,{description:s=void 0}=e,{name:r=void 0}=e,{input:a=null}=e;const l=It(),u=It();function f(p){Et.call(this,t,p)}function c(p){Et.call(this,t,p)}function d(p){Z[p?"unshift":"push"](()=>{a=p,n(1,a)})}function m(){i=this.checked,n(0,i)}return t.$$set=p=>{"checked"in p&&n(0,i=p.checked),"label"in p&&n(2,o=p.label),"description"in p&&n(3,s=p.description),"name"in p&&n(4,r=p.name),"input"in p&&n(1,a=p.input)},[i,a,o,s,r,l,u,f,c,d,m]}class Rn extends le{constructor(e){super(),ue(this,e,ar,or,fe,{checked:0,label:2,description:3,name:4,input:1})}}function an(t,e,n){const i=t.slice();return i[15]=e[n].name,i[16]=e[n].palette,i[18]=n,i}function lr(t){let e,n,i,o,s,r=t[4],a=[];for(let l=0;l<r.length;l+=1)a[l]=ln(an(t,r,l));return{c(){e=y("select"),n=y("option"),i=Q("Choose a Preset ");for(let l=0;l<a.length;l+=1)a[l].c();this.h()},l(l){e=k(l,"SELECT",{class:!0});var u=I(e);n=k(u,"OPTION",{});var f=I(n);i=J(f,"Choose a Preset "),f.forEach(b);for(let c=0;c<a.length;c+=1)a[c].l(u);u.forEach(b),this.h()},h(){n.__value=-1,n.value=n.__value,n.selected=!0,n.disabled=!0,h(e,"class","mt-2 block w-full rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6")},m(l,u){O(l,e,u),v(e,n),v(n,i);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(e,null);o||(s=ee(e,"input",t[5]),o=!0)},p(l,u){if(u&16){r=l[4];let f;for(f=0;f<r.length;f+=1){const c=an(l,r,f);a[f]?a[f].p(c,u):(a[f]=ln(c),a[f].c(),a[f].m(e,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=r.length}},d(l){l&&b(e),Ge(a,l),o=!1,s()}}}function ur(t){let e,n,i,o,s,r,a;return{c(){e=y("label"),n=y("span"),i=Q("Number of Colors"),o=P(),s=y("input"),this.h()},l(l){e=k(l,"LABEL",{class:!0});var u=I(e);n=k(u,"SPAN",{class:!0});var f=I(n);i=J(f,"Number of Colors"),f.forEach(b),o=N(u),s=k(u,"INPUT",{type:!0,min:!0,max:!0,class:!0}),u.forEach(b),this.h()},h(){h(n,"class","font-medium text-gray-900 text-sm"),h(s,"type","number"),h(s,"min",Ct),h(s,"max",Mt),h(s,"class","block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),h(e,"class","flex justify-between items-center")},m(l,u){O(l,e,u),v(e,n),v(n,i),v(e,o),v(e,s),st(s,t[2]),r||(a=[ee(s,"input",t[11]),ee(s,"blur",t[12]),ee(s,"input",t[6])],r=!0)},p(l,u){u&4&&Dt(s.value)!==l[2]&&st(s,l[2])},d(l){l&&b(e),r=!1,Le(a)}}}function ln(t){let e,n=t[15]+"",i,o;return{c(){e=y("option"),i=Q(n),o=P(),this.h()},l(s){e=k(s,"OPTION",{});var r=I(e);i=J(r,n),o=N(r),r.forEach(b),this.h()},h(){e.__value=t[18],e.value=e.__value},m(s,r){O(s,e,r),v(e,i),v(e,o)},p:re,d(s){s&&b(e)}}}function fr(t){let e,n,i,o,s,r,a,l,u;function f(w){t[9](w)}function c(w){t[10](w)}let d={label:"Extract Colors from Image"};t[1]!==void 0&&(d.checked=t[1]),t[3]!==void 0&&(d.input=t[3]),n=new Rn({props:d}),Z.push(()=>x(n,"checked",f)),Z.push(()=>x(n,"input",c)),n.$on("input",t[6]);function m(w,A){return w[1]?ur:lr}let p=m(t),g=p(t);function E(w){t[13](w)}let _={};return t[0]!==void 0&&(_.colors=t[0]),a=new Zi({props:_}),Z.push(()=>x(a,"colors",E)),{c(){e=y("fieldset"),W(n.$$.fragment),s=P(),g.c(),r=P(),W(a.$$.fragment),this.h()},l(w){e=k(w,"FIELDSET",{class:!0});var A=I(e);z(n.$$.fragment,A),s=N(A),g.l(A),r=N(A),z(a.$$.fragment,A),A.forEach(b),this.h()},h(){h(e,"class","grid gap-4")},m(w,A){O(w,e,A),V(n,e,null),v(e,s),g.m(e,null),v(e,r),V(a,e,null),u=!0},p(w,[A]){const T={};!i&&A&2&&(i=!0,T.checked=w[1],$(()=>i=!1)),!o&&A&8&&(o=!0,T.input=w[3],$(()=>o=!1)),n.$set(T),p===(p=m(w))&&g?g.p(w,A):(g.d(1),g=p(w),g&&(g.c(),g.m(e,r)));const M={};!l&&A&1&&(l=!0,M.colors=w[0],$(()=>l=!1)),a.$set(M)},i(w){u||(D(n.$$.fragment,w),D(a.$$.fragment,w),u=!0)},o(w){R(n.$$.fragment,w),R(a.$$.fragment,w),u=!1},d(w){w&&b(e),H(n),g.d(),H(a)}}}const Mt=256,Ct=2;function cr(t,e,n){let{image:i=null}=e,{palette:o=null}=e,{colors:s=["#000000","#ffffff"].map(de)}=e;const r=[{name:"Black and White",palette:["#000000","#ffffff"].map(de)},{name:"3Bit",palette:["#000000","#ffffff","#ff0000","#00ff00","#0000ff","#ffff00","#00ffff","#ff00ff"].map(de)},{name:"Grayscale",palette:["#000000","#333333","#666666","#999999","#cccccc","#ffffff"].map(de)},{name:"Red",palette:["#000000","#F46842","#AA2F0D","#ffffff"].map(de)},{name:"RGBY",palette:["#ff0000","#00ff00","#0000ff","#ffff00"].map(de)},{name:"Black, White, Red",palette:["#000000","#ffffff","#ff0000"].map(de)},{name:"Black, White, Yellow",palette:["#000000","#ffffff","#ffff00"].map(de)},{name:"Macintosh",palette:["#33321A","#E5FEFF"].map(de)},{name:"IBM 5151",palette:["#00EB61","#25332F"].map(de)},{name:"Zenith ZVM 1240",palette:["#40291e","#fdca55"].map(de)},{name:"Commodore 1084",palette:["#423091","#88d7de"].map(de)},{name:"IBM 8503",palette:["#25332F","#EBE5CE"].map(de)},{name:"Game Boy DMG-01",palette:["#CADC9F","#0F380F","#306230","#8BAC0F","#9BBC0F"].map(de)}];async function a(w,A){const T=nr(w,A,5);if(!T)throw new Error("Failed to generate palette");return T}let l=!0,u=16;function f(w){const A=w.target,T=A.value;n(0,s=r[Number(T)].palette),A.value="-1"}let c=null;function d(){n(1,l=(c==null?void 0:c.checked)??!0),i&&l&&a(i,yt(u,Ct,Mt)).then(w=>n(0,s=w))}i&&d();function m(w){l=w,n(1,l)}function p(w){c=w,n(3,c)}function g(){u=Dt(this.value),n(2,u)}const E=w=>{n(2,u=yt(u,Ct,Mt)),console.log(u)};function _(w){s=w,n(0,s)}return t.$$set=w=>{"image"in w&&n(8,i=w.image),"palette"in w&&n(7,o=w.palette),"colors"in w&&n(0,s=w.colors)},t.$$.update=()=>{t.$$.dirty&1&&sr(s).then(w=>n(7,o=w))},[s,l,u,c,r,f,d,o,i,m,p,g,E,_]}class dr extends le{constructor(e){super(),ue(this,e,cr,fr,fe,{image:8,palette:7,colors:0})}}function hr(t){let e,n,i,o,s,r,a,l,u,f,c,d,m,p,g,E,_,w,A,T,M,Y,L,B,U,X,te,oe,j,pe,ne;return g=new Te({props:{src:zn,class:"w-4 h-4",solid:!0}}),{c(){e=y("fieldset"),n=y("div"),i=y("label"),o=Q("Width"),r=P(),a=y("div"),l=y("input"),u=P(),f=y("div"),c=Q("px"),m=P(),p=y("span"),W(g.$$.fragment),_=P(),w=y("div"),A=y("label"),T=Q("Height"),Y=P(),L=y("div"),B=y("input"),U=P(),X=y("div"),te=Q("px"),this.h()},l(F){e=k(F,"FIELDSET",{class:!0});var q=I(e);n=k(q,"DIV",{class:!0});var be=I(n);i=k(be,"LABEL",{for:!0,class:!0});var ie=I(i);o=J(ie,"Width"),ie.forEach(b),r=N(be),a=k(be,"DIV",{class:!0});var ve=I(a);l=k(ve,"INPUT",{name:!0,id:!0,type:!0,min:!0,max:!0,step:!0,class:!0,placeholder:!0}),u=N(ve),f=k(ve,"DIV",{class:!0});var ae=I(f);c=J(ae,"px"),ae.forEach(b),ve.forEach(b),be.forEach(b),m=N(q),p=k(q,"SPAN",{class:!0});var ce=I(p);z(g.$$.fragment,ce),ce.forEach(b),_=N(q),w=k(q,"DIV",{class:!0});var Ae=I(w);A=k(Ae,"LABEL",{for:!0,class:!0});var Me=I(A);T=J(Me,"Height"),Me.forEach(b),Y=N(Ae),L=k(Ae,"DIV",{class:!0});var he=I(L);B=k(he,"INPUT",{type:!0,id:!0,name:!0,min:!0,max:!0,step:!0,class:!0,placeholder:!0}),U=N(he),X=k(he,"DIV",{class:!0});var Ce=I(X);te=J(Ce,"px"),Ce.forEach(b),he.forEach(b),Ae.forEach(b),q.forEach(b),this.h()},h(){h(i,"for","width-"+t[9]),h(i,"class",s="block text-sm font-medium leading-6 "+(t[5]?"text-gray-400":"text-gray-900")),h(l,"name","width"),h(l,"id","width-"+t[9]),h(l,"type","number"),h(l,"min",t[3]),h(l,"max",t[1]),l.disabled=t[5],h(l,"step","1"),l.value=t[0],h(l,"class","block w-full rounded-md border-0 py-1.5 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 disabled:cursor-not-allowed disabled:bg-white disabled:text-gray-400 disabled:ring-gray-200"),h(l,"placeholder","600"),h(f,"class","pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400"),h(a,"class",d="relative mt-2 rounded-md "+(t[5]?"shadow-none":"shadow-sm")),h(n,"class","w-full"),h(p,"class",E="pb-2 cursor-not-allowed "+(t[5]?"text-gray-300":"text-gray-500")),h(A,"for","height-"+t[10]),h(A,"class",M="block text-sm font-medium leading-6 "+(t[5]?"text-gray-400":"text-gray-900")),h(B,"type","number"),h(B,"id","height-"+t[10]),h(B,"name","height"),h(B,"min",t[4]),h(B,"max",t[2]),h(B,"step","1"),B.value=t[6],B.disabled=t[5],h(B,"class","block w-full rounded-md border-0 py-1.5 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 disabled:cursor-not-allowed disabled:bg-white disabled:text-gray-400 disabled:ring-gray-200"),h(B,"placeholder","340"),h(X,"class","pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400"),h(L,"class",oe="relative mt-2 rounded-md "+(t[5]?"shadow-none":"shadow-sm")),h(w,"class","w-full"),h(e,"class","flex gap-3 items-end justify-between")},m(F,q){O(F,e,q),v(e,n),v(n,i),v(i,o),v(n,r),v(n,a),v(a,l),v(a,u),v(a,f),v(f,c),v(e,m),v(e,p),V(g,p,null),v(e,_),v(e,w),v(w,A),v(A,T),v(w,Y),v(w,L),v(L,B),v(L,U),v(L,X),v(X,te),j=!0,pe||(ne=[ee(l,"input",t[7]),ee(B,"input",t[8])],pe=!0)},p(F,[q]){(!j||q&32&&s!==(s="block text-sm font-medium leading-6 "+(F[5]?"text-gray-400":"text-gray-900")))&&h(i,"class",s),(!j||q&8)&&h(l,"min",F[3]),(!j||q&2)&&h(l,"max",F[1]),(!j||q&32)&&(l.disabled=F[5]),(!j||q&1&&l.value!==F[0])&&(l.value=F[0]),(!j||q&32&&d!==(d="relative mt-2 rounded-md "+(F[5]?"shadow-none":"shadow-sm")))&&h(a,"class",d),(!j||q&32&&E!==(E="pb-2 cursor-not-allowed "+(F[5]?"text-gray-300":"text-gray-500")))&&h(p,"class",E),(!j||q&32&&M!==(M="block text-sm font-medium leading-6 "+(F[5]?"text-gray-400":"text-gray-900")))&&h(A,"class",M),(!j||q&16)&&h(B,"min",F[4]),(!j||q&4)&&h(B,"max",F[2]),(!j||q&64&&B.value!==F[6])&&(B.value=F[6]),(!j||q&32)&&(B.disabled=F[5]),(!j||q&32&&oe!==(oe="relative mt-2 rounded-md "+(F[5]?"shadow-none":"shadow-sm")))&&h(L,"class",oe)},i(F){j||(D(g.$$.fragment,F),j=!0)},o(F){R(g.$$.fragment,F),j=!1},d(F){F&&b(e),H(g),pe=!1,Le(ne)}}}function un(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function mr(t,e,n){let i,{width:o}=e,{aspectRatio:s}=e,{maxWidth:r=null}=e,{maxHeight:a=null}=e,{minWidth:l=null}=e,{minHeight:u=null}=e,{disabled:f=!1}=e;function c(g){const E=g.target.value;E&&(l!==null&&E<l||r!==null&&E>r||n(0,o=E))}function d(g){const E=g.target.value;E&&(u!==null&&E<u||a!==null&&E>a||n(0,o=Math.round(s*E)))}let m=un(),p=un();return t.$$set=g=>{"width"in g&&n(0,o=g.width),"aspectRatio"in g&&n(11,s=g.aspectRatio),"maxWidth"in g&&n(1,r=g.maxWidth),"maxHeight"in g&&n(2,a=g.maxHeight),"minWidth"in g&&n(3,l=g.minWidth),"minHeight"in g&&n(4,u=g.minHeight),"disabled"in g&&n(5,f=g.disabled)},t.$$.update=()=>{t.$$.dirty&2049&&n(6,i=Math.round(o/s))},[o,r,a,l,u,f,i,c,d,m,p,s]}class Ln extends le{constructor(e){super(),ue(this,e,mr,hr,fe,{width:0,aspectRatio:11,maxWidth:1,maxHeight:2,minWidth:3,minHeight:4,disabled:5})}}const gr=t=>({}),fn=t=>({});function _r(t){let e;const n=t[2].placeholder,i=et(n,t,t[1],fn),o=i||br();return{c(){o&&o.c()},l(s){o&&o.l(s)},m(s,r){o&&o.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&2)&&tt(i,n,s,s[1],e?it(n,s[1],r,gr):nt(s[1]),fn)},i(s){e||(D(o,s),e=!0)},o(s){R(o,s),e=!1},d(s){o&&o.d(s)}}}function pr(t){let e,n,i,o;return{c(){e=y("canvas"),this.h()},l(s){e=k(s,"CANVAS",{class:!0,style:!0}),I(e).forEach(b),this.h()},h(){h(e,"class","w-full max-h-96 object-contain shadow-lg"),Se(e,"image-rendering","pixelated")},m(s,r){O(s,e,r),i||(o=Ue(n=wr.call(null,e,t[0])),i=!0)},p(s,r){n&&ct(n.update)&&r&1&&n.update.call(null,s[0])},i:re,o:re,d(s){s&&b(e),i=!1,o()}}}function br(t){let e,n;return{c(){e=y("span"),n=Q("No Image")},l(i){e=k(i,"SPAN",{});var o=I(e);n=J(o,"No Image"),o.forEach(b)},m(i,o){O(i,e,o),v(e,n)},p:re,d(i){i&&b(e)}}}function vr(t){let e,n,i,o;const s=[pr,_r],r=[];function a(l,u){return l[0]?0:1}return n=a(t),i=r[n]=s[n](t),{c(){e=y("div"),i.c(),this.h()},l(l){e=k(l,"DIV",{class:!0});var u=I(e);i.l(u),u.forEach(b),this.h()},h(){h(e,"class","w-full aspect-square rounded-lg bg-gray-100 p-8 grid place-items-center")},m(l,u){O(l,e,u),r[n].m(e,null),o=!0},p(l,[u]){let f=n;n=a(l),n===f?r[n].p(l,u):(Xe(),R(r[f],1,1,()=>{r[f]=null}),Fe(),i=r[n],i?i.p(l,u):(i=r[n]=s[n](l),i.c()),D(i,1),i.m(e,null))},i(l){o||(D(i),o=!0)},o(l){R(i),o=!1},d(l){l&&b(e),r[n].d()}}}function wr(t,e){const n=t.getContext("2d");if(!n)return;const i=()=>{t.width=e.width,t.height=e.height,n.putImageData(e,0,0)};let o=null;const s=()=>{o||(o=requestAnimationFrame(()=>{o=null,i()}))};return s(),{destroy(){o&&cancelAnimationFrame(o)},update:r=>{e=r,s()}}}function Er(t,e,n){let{$$slots:i={},$$scope:o}=e,{imageData:s}=e;return t.$$set=r=>{"imageData"in r&&n(0,s=r.imageData),"$$scope"in r&&n(1,o=r.$$scope)},[s,o,i]}class Ar extends le{constructor(e){super(),ue(this,e,Er,vr,fe,{imageData:0})}}function yr(){return new Worker(""+new URL("../workers/worker-09b3192d.js",import.meta.url).href)}let wt=null;async function kr(t){return wt||(wt=dt(new yr)),await wt.generate(t)}function cn(t){let e,n,i;function o(r){t[9](r)}let s={label:"Bayer Level ("+t[3]+")",min:0,max:5,step:1};return t[3]!==void 0&&(s.value=t[3]),e=new Rt({props:s}),Z.push(()=>x(e,"value",o)),{c(){W(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,a){V(e,r,a),i=!0},p(r,a){const l={};a&8&&(l.label="Bayer Level ("+r[3]+")"),!n&&a&8&&(n=!0,l.value=r[3],$(()=>n=!1)),e.$set(l)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){R(e.$$.fragment,r),i=!1},d(r){H(e,r)}}}function dn(t){let e,n,i;function o(r){t[10](r)}let s={aspectRatio:1,minWidth:1,minHeight:1,maxHeight:3e3,maxWidth:3e3};return t[4]!==void 0&&(s.width=t[4]),e=new Ln({props:s}),Z.push(()=>x(e,"width",o)),{c(){W(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,a){V(e,r,a),i=!0},p(r,a){const l={};!n&&a&16&&(n=!0,l.width=r[4],$(()=>n=!1)),e.$set(l)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){R(e.$$.fragment,r),i=!1},d(r){H(e,r)}}}function Ir(t){let e,n;return{c(){e=y("span"),n=Q("Loading Threshold Map"),this.h()},l(i){e=k(i,"SPAN",{slot:!0});var o=I(e);n=J(o,"Loading Threshold Map"),o.forEach(b),this.h()},h(){h(e,"slot","placeholder")},m(i,o){O(i,e,o),v(e,n)},p:re,d(i){i&&b(e)}}}function Sr(t){let e,n,i,o,s,r,a,l,u,f;function c(_){t[7](_)}let d={label:"Noise Intensity ("+t[1]+")",min:0,max:1.5,step:.01};t[1]!==void 0&&(d.value=t[1]),e=new Rt({props:d}),Z.push(()=>x(e,"value",c));function m(_){t[8](_)}let p={label:"Threshold Map",options:t[5]};t[2]!==void 0&&(p.selected=t[2]),o=new Cn({props:p}),Z.push(()=>x(o,"selected",m));let g=t[2]==="bayer"&&cn(t),E=t[2]==="white_noise"&&dn(t);return u=new Ar({props:{imageData:t[0],$$slots:{placeholder:[Ir]},$$scope:{ctx:t}}}),{c(){W(e.$$.fragment),i=P(),W(o.$$.fragment),r=P(),g&&g.c(),a=P(),E&&E.c(),l=P(),W(u.$$.fragment)},l(_){z(e.$$.fragment,_),i=N(_),z(o.$$.fragment,_),r=N(_),g&&g.l(_),a=N(_),E&&E.l(_),l=N(_),z(u.$$.fragment,_)},m(_,w){V(e,_,w),O(_,i,w),V(o,_,w),O(_,r,w),g&&g.m(_,w),O(_,a,w),E&&E.m(_,w),O(_,l,w),V(u,_,w),f=!0},p(_,[w]){const A={};w&2&&(A.label="Noise Intensity ("+_[1]+")"),!n&&w&2&&(n=!0,A.value=_[1],$(()=>n=!1)),e.$set(A);const T={};!s&&w&4&&(s=!0,T.selected=_[2],$(()=>s=!1)),o.$set(T),_[2]==="bayer"?g?(g.p(_,w),w&4&&D(g,1)):(g=cn(_),g.c(),D(g,1),g.m(a.parentNode,a)):g&&(Xe(),R(g,1,1,()=>{g=null}),Fe()),_[2]==="white_noise"?E?(E.p(_,w),w&4&&D(E,1)):(E=dn(_),E.c(),D(E,1),E.m(l.parentNode,l)):E&&(Xe(),R(E,1,1,()=>{E=null}),Fe());const M={};w&1&&(M.imageData=_[0]),w&2048&&(M.$$scope={dirty:w,ctx:_}),u.$set(M)},i(_){f||(D(e.$$.fragment,_),D(o.$$.fragment,_),D(g),D(E),D(u.$$.fragment,_),f=!0)},o(_){R(e.$$.fragment,_),R(o.$$.fragment,_),R(g),R(E),R(u.$$.fragment,_),f=!1},d(_){H(e,_),_&&b(i),H(o,_),_&&b(r),g&&g.d(_),_&&b(a),E&&E.d(_),_&&b(l),H(u,_)}}}function Tr(t,e,n){let i,{thresholdMap:o}=e,{noiseIntensity:s}=e,r="bayer";const a=[{name:"Bayer",value:"bayer"},{name:"Blue Noise",value:"blue_noise"},{name:"White Noise",value:"white_noise"}];let l=3,u=256;function f(p){s=p,n(1,s)}function c(p){r=p,n(2,r)}function d(p){l=p,n(3,l)}function m(p){u=p,n(4,u)}return t.$$set=p=>{"thresholdMap"in p&&n(0,o=p.thresholdMap),"noiseIntensity"in p&&n(1,s=p.noiseIntensity)},t.$$.update=()=>{if(t.$$.dirty&16&&n(6,i=u),t.$$.dirty&92&&"ImageData"in globalThis){let p;switch(r){case"bayer":p={mode:"bayer",level:l};break;case"blue_noise":p={mode:"blue_noise"};break;case"white_noise":p={mode:"white_noise",width:u,height:i};break}kr(p).then(g=>n(0,o=g))}},[o,s,r,l,u,a,i,f,c,d,m]}class Mr extends le{constructor(e){super(),ue(this,e,Tr,Sr,fe,{thresholdMap:0,noiseIntensity:1})}}function Cr(t){let e,n,i,o,s,r,a,l,u,f,c,d,m,p,g,E,_,w,A,T,M,Y,L,B,U,X,te,oe,j,pe,ne,F,q,be,ie,ve,ae;function ce(S){t[5](S)}let Ae={label:"Original Size"};t[2]!==void 0&&(Ae.checked=t[2]),s=new Rn({props:Ae}),Z.push(()=>x(s,"checked",ce));function Me(S){t[6](S)}let he={aspectRatio:t[4],minWidth:12,minHeight:12,maxHeight:5e3,maxWidth:5e3,disabled:t[2]};t[3]!==void 0&&(he.width=t[3]),l=new Ln({props:he}),Z.push(()=>x(l,"width",Me));function Ce(S){t[7](S)}let We={tabs:[{label:"None",value:"none"},{label:"Ordered",value:"ordered"},{label:"Error Diffusion",value:"error_diffusion"}]};t[0].mode!==void 0&&(We.selected=t[0].mode),g=new Ui({props:We}),Z.push(()=>x(g,"selected",Ce));function ht(S){t[8](S)}function mt(S){t[9](S)}function ze(S){t[10](S)}let Oe={};t[0].diffusionStrength!==void 0&&(Oe.diffusionStrength=t[0].diffusionStrength),t[0].diffusionMatrix!==void 0&&(Oe.diffusionMatrix=t[0].diffusionMatrix),t[0].diffusionMatrixOriginX!==void 0&&(Oe.diffusionOriginX=t[0].diffusionMatrixOriginX),A=new Yi({props:Oe}),Z.push(()=>x(A,"diffusionStrength",ht)),Z.push(()=>x(A,"diffusionMatrix",mt)),Z.push(()=>x(A,"diffusionOriginX",ze));function gt(S){t[11](S)}function Ve(S){t[12](S)}let C={};t[0].thresholdMap!==void 0&&(C.thresholdMap=t[0].thresholdMap),t[0].noiseIntensity!==void 0&&(C.noiseIntensity=t[0].noiseIntensity),X=new Mr({props:C}),Z.push(()=>x(X,"thresholdMap",gt)),Z.push(()=>x(X,"noiseIntensity",Ve));function K(S){t[13](S)}let De={image:t[1]};return t[0].palette!==void 0&&(De.palette=t[0].palette),ie=new dr({props:De}),Z.push(()=>x(ie,"palette",K)),{c(){e=y("div"),n=y("h2"),i=Q("Output Image"),o=P(),W(s.$$.fragment),a=P(),W(l.$$.fragment),f=P(),c=y("div"),d=y("h2"),m=Q("Dithering Options"),p=P(),W(g.$$.fragment),_=P(),w=y("div"),W(A.$$.fragment),B=P(),U=y("div"),W(X.$$.fragment),pe=P(),ne=y("div"),F=y("h2"),q=Q("Colors"),be=P(),W(ie.$$.fragment),this.h()},l(S){e=k(S,"DIV",{class:!0});var G=I(e);n=k(G,"H2",{class:!0});var we=I(n);i=J(we,"Output Image"),we.forEach(b),o=N(G),z(s.$$.fragment,G),a=N(G),z(l.$$.fragment,G),G.forEach(b),f=N(S),c=k(S,"DIV",{class:!0});var se=I(c);d=k(se,"H2",{class:!0});var me=I(d);m=J(me,"Dithering Options"),me.forEach(b),p=N(se),z(g.$$.fragment,se),_=N(se),w=k(se,"DIV",{class:!0});var ge=I(w);z(A.$$.fragment,ge),ge.forEach(b),B=N(se),U=k(se,"DIV",{class:!0});var ye=I(U);z(X.$$.fragment,ye),ye.forEach(b),se.forEach(b),pe=N(S),ne=k(S,"DIV",{class:!0});var ke=I(ne);F=k(ke,"H2",{class:!0});var He=I(F);q=J(He,"Colors"),He.forEach(b),be=N(ke),z(ie.$$.fragment,ke),ke.forEach(b),this.h()},h(){h(n,"class","text-base font-semibold leading-7 text-black"),h(e,"class","grid gap-4"),h(d,"class","text-base font-semibold leading-7 text-black mb-2"),h(w,"class",L=t[0].mode==="error_diffusion"?"contents":"hidden"),h(U,"class",j=t[0].mode==="ordered"?"contents":"hidden"),h(c,"class","grid gap-4"),h(F,"class","text-base font-semibold leading-7 text-black mb-2"),h(ne,"class","grid gap-3"),Ie(ne,"hidden",t[0].mode==="none")},m(S,G){O(S,e,G),v(e,n),v(n,i),v(e,o),V(s,e,null),v(e,a),V(l,e,null),O(S,f,G),O(S,c,G),v(c,d),v(d,m),v(c,p),V(g,c,null),v(c,_),v(c,w),V(A,w,null),v(c,B),v(c,U),V(X,U,null),O(S,pe,G),O(S,ne,G),v(ne,F),v(F,q),v(ne,be),V(ie,ne,null),ae=!0},p(S,[G]){const we={};!r&&G&4&&(r=!0,we.checked=S[2],$(()=>r=!1)),s.$set(we);const se={};G&16&&(se.aspectRatio=S[4]),G&4&&(se.disabled=S[2]),!u&&G&8&&(u=!0,se.width=S[3],$(()=>u=!1)),l.$set(se);const me={};!E&&G&1&&(E=!0,me.selected=S[0].mode,$(()=>E=!1)),g.$set(me);const ge={};!T&&G&1&&(T=!0,ge.diffusionStrength=S[0].diffusionStrength,$(()=>T=!1)),!M&&G&1&&(M=!0,ge.diffusionMatrix=S[0].diffusionMatrix,$(()=>M=!1)),!Y&&G&1&&(Y=!0,ge.diffusionOriginX=S[0].diffusionMatrixOriginX,$(()=>Y=!1)),A.$set(ge),(!ae||G&1&&L!==(L=S[0].mode==="error_diffusion"?"contents":"hidden"))&&h(w,"class",L);const ye={};!te&&G&1&&(te=!0,ye.thresholdMap=S[0].thresholdMap,$(()=>te=!1)),!oe&&G&1&&(oe=!0,ye.noiseIntensity=S[0].noiseIntensity,$(()=>oe=!1)),X.$set(ye),(!ae||G&1&&j!==(j=S[0].mode==="ordered"?"contents":"hidden"))&&h(U,"class",j);const ke={};G&2&&(ke.image=S[1]),!ve&&G&1&&(ve=!0,ke.palette=S[0].palette,$(()=>ve=!1)),ie.$set(ke),(!ae||G&1)&&Ie(ne,"hidden",S[0].mode==="none")},i(S){ae||(D(s.$$.fragment,S),D(l.$$.fragment,S),D(g.$$.fragment,S),D(A.$$.fragment,S),D(X.$$.fragment,S),D(ie.$$.fragment,S),ae=!0)},o(S){R(s.$$.fragment,S),R(l.$$.fragment,S),R(g.$$.fragment,S),R(A.$$.fragment,S),R(X.$$.fragment,S),R(ie.$$.fragment,S),ae=!1},d(S){S&&b(e),H(s),H(l),S&&b(f),S&&b(c),H(g),H(A),H(X),S&&b(pe),S&&b(ne),H(ie)}}}function Dr(t){return t?t.width/t.height:1}function Rr(t,e,n){let i,{image_data:o}=e,{config:s}=e,r=!0,a=o.width;function l(_){r=_,n(2,r)}function u(_){a=_,n(3,a)}function f(_){t.$$.not_equal(s.mode,_)&&(s.mode=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}function c(_){t.$$.not_equal(s.diffusionStrength,_)&&(s.diffusionStrength=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}function d(_){t.$$.not_equal(s.diffusionMatrix,_)&&(s.diffusionMatrix=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}function m(_){t.$$.not_equal(s.diffusionMatrixOriginX,_)&&(s.diffusionMatrixOriginX=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}function p(_){t.$$.not_equal(s.thresholdMap,_)&&(s.thresholdMap=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}function g(_){t.$$.not_equal(s.noiseIntensity,_)&&(s.noiseIntensity=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}function E(_){t.$$.not_equal(s.palette,_)&&(s.palette=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}return t.$$set=_=>{"image_data"in _&&n(1,o=_.image_data),"config"in _&&n(0,s=_.config)},t.$$.update=()=>{t.$$.dirty&2&&n(4,i=Dr(o)),t.$$.dirty&17&&n(0,s.height=Math.round(s.width/i),s),t.$$.dirty&14&&n(0,s.width=r?o.width:a,s)},[s,o,r,a,i,l,u,f,c,d,m,p,g,E]}class hn extends le{constructor(e){super(),ue(this,e,Rr,Cr,fe,{image_data:1,config:0})}}function Lr(t){let e,n,i;function o(r){t[11](r)}let s={slot:"left",config:t[4],image_data:t[0]};return t[1]!==void 0&&(s.canvas=t[1]),e=new Mn({props:s}),Z.push(()=>x(e,"canvas",o)),{c(){W(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,a){V(e,r,a),i=!0},p(r,a){const l={};a&16&&(l.config=r[4]),a&1&&(l.image_data=r[0]),!n&&a&2&&(n=!0,l.canvas=r[1],$(()=>n=!1)),e.$set(l)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){R(e.$$.fragment,r),i=!1},d(r){H(e,r)}}}function Pr(t){let e,n,i;function o(r){t[10](r)}let s={slot:"right",config:t[3],image_data:t[0]};return t[2]!==void 0&&(s.canvas=t[2]),e=new Mn({props:s}),Z.push(()=>x(e,"canvas",o)),{c(){W(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,a){V(e,r,a),i=!0},p(r,a){const l={};a&8&&(l.config=r[3]),a&1&&(l.image_data=r[0]),!n&&a&4&&(n=!0,l.canvas=r[2],$(()=>n=!1)),e.$set(l)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){R(e.$$.fragment,r),i=!1},d(r){H(e,r)}}}function Nr(t){let e,n,i;return e=new Te({props:{src:bn,class:"w-4 h-4"}}),{c(){W(e.$$.fragment),n=Q(`
					Save`)},l(o){z(e.$$.fragment,o),n=J(o,`
					Save`)},m(o,s){V(e,o,s),O(o,n,s),i=!0},p:re,i(o){i||(D(e.$$.fragment,o),i=!0)},o(o){R(e.$$.fragment,o),i=!1},d(o){H(e,o),o&&b(n)}}}function Or(t){let e,n,i;return e=new Te({props:{src:bn,class:"w-4 h-4"}}),{c(){W(e.$$.fragment),n=Q(`
					Save`)},l(o){z(e.$$.fragment,o),n=J(o,`
					Save`)},m(o,s){V(e,o,s),O(o,n,s),i=!0},p:re,i(o){i||(D(e.$$.fragment,o),i=!0)},o(o){R(e.$$.fragment,o),i=!1},d(o){H(e,o),o&&b(n)}}}function Br(t){let e,n,i,o,s,r,a,l,u,f,c,d,m,p,g,E,_,w,A,T,M,Y,L,B,U,X,te,oe,j,pe,ne,F,q,be,ie,ve,ae,ce,Ae,Me,he,Ce,We;i=new li({props:{$$slots:{right:[Pr],left:[Lr]},$$scope:{ctx:t}}}),l=new Te({props:{src:pn,class:"w-5 h-5 text-white"}}),m=new Te({props:{src:t[5]?Je:Ke,class:"w-6 h-6 text-gray-500"}}),A=new Wt({props:{disabled:!t[0],$$slots:{default:[Nr]},$$scope:{ctx:t}}}),A.$on("click",t[14]);function ht(C){t[15](C)}function mt(C){t[16](C)}let ze={};t[4]!==void 0&&(ze.config=t[4]),t[0]!==void 0&&(ze.image_data=t[0]),Y=new hn({props:ze}),Z.push(()=>x(Y,"config",ht)),Z.push(()=>x(Y,"image_data",mt)),j=new Te({props:{src:t[6]?Je:Ke,class:"w-6 h-6 text-gray-500"}}),ie=new Wt({props:{disabled:!t[0],$$slots:{default:[Or]},$$scope:{ctx:t}}}),ie.$on("click",t[18]);function Oe(C){t[19](C)}function gt(C){t[20](C)}let Ve={};return t[3]!==void 0&&(Ve.config=t[3]),t[0]!==void 0&&(Ve.image_data=t[0]),ce=new hn({props:Ve}),Z.push(()=>x(ce,"config",Oe)),Z.push(()=>x(ce,"image_data",gt)),{c(){e=y("section"),n=y("div"),W(i.$$.fragment),o=P(),s=y("section"),r=y("header"),a=y("button"),W(l.$$.fragment),u=P(),f=y("aside"),c=y("header"),d=y("button"),W(m.$$.fragment),p=P(),g=y("div"),E=y("h1"),_=Q("Original"),w=P(),W(A.$$.fragment),T=P(),M=y("div"),W(Y.$$.fragment),U=P(),X=y("aside"),te=y("header"),oe=y("button"),W(j.$$.fragment),pe=P(),ne=y("div"),F=y("h1"),q=Q("Original"),be=P(),W(ie.$$.fragment),ve=P(),ae=y("div"),W(ce.$$.fragment),this.h()},l(C){e=k(C,"SECTION",{class:!0});var K=I(e);n=k(K,"DIV",{class:!0});var De=I(n);z(i.$$.fragment,De),De.forEach(b),K.forEach(b),o=N(C),s=k(C,"SECTION",{class:!0});var S=I(s);r=k(S,"HEADER",{class:!0});var G=I(r);a=k(G,"BUTTON",{class:!0,title:!0});var we=I(a);z(l.$$.fragment,we),we.forEach(b),G.forEach(b),u=N(S),f=k(S,"ASIDE",{style:!0,class:!0});var se=I(f);c=k(se,"HEADER",{class:!0});var me=I(c);d=k(me,"BUTTON",{class:!0});var ge=I(d);z(m.$$.fragment,ge),ge.forEach(b),p=N(me),g=k(me,"DIV",{class:!0});var ye=I(g);E=k(ye,"H1",{class:!0});var ke=I(E);_=J(ke,"Original"),ke.forEach(b),w=N(ye),z(A.$$.fragment,ye),ye.forEach(b),me.forEach(b),T=N(se),M=k(se,"DIV",{class:!0});var He=I(M);z(Y.$$.fragment,He),He.forEach(b),se.forEach(b),U=N(S),X=k(S,"ASIDE",{style:!0,class:!0});var qe=I(X);te=k(qe,"HEADER",{class:!0});var Ze=I(te);oe=k(Ze,"BUTTON",{class:!0});var Pt=I(oe);z(j.$$.fragment,Pt),Pt.forEach(b),pe=N(Ze),ne=k(Ze,"DIV",{class:!0});var Qe=I(ne);F=k(Qe,"H1",{class:!0});var Nt=I(F);q=J(Nt,"Original"),Nt.forEach(b),be=N(Qe),z(ie.$$.fragment,Qe),Qe.forEach(b),Ze.forEach(b),ve=N(qe),ae=k(qe,"DIV",{class:!0});var Ot=I(ae);z(ce.$$.fragment,Ot),Ot.forEach(b),qe.forEach(b),S.forEach(b),this.h()},h(){h(n,"class","w-full h-full relative"),h(e,"class","overflow-hidden select-none fixed inset-0"),h(a,"class","p-2 bg-black bg-opacity-40 rounded-full touch-auto pointer-events-auto"),h(a,"title","Close Image & Reset"),h(r,"class","header svelte-1kb6xih"),h(d,"class","contents"),h(E,"class","font-bold"),h(g,"class","flex flex-1 items-center justify-between"),h(c,"class","py-4 px-4 flex-shrink-0 shadow-sm flex gap-2 items-center justify-between bg-white z-10"),h(M,"class","bg-gray-50 max-h-full flex-1 overflow-y-scroll p-4 py-8 grid gap-8"),Ie(M,"hidden",!t[5]),Se(f,"overflow","hidden"),h(f,"class","options-left touch-auto pointer-events-auto border border-gray-200 rounded-md flex flex-col max-h-full  svelte-1kb6xih"),h(oe,"class","contents"),h(F,"class","font-bold"),h(ne,"class","flex flex-1 items-center justify-between"),h(te,"class","py-4 px-4 flex-shrink-0 shadow-sm flex gap-2 items-center justify-between bg-white z-10"),h(ae,"class","bg-gray-50 max-h-full flex-1 overflow-y-scroll p-4 py-8 grid gap-8"),Ie(ae,"hidden",!t[6]),Se(X,"overflow","hidden"),h(X,"class","options-right touch-auto pointer-events-auto border border-gray-200 rounded-md flex flex-col max-h-full  svelte-1kb6xih"),h(s,"class","gui-container touch-none pointer-events-none svelte-1kb6xih")},m(C,K){O(C,e,K),v(e,n),V(i,n,null),O(C,o,K),O(C,s,K),v(s,r),v(r,a),V(l,a,null),v(s,u),v(s,f),v(f,c),v(c,d),V(m,d,null),v(c,p),v(c,g),v(g,E),v(E,_),v(g,w),V(A,g,null),v(f,T),v(f,M),V(Y,M,null),v(s,U),v(s,X),v(X,te),v(te,oe),V(j,oe,null),v(te,pe),v(te,ne),v(ne,F),v(F,q),v(ne,be),V(ie,ne,null),v(X,ve),v(X,ae),V(ce,ae,null),he=!0,Ce||(We=[ee(a,"click",t[12]),ee(d,"click",t[13]),ee(oe,"click",t[17])],Ce=!0)},p(C,[K]){const De={};K&4194335&&(De.$$scope={dirty:K,ctx:C}),i.$set(De);const S={};K&32&&(S.src=C[5]?Je:Ke),m.$set(S);const G={};K&1&&(G.disabled=!C[0]),K&4194304&&(G.$$scope={dirty:K,ctx:C}),A.$set(G);const we={};!L&&K&16&&(L=!0,we.config=C[4],$(()=>L=!1)),!B&&K&1&&(B=!0,we.image_data=C[0],$(()=>B=!1)),Y.$set(we),(!he||K&32)&&Ie(M,"hidden",!C[5]);const se={};K&64&&(se.src=C[6]?Je:Ke),j.$set(se);const me={};K&1&&(me.disabled=!C[0]),K&4194304&&(me.$$scope={dirty:K,ctx:C}),ie.$set(me);const ge={};!Ae&&K&8&&(Ae=!0,ge.config=C[3],$(()=>Ae=!1)),!Me&&K&1&&(Me=!0,ge.image_data=C[0],$(()=>Me=!1)),ce.$set(ge),(!he||K&64)&&Ie(ae,"hidden",!C[6])},i(C){he||(D(i.$$.fragment,C),D(l.$$.fragment,C),D(m.$$.fragment,C),D(A.$$.fragment,C),D(Y.$$.fragment,C),D(j.$$.fragment,C),D(ie.$$.fragment,C),D(ce.$$.fragment,C),he=!0)},o(C){R(i.$$.fragment,C),R(l.$$.fragment,C),R(m.$$.fragment,C),R(A.$$.fragment,C),R(Y.$$.fragment,C),R(j.$$.fragment,C),R(ie.$$.fragment,C),R(ce.$$.fragment,C),he=!1},d(C){C&&b(e),H(i),C&&b(o),C&&b(s),H(l),H(m),H(A),H(Y),H(j),H(ie),H(ce),Ce=!1,Le(We)}}}let mn=300;function Ur(t){return t?t.width/t.height:1}function Xr(t,e,n){let i,o;const s=gn();let r=null,a=null,{image_data:l}=e;async function u(U){U&&await Yn(U,"dithered","png")}let f={mode:"ordered",width:mn,height:i,thresholdMap:null,noiseIntensity:.08,palette:null,diffusionStrength:1,diffusionMatrix:[[1]],diffusionMatrixOriginX:0},c={mode:"none",width:l.width,height:l.height,thresholdMap:null,noiseIntensity:.08,palette:null,diffusionStrength:1,diffusionMatrix:[[1]],diffusionMatrixOriginX:0},d=!1,m=!0;function p(U){a=U,n(2,a)}function g(U){r=U,n(1,r)}const E=()=>s("cancel"),_=()=>n(5,d=!d),w=()=>{r&&u(r)};function A(U){c=U,n(4,c)}function T(U){l=U,n(0,l)}const M=()=>n(6,m=!m),Y=()=>{a&&u(a)};function L(U){f=U,n(3,f)}function B(U){l=U,n(0,l)}return t.$$set=U=>{"image_data"in U&&n(0,l=U.image_data)},t.$$.update=()=>{t.$$.dirty&1&&n(9,o=Ur(l)),t.$$.dirty&512&&(i=Math.round(mn/o))},[l,r,a,f,c,d,m,s,u,o,p,g,E,_,w,A,T,M,Y,L,B]}class Fr extends le{constructor(e){super(),ue(this,e,Xr,Br,fe,{image_data:0})}}function Wr(t){let e,n;return e=new xn({}),e.$on("image",t[3]),{c(){W(e.$$.fragment)},l(i){z(e.$$.fragment,i)},m(i,o){V(e,i,o),n=!0},p:re,i(i){n||(D(e.$$.fragment,i),n=!0)},o(i){R(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function zr(t){let e,n;return e=new Fr({props:{image_data:t[0]}}),e.$on("cancel",t[2]),{c(){W(e.$$.fragment)},l(i){z(e.$$.fragment,i)},m(i,o){V(e,i,o),n=!0},p(i,o){const s={};o&1&&(s.image_data=i[0]),e.$set(s)},i(i){n||(D(e.$$.fragment,i),n=!0)},o(i){R(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function Vr(t){let e,n,i,o,s,r,a,l,u;e=new Vn({props:{icon:Gn,og_image:Hr}});const f=[zr,Wr],c=[];function d(m,p){return m[0]?0:1}return s=d(t),r=c[s]=f[s](t),{c(){W(e.$$.fragment),n=P(),i=P(),o=y("main"),r.c(),this.h()},l(m){z(e.$$.fragment,m),n=N(m),i=N(m),o=k(m,"MAIN",{class:!0});var p=I(o);r.l(p),p.forEach(b),this.h()},h(){h(o,"class","w-screen max-w-screen h-screen max-h-screen relative bg-gray-300")},m(m,p){V(e,m,p),O(m,n,p),O(m,i,p),O(m,o,p),c[s].m(o,null),a=!0,l||(u=[ee(document.body,"drop",At(t[1])),ee(document.body,"dragover",At(Yr))],l=!0)},p(m,[p]){let g=s;s=d(m),s===g?c[s].p(m,p):(Xe(),R(c[g],1,1,()=>{c[g]=null}),Fe(),r=c[s],r?r.p(m,p):(r=c[s]=f[s](m),r.c()),D(r,1),r.m(o,null))},i(m){a||(D(e.$$.fragment,m),D(r),a=!0)},o(m){R(e.$$.fragment,m),R(r),a=!1},d(m){H(e,m),m&&b(n),m&&b(i),m&&b(o),c[s].d(),l=!1,Le(u)}}}const Hr="/og/dither-studio.webp",Yr=()=>{};function jr(t,e,n){let i=null;async function o(a){var u;const l=(u=a.dataTransfer)==null?void 0:u.files[0];if(l){if(!l.type.startsWith("image/")){alert("Please drop an image file");return}try{const f=await vn(l);n(0,i=Ut(f))}catch(f){alert("Failed to load image"),console.error(f)}}}return[i,o,()=>n(0,i=null),a=>n(0,i=Ut(a.detail))]}class Jr extends le{constructor(e){super(),ue(this,e,jr,Vr,fe,{})}}export{Jr as component,Qr as universal};

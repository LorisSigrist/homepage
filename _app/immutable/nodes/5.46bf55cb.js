var On=Object.defineProperty;var Un=(t,e,n)=>e in t?On(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ee=(t,e,n)=>(Un(t,typeof e!="symbol"?e+"":e,n),n);import{S as le,i as ue,s as fe,k,a as P,q as K,y as V,l as I,c as N,m as S,r as x,h as b,z as W,L as gn,n as m,p as Se,b as U,G as w,A as H,M as ne,g as R,d as L,R as Ge,B as Y,T as _n,C as tt,D as nt,E as it,F as rt,U as kt,V as Ae,P as Be,W as It,X as Le,o as Bn,w as Q,Q as dt,H as re,v as Fe,f as Xe,Y as ee,Z as te,e as st,_ as Fn,u as Ne,O as ot,$ as Rt,a0 as Xn,a1 as Bt,a2 as zn}from"../chunks/index.fae6157f.js";import{M as Vn}from"../chunks/Metadata.83c92b27.js";import{I as Te,P as pn,A as Wn,X as bn,L as Hn,C as Ke,a as xe,b as vn}from"../chunks/Icon.a577d665.js";function Yn(){return{title:"Dithering",author:"Loris Sigrist",description:"Dither your Images right in the browser!"}}const Jr=Object.freeze(Object.defineProperty({__proto__:null,load:Yn},Symbol.toStringTag,{value:"Module"}));async function jn(t,e,n="png"){const i=new OffscreenCanvas(t.width,t.height),o=i.getContext("2d");if(!o)return;o.drawImage(t,0,0,t.width,t.height);const s=await i.convertToBlob({type:"image/"+n,quality:1}),r=URL.createObjectURL(s),a=document.createElement("a");a.download=`${e}.${n}`,a.href=r,a.click(),a.remove(),URL.revokeObjectURL(r)}function wn(t){return new Promise((e,n)=>{t.type.startsWith("image/")||n(new Error("Not an image file"));const i=new FileReader;i.onload=o=>{if(typeof i.result!="string")return;const s=new Image;s.onload=()=>{e(s)},s.onerror=r=>{n(r)},s.src=i.result},i.onerror=o=>{n(o)},i.readAsDataURL(t)})}function ce(t){const e=parseInt(t.slice(1,3),16),n=parseInt(t.slice(3,5),16),i=parseInt(t.slice(5,7),16);return[e,n,i]}const En="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAyNJREFUaEPVWjFW3DAQ/dOyqSEvB6AiTUJITcEtSJ8azkFq+uQUUFADCQ2pOAHbL2l/noy9q9Va1owseZMt4O16JM+fP39Gliwo+zkGcElyX0RAEpH/TyLyFcBNqdvL2IlIfheR0wGnY2D8338A+DLGlzFAmOt853A3Pvie5ZN5EMmFiMxyQSjHvQB4Y2HIAuSQ5H0i9zVpNKSdtfEAPgH4qQGkAkLyF4APHYhu4olAPYjIxxQYDZAXkjslnU5oZOmzp6E/AGZDYFJAsgWt1II6zdr5ov4OAVmQnJVkIgVOwVS0CPQCIXkL4CimiVAjE2vmTkQ+h2nWB+SA5GNNJhSRb0wifcZdeg/gtw9mA4gTxZaqk6l0A1jzfe3LRM0uKnAjU2t6CRlpqlRKA6nrNdMyKBhL/30gzyT3pnBCG/lUEwQwB/DW2S2B+FRoq9UUoBUlu8HQ/CF5JiIXqUGlr2uZGahebopzAN86ICthDPCpZWrivuKqnSyB1EwTbeQVmoiZiJDcFZH5f1atwhL+zjFyRfKkJiOJHN/o4BnMXDtGVPrQTL7NFYFjpPpSPaYRTXC0NlmM/IvVaxJGQo1oo2yxy2LEcoOm675W+eZTuql281VjxG+KVuA59pMzom2O1pKdZCS1ZI9d96Pqp1ZOtDVjHCNXAE40xrk2Q0CskY9o7NoxsktyPrazDzEzASPNEuW1I1b85AAxMrW5+s3VRNgkJ9bIssCfkbyoRUoNjXjV71xEXh+sVr1qdcJUkpmc1DIEdfWo2+rkGcCeYQK1aQ0grYY2Nx9C0VsXhkOoagBp79e7HeSq1yK1fa+mwTO0ADFUq8ENuo1qbGWmr3pZgBgCFd8ybVEcAHg0TJg0rQAkvYndgrkVkaNSfbIwkDsAqmOFJsIl9TIGSKAZ20GP31isGunLszFAgvmyjt46ZlwUdpJCGDAoBGTwvDN1GNqBaY6nc8GMBPIAoMjxdAfmEMB9DpgRQMq+MBA435z2xtZihTRS9RWONR8tzzBGRlTpHgYsa5A/iXvNCcDpyLXWVl9z6vP9mOQlgH3/Yg8jTwCKvnj2F9CvAivl1accAAAAAElFTkSuQmCC",qn=""+new URL("../assets/cat.58b560b7.jpg",import.meta.url).href,Gn=""+new URL("../assets/david.0e7e3b46.png",import.meta.url).href,Qn=""+new URL("../assets/radial.93989269.png",import.meta.url).href;function Ft(t,e,n){const i=t.slice();return i[5]=e[n],i}function Xt(t){let e,n,i,o,s;function r(){return t[3](t[5])}return{c(){e=k("button"),n=k("img"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var l=S(e);n=I(l,"IMG",{class:!0,src:!0,alt:!0}),l.forEach(b),this.h()},h(){m(n,"class","aspect-square h-24 w-24 object-cover rounded-md shadow-md border-2 border-white"),gn(n.src,i=t[5])||m(n,"src",i),m(n,"alt",""),m(e,"class","hover:opacity-75 transition-opacity")},m(a,l){U(a,e,l),w(e,n),o||(s=ne(e,"click",r),o=!0)},p(a,l){t=a},d(a){a&&b(e),o=!1,s()}}}function Zn(t){let e,n,i,o,s,r,a,l,u,f,c,d,h,p,g,E,_,v,y,M,X,q=t[0],B=[];for(let T=0;T<q.length;T+=1)B[T]=Xt(Ft(t,q,T));return h=new Te({props:{src:pn,class:"w-12 h-12 text-gray-400"}}),{c(){e=k("img"),i=P(),o=k("div"),s=k("div"),r=k("p"),a=K("Select or Drop an Image to Start"),l=P(),u=k("div");for(let T=0;T<B.length;T+=1)B[T].c();f=P(),c=k("label"),d=k("div"),V(h.$$.fragment),p=P(),g=k("span"),E=K("Choose an Image"),_=P(),v=k("input"),this.h()},l(T){e=I(T,"IMG",{src:!0,alt:!0,class:!0,style:!0}),i=N(T),o=I(T,"DIV",{class:!0});var O=S(o);s=I(O,"DIV",{class:!0});var C=S(s);r=I(C,"P",{class:!0});var Z=S(r);a=x(Z,"Select or Drop an Image to Start"),Z.forEach(b),l=N(C),u=I(C,"DIV",{class:!0});var se=S(u);for(let F=0;F<B.length;F+=1)B[F].l(se);f=N(se),c=I(se,"LABEL",{for:!0,class:!0});var z=S(c);d=I(z,"DIV",{class:!0});var de=S(d);W(h.$$.fragment,de),de.forEach(b),p=N(z),g=I(z,"SPAN",{class:!0});var J=S(g);E=x(J,"Choose an Image"),J.forEach(b),_=N(z),v=I(z,"INPUT",{type:!0,class:!0,id:!0,accept:!0}),z.forEach(b),se.forEach(b),C.forEach(b),O.forEach(b),this.h()},h(){gn(e.src,n=En)||m(e,"src",n),m(e,"alt","Dither Studio"),m(e,"class","w-12 h-12 rounded-full fixed top-0 left-0 m-4 shadow-lg"),Se(e,"image-rendering","pixelated"),m(r,"class","text-2xl text-gray-500 text-center"),m(d,"class","grid place-items-center h-full w-full"),m(g,"class","sr-only"),m(v,"type","file"),m(v,"class","sr-only"),m(v,"id","image-input"),m(v,"accept","image/*"),m(c,"for","image-input"),m(c,"class","block spect-square h-24 w-24 object-cover rounded-md shadow-md border-2 border-white bg-white hover:bg-gray-100"),m(u,"class","flex gap-3 justify-center flex-wrap"),m(s,"class","grid gap-4"),m(o,"class","w-full h-full grid place-items-center px-8")},m(T,O){U(T,e,O),U(T,i,O),U(T,o,O),w(o,s),w(s,r),w(r,a),w(s,l),w(s,u);for(let C=0;C<B.length;C+=1)B[C]&&B[C].m(u,null);w(u,f),w(u,c),w(c,d),H(h,d,null),w(c,p),w(c,g),w(g,E),w(c,_),w(c,v),y=!0,M||(X=ne(v,"input",t[1]),M=!0)},p(T,[O]){if(O&5){q=T[0];let C;for(C=0;C<q.length;C+=1){const Z=Ft(T,q,C);B[C]?B[C].p(Z,O):(B[C]=Xt(Z),B[C].c(),B[C].m(u,f))}for(;C<B.length;C+=1)B[C].d(1);B.length=q.length}},i(T){y||(R(h.$$.fragment,T),y=!0)},o(T){L(h.$$.fragment,T),y=!1},d(T){T&&b(e),T&&b(i),T&&b(o),Ge(B,T),Y(h),M=!1,X()}}}function Jn(t){const e=[Qn,Gn,qn],n=_n();async function i(r){const a=r.target.files[0];if(a)try{n("image",await wn(a))}catch(l){alert("Failed to load image"),console.error(l)}}async function o(r){const a=new Image;a.onload=()=>{n("image",a)},a.src=r}return[e,i,o,r=>o(r)]}class Kn extends le{constructor(e){super(),ue(this,e,Jn,Zn,fe,{})}}function xn(t){let e,n,i,o,s;const r=t[3].default,a=tt(r,t,t[2],null);return{c(){e=k("button"),a&&a.c(),this.h()},l(l){e=I(l,"BUTTON",{type:!0,class:!0});var u=S(e);a&&a.l(u),u.forEach(b),this.h()},h(){e.disabled=t[0],m(e,"type","button"),m(e,"class",n=t[1][t[0]?"disabled":"normal"]+" rounded-md px-2.5 py-1.5 text-sm font-semibold focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 flex items-center justify-center gap-2")},m(l,u){U(l,e,u),a&&a.m(e,null),i=!0,o||(s=ne(e,"click",t[4]),o=!0)},p(l,[u]){a&&a.p&&(!i||u&4)&&nt(a,r,l,l[2],i?rt(r,l[2],u,null):it(l[2]),null),(!i||u&1)&&(e.disabled=l[0]),(!i||u&1&&n!==(n=l[1][l[0]?"disabled":"normal"]+" rounded-md px-2.5 py-1.5 text-sm font-semibold focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 flex items-center justify-center gap-2"))&&m(e,"class",n)},i(l){i||(R(a,l),i=!0)},o(l){L(a,l),i=!1},d(l){l&&b(e),a&&a.d(l),o=!1,s()}}}function $n(t,e,n){let{$$slots:i={},$$scope:o}=e,{disabled:s=!1}=e;const r={normal:"bg-indigo-600 text-white shadow-sm hover:bg-indigo-500",disabled:"bg-gray-200 text-gray-400 shadow-none cursor-not-allowed"};function a(l){kt.call(this,t,l)}return t.$$set=l=>{"disabled"in l&&n(0,s=l.disabled),"$$scope"in l&&n(2,o=l.$$scope)},[s,r,o,i,a]}class zt extends le{constructor(e){super(),ue(this,e,$n,xn,fe,{disabled:0})}}var ei=class extends EventTarget{dispatchTypedEvent(t,e){return super.dispatchEvent(e)}};class Re{constructor(e){this.id=-1,this.nativePointer=e,this.pageX=e.pageX,this.pageY=e.pageY,this.clientX=e.clientX,this.clientY=e.clientY,self.Touch&&e instanceof Touch?this.id=e.identifier:Ye(e)&&(this.id=e.pointerId)}getCoalesced(){if("getCoalescedEvents"in this.nativePointer){const e=this.nativePointer.getCoalescedEvents().map(n=>new Re(n));if(e.length>0)return e}return[this]}}const Ye=t=>"pointerId"in t,pt=t=>"changedTouches"in t,Vt=()=>{};class ti{constructor(e,{start:n=()=>!0,move:i=Vt,end:o=Vt,rawUpdates:s=!1,avoidPointerEvents:r=!1}={}){this._element=e,this.startPointers=[],this.currentPointers=[],this._excludeFromButtonsCheck=new Set,this._pointerStart=a=>{if(Ye(a)&&a.buttons===0)this._excludeFromButtonsCheck.add(a.pointerId);else if(!(a.buttons&1))return;const l=new Re(a);this.currentPointers.some(u=>u.id===l.id)||this._triggerPointerStart(l,a)&&(Ye(a)?((a.target&&"setPointerCapture"in a.target?a.target:this._element).setPointerCapture(a.pointerId),this._element.addEventListener(this._rawUpdates?"pointerrawupdate":"pointermove",this._move),this._element.addEventListener("pointerup",this._pointerEnd),this._element.addEventListener("pointercancel",this._pointerEnd)):(window.addEventListener("mousemove",this._move),window.addEventListener("mouseup",this._pointerEnd)))},this._touchStart=a=>{for(const l of Array.from(a.changedTouches))this._triggerPointerStart(new Re(l),a)},this._move=a=>{if(!pt(a)&&(!Ye(a)||!this._excludeFromButtonsCheck.has(a.pointerId))&&a.buttons===0){this._pointerEnd(a);return}const l=this.currentPointers.slice(),u=pt(a)?Array.from(a.changedTouches).map(c=>new Re(c)):[new Re(a)],f=[];for(const c of u){const d=this.currentPointers.findIndex(h=>h.id===c.id);d!==-1&&(f.push(c),this.currentPointers[d]=c)}f.length!==0&&this._moveCallback(l,f,a)},this._triggerPointerEnd=(a,l)=>{if(!pt(l)&&l.buttons&1)return!1;const u=this.currentPointers.findIndex(c=>c.id===a.id);if(u===-1)return!1;this.currentPointers.splice(u,1),this.startPointers.splice(u,1),this._excludeFromButtonsCheck.delete(a.id);const f=!(l.type==="mouseup"||l.type==="touchend"||l.type==="pointerup");return this._endCallback(a,l,f),!0},this._pointerEnd=a=>{if(this._triggerPointerEnd(new Re(a),a))if(Ye(a)){if(this.currentPointers.length)return;this._element.removeEventListener(this._rawUpdates?"pointerrawupdate":"pointermove",this._move),this._element.removeEventListener("pointerup",this._pointerEnd),this._element.removeEventListener("pointercancel",this._pointerEnd)}else window.removeEventListener("mousemove",this._move),window.removeEventListener("mouseup",this._pointerEnd)},this._touchEnd=a=>{for(const l of Array.from(a.changedTouches))this._triggerPointerEnd(new Re(l),a)},this._startCallback=n,this._moveCallback=i,this._endCallback=o,this._rawUpdates=s&&"onpointerrawupdate"in window,self.PointerEvent&&!r?this._element.addEventListener("pointerdown",this._pointerStart):(this._element.addEventListener("mousedown",this._pointerStart),this._element.addEventListener("touchstart",this._touchStart),this._element.addEventListener("touchmove",this._move),this._element.addEventListener("touchend",this._touchEnd),this._element.addEventListener("touchcancel",this._touchEnd))}stop(){this._element.removeEventListener("pointerdown",this._pointerStart),this._element.removeEventListener("mousedown",this._pointerStart),this._element.removeEventListener("touchstart",this._touchStart),this._element.removeEventListener("touchmove",this._move),this._element.removeEventListener("touchend",this._touchEnd),this._element.removeEventListener("touchcancel",this._touchEnd),this._element.removeEventListener(this._rawUpdates?"pointerrawupdate":"pointermove",this._move),this._element.removeEventListener("pointerup",this._pointerEnd),this._element.removeEventListener("pointercancel",this._pointerEnd),window.removeEventListener("mousemove",this._move),window.removeEventListener("mouseup",this._pointerEnd)}_triggerPointerStart(e,n){return this._startCallback(e,n)?(this.currentPointers.push(e),this.startPointers.push(e),!0):!1}}function St(t,e,n){return Math.min(Math.max(t,e),n)}function Wt(t,e){return e?Math.sqrt((e.clientX-t.clientX)**2+(e.clientY-t.clientY)**2):0}function Ht(t,e){return e?{clientX:(t.clientX+e.clientX)/2,clientY:(t.clientY+e.clientY)/2}:t}const ct=class extends ei{constructor(n){super();Ee(this,"element");Ee(this,"transform",new DOMMatrix);Ee(this,"pointerTracker");this.element=n,this.element.addEventListener("wheel",this.onWheel.bind(this)),this.pointerTracker=new ti(this.element,{start:(i,o)=>this.pointerTracker.currentPointers.length===2?!1:(o.preventDefault(),!0),move:i=>{this.onPointerMove(i,this.pointerTracker.currentPointers)},avoidPointerEvents:this.isSafari()}),this.element.addEventListener("wheel",this.onWheel.bind(this))}get x(){return this.transform.e}get y(){return this.transform.f}get scale(){return this.transform.a}set x(n){this.transform.e=n}set y(n){this.transform.f=n}set scale(n){this.transform.a=n,this.transform.d=n}onWheel(n){n.preventDefault();const i=this.element.getBoundingClientRect();let{deltaY:o}=n;const{ctrlKey:s,deltaMode:r}=n;r===1&&(o*=15);const a=o>0,l=s?100:300,u=1-(a?-o:o)/l,f=a?1/u:u,c=n.clientX-i.left,d=n.clientY-i.top;this.applyTransformation({scaleDiff:f,originX:c,originY:d})}applyTransformation(n={}){const{panX:i=0,panY:o=0,originX:s=0,originY:r=0,scaleDiff:a=1}=n,l=new DOMMatrix().translate(s,r).scale(a).translate(-s,-r),u=new DOMMatrix().translate(i,o);l.multiplySelf(u),l.multiplySelf(this.transform);const f=l.a,c=l.e,d=l.f;this.updateTransform(f,c,d)}onPointerMove(n,i){const o=this.element.getBoundingClientRect(),s=Ht(n[0],n[1]),r=Ht(i[0],i[1]),a=s.clientX-o.left,l=s.clientY-o.top,u=Wt(n[0],n[1]),f=Wt(i[0],i[1]),c=u?f/u:1;this.applyTransformation({originX:a,originY:l,scaleDiff:c,panX:r.clientX-s.clientX,panY:r.clientY-s.clientY})}updateTransform(n,i,o){if(n<ct.MIN_SCALE||n>ct.MAX_SCALE||n===this.scale&&i===this.x&&o===this.y)return;this.x=i,this.y=o,this.scale=n;const s=new CustomEvent("panzoom:change",{bubbles:!0,detail:{x:this.x,y:this.y,scale:this.scale,matrix:this.transform}});this.dispatchTypedEvent("panzoom:change",s)}isSafari(){return/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)}reset(){this.updateTransform(1,0,0)}destroy(){this.pointerTracker.stop()}};let je=ct;Ee(je,"MIN_SCALE",.01),Ee(je,"MAX_SCALE",1e5);const ni=t=>({}),Yt=t=>({}),ii=t=>({}),jt=t=>({});function ri(t){let e,n,i,o,s,r,a,l,u,f,c,d,h,p;const g=t[7].left,E=tt(g,t,t[6],jt),_=t[7].right,v=tt(_,t,t[6],Yt);return c=new Te({props:{src:Wn,class:"w-6 h-6 text-white"}}),{c(){e=k("div"),n=k("div"),i=k("div"),o=k("div"),E&&E.c(),s=P(),r=k("div"),a=k("div"),v&&v.c(),l=P(),u=k("div"),f=k("div"),V(c.$$.fragment),this.h()},l(y){e=I(y,"DIV",{class:!0});var M=S(e);n=I(M,"DIV",{class:!0});var X=S(n);i=I(X,"DIV",{class:!0});var q=S(i);o=I(q,"DIV",{style:!0,class:!0});var B=S(o);E&&E.l(B),B.forEach(b),q.forEach(b),s=N(X),r=I(X,"DIV",{class:!0});var T=S(r);a=I(T,"DIV",{style:!0,class:!0});var O=S(a);v&&v.l(O),O.forEach(b),T.forEach(b),X.forEach(b),l=N(M),u=I(M,"DIV",{class:!0});var C=S(u);f=I(C,"DIV",{class:!0});var Z=S(f);W(c.$$.fragment,Z),Z.forEach(b),C.forEach(b),M.forEach(b),this.h()},h(){m(o,"style",t[3]),m(o,"class","w-full h-full origin-top-left grid place-items-center"),m(i,"class","mask-left svelte-dzs820"),m(a,"style",t[3]),m(a,"class","w-full h-full origin-top-left grid place-items-center"),m(r,"class","mask-right svelte-dzs820"),m(n,"class","w-full h-full grid place-items-center"),m(f,"class","w-12 h-12 rounded-full bg-black grid place-items-center absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"),Ae(f,"rotate-90",t[0]==="vertical"),m(u,"class","handle relative shadow-lg svelte-dzs820"),m(e,"class","pz-container svelte-dzs820"),Ae(e,"vertical",t[0]==="vertical"),Se(e,"--split-point",t[1]+"%")},m(y,M){U(y,e,M),w(e,n),w(n,i),w(i,o),E&&E.m(o,null),w(n,s),w(n,r),w(r,a),v&&v.m(a,null),w(e,l),w(e,u),w(u,f),H(c,f,null),t[8](e),d=!0,h||(p=[Be(t[5].call(null,n)),Be(t[4].call(null,u)),ne(u,"pointercancel",It(si))],h=!0)},p(y,[M]){E&&E.p&&(!d||M&64)&&nt(E,g,y,y[6],d?rt(g,y[6],M,ii):it(y[6]),jt),(!d||M&8)&&m(o,"style",y[3]),v&&v.p&&(!d||M&64)&&nt(v,_,y,y[6],d?rt(_,y[6],M,ni):it(y[6]),Yt),(!d||M&8)&&m(a,"style",y[3]),(!d||M&1)&&Ae(f,"rotate-90",y[0]==="vertical"),(!d||M&1)&&Ae(e,"vertical",y[0]==="vertical"),M&2&&Se(e,"--split-point",y[1]+"%")},i(y){d||(R(E,y),R(v,y),R(c.$$.fragment,y),d=!0)},o(y){L(E,y),L(v,y),L(c.$$.fragment,y),d=!1},d(y){y&&b(e),E&&E.d(y),v&&v.d(y),Y(c),t[8](null),h=!1,Le(p)}}}const si=()=>{};function oi(t,e,n){let{$$slots:i={},$$scope:o}=e,{direction:s="horizontal"}=e,r=null,{split:a=50}=e;function l(d){return d.addEventListener("pointerdown",h=>{const p=s==="vertical"?h.clientY:h.clientX,g=a,E=document.body.style.cursor;document.body.style.cursor=s==="vertical"?"ns-resize":"ew-resize";const _=y=>{const M=r?r.clientWidth:window.innerWidth,X=r?r.clientHeight:window.innerHeight,q=s==="vertical"?X:M,T=(s==="vertical"?y.clientY:y.clientX)-p,O=g+T/q*100;n(1,a=St(O,0,100))},v=()=>{document.body.style.cursor=E,window.removeEventListener("pointermove",_),window.removeEventListener("pointerup",v),window.removeEventListener("pointercancel",v)};window.addEventListener("pointermove",_),window.addEventListener("pointerup",v),window.addEventListener("pointercancel",v)}),{destroy(){d.removeEventListener("pointerdown",()=>{})}}}let u="transform: none;";function f(d){const h=new je(d);function p(g){const{matrix:E}=g.detail;n(3,u=`transform: ${E.toString()};`)}return h.addEventListener("panzoom:change",p),{destroy(){h.removeEventListener("panzoom:change",p),h.destroy()}}}Bn(async()=>{const d=window.matchMedia("(min-width: 768px)");function h(p){n(0,s=p.matches?"horizontal":"vertical")}return d.addEventListener("change",h),h(d),()=>d.removeEventListener("change",h)});function c(d){Q[d?"unshift":"push"](()=>{r=d,n(2,r)})}return t.$$set=d=>{"direction"in d&&n(0,s=d.direction),"split"in d&&n(1,a=d.split),"$$scope"in d&&n(6,o=d.$$scope)},[s,a,r,u,l,f,o,i,c]}class ai extends le{constructor(e){super(),ue(this,e,oi,ri,fe,{direction:0,split:1})}}function li(t){let e,n,i,o;return{c(){e=k("canvas"),this.h()},l(s){e=I(s,"CANVAS",{style:!0,width:!0,height:!0,class:!0}),S(e).forEach(b),this.h()},h(){m(e,"style","image-rendering: pixelated;"),m(e,"width",t[3]),m(e,"height",t[4]),m(e,"class",t[2])},m(s,r){U(s,e,r),t[6](e),i||(o=Be(n=t[5].call(null,e,{imageData:t[1],width:t[3],height:t[4]})),i=!0)},p(s,[r]){r&8&&m(e,"width",s[3]),r&16&&m(e,"height",s[4]),r&4&&m(e,"class",s[2]),n&&dt(n.update)&&r&26&&n.update.call(null,{imageData:s[1],width:s[3],height:s[4]})},i:re,o:re,d(s){s&&b(e),t[6](null),i=!1,o()}}}function ui(t,e,n){let{data:i}=e,{twClass:o=""}=e,{canvas:s=null}=e,{width:r=300}=e,{height:a=300}=e;function l(f,c){let d;const h=()=>{d=new OffscreenCanvas(i.width,i.height),d.getContext("2d").putImageData(c.imageData,0,0)};h();const p=()=>{f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(d,0,0,c.width,c.height)};return p(),{update:g=>{c=g,h(),requestAnimationFrame(p)}}}function u(f){Q[f?"unshift":"push"](()=>{s=f,n(0,s)})}return t.$$set=f=>{"data"in f&&n(1,i=f.data),"twClass"in f&&n(2,o=f.twClass),"canvas"in f&&n(0,s=f.canvas),"width"in f&&n(3,r=f.width),"height"in f&&n(4,a=f.height)},[s,i,o,r,a,l,u]}class fi extends le{constructor(e){super(),ue(this,e,ui,li,fe,{data:1,twClass:2,canvas:0,width:3,height:4})}}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yn=Symbol("Comlink.proxy"),ci=Symbol("Comlink.endpoint"),di=Symbol("Comlink.releaseProxy"),bt=Symbol("Comlink.finalizer"),et=Symbol("Comlink.thrown"),kn=t=>typeof t=="object"&&t!==null||typeof t=="function",hi={canHandle:t=>kn(t)&&t[yn],serialize(t){const{port1:e,port2:n}=new MessageChannel;return Sn(t,e),[n,[n]]},deserialize(t){return t.start(),ht(t)}},mi={canHandle:t=>kn(t)&&et in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},In=new Map([["proxy",hi],["throw",mi]]);function gi(t,e){for(const n of t)if(e===n||n==="*"||n instanceof RegExp&&n.test(e))return!0;return!1}function Sn(t,e=globalThis,n=["*"]){e.addEventListener("message",function i(o){if(!o||!o.data)return;if(!gi(n,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}const{id:s,type:r,path:a}=Object.assign({path:[]},o.data),l=(o.data.argumentList||[]).map(Pe);let u;try{const f=a.slice(0,-1).reduce((d,h)=>d[h],t),c=a.reduce((d,h)=>d[h],t);switch(r){case"GET":u=c;break;case"SET":f[a.slice(-1)[0]]=Pe(o.data.value),u=!0;break;case"APPLY":u=c.apply(f,l);break;case"CONSTRUCT":{const d=new c(...l);u=wi(d)}break;case"ENDPOINT":{const{port1:d,port2:h}=new MessageChannel;Sn(t,h),u=Cn(d,[d])}break;case"RELEASE":u=void 0;break;default:return}}catch(f){u={value:f,[et]:0}}Promise.resolve(u).catch(f=>({value:f,[et]:0})).then(f=>{const[c,d]=ut(f);e.postMessage(Object.assign(Object.assign({},c),{id:s}),d),r==="RELEASE"&&(e.removeEventListener("message",i),An(e),bt in t&&typeof t[bt]=="function"&&t[bt]())}).catch(f=>{const[c,d]=ut({value:new TypeError("Unserializable return value"),[et]:0});e.postMessage(Object.assign(Object.assign({},c),{id:s}),d)})}),e.start&&e.start()}function _i(t){return t.constructor.name==="MessagePort"}function An(t){_i(t)&&t.close()}function ht(t,e){return At(t,[],e)}function $e(t){if(t)throw new Error("Proxy has been released and is not useable")}function Tn(t){return Ue(t,{type:"RELEASE"}).then(()=>{An(t)})}const at=new WeakMap,lt="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(at.get(t)||0)-1;at.set(t,e),e===0&&Tn(t)});function pi(t,e){const n=(at.get(e)||0)+1;at.set(e,n),lt&&lt.register(t,e,t)}function bi(t){lt&&lt.unregister(t)}function At(t,e=[],n=function(){}){let i=!1;const o=new Proxy(n,{get(s,r){if($e(i),r===di)return()=>{bi(o),Tn(t),i=!0};if(r==="then"){if(e.length===0)return{then:()=>o};const a=Ue(t,{type:"GET",path:e.map(l=>l.toString())}).then(Pe);return a.then.bind(a)}return At(t,[...e,r])},set(s,r,a){$e(i);const[l,u]=ut(a);return Ue(t,{type:"SET",path:[...e,r].map(f=>f.toString()),value:l},u).then(Pe)},apply(s,r,a){$e(i);const l=e[e.length-1];if(l===ci)return Ue(t,{type:"ENDPOINT"}).then(Pe);if(l==="bind")return At(t,e.slice(0,-1));const[u,f]=qt(a);return Ue(t,{type:"APPLY",path:e.map(c=>c.toString()),argumentList:u},f).then(Pe)},construct(s,r){$e(i);const[a,l]=qt(r);return Ue(t,{type:"CONSTRUCT",path:e.map(u=>u.toString()),argumentList:a},l).then(Pe)}});return pi(o,t),o}function vi(t){return Array.prototype.concat.apply([],t)}function qt(t){const e=t.map(ut);return[e.map(n=>n[0]),vi(e.map(n=>n[1]))]}const Mn=new WeakMap;function Cn(t,e){return Mn.set(t,e),t}function wi(t){return Object.assign(t,{[yn]:!0})}function ut(t){for(const[e,n]of In)if(n.canHandle(t)){const[i,o]=n.serialize(t);return[{type:"HANDLER",name:e,value:i},o]}return[{type:"RAW",value:t},Mn.get(t)||[]]}function Pe(t){switch(t.type){case"HANDLER":return In.get(t.name).deserialize(t.value);case"RAW":return t.value}}function Ue(t,e,n){return new Promise(i=>{const o=Ei();t.addEventListener("message",function s(r){!r.data||!r.data.id||r.data.id!==o||(t.removeEventListener("message",s),i(r.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:o},e),n)})}function Ei(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function yi(){return new Worker(""+new URL("../workers/renderingWorker-76310ae6.js",import.meta.url).href)}function ki(t,e){const n=t.transferControlToOffscreen(),i=new yi,o=ht(i);let s=null,r=null,a=()=>{};return o.errorDiffusionDithering(Cn(n,[n]),e).then(l=>{r=l.update,a=l.destroy,r(s||e)}),{update:l=>{r?r(l):s=l},destroy:()=>{a(),i.terminate()}}}var Ii="precision highp float;attribute vec2 position;varying vec2 fragCoord;void main(){fragCoord.x=position.x*0.5+0.5;fragCoord.y=position.y*0.5+0.5;gl_Position=vec4(position,0.0,1.0);}",Si="precision highp float;varying vec2 fragCoord;uniform sampler2D uSampler;uniform sampler2D uNoiseSampler;uniform sampler2D uPaletteSampler;uniform vec2 uNoiseSamplerSize;uniform float uNoise;uniform vec2 uSize;vec3 samplePalette(vec3 glsl_color){vec3 scaledColor=floor(glsl_color*255.0);vec3 quantized_color=floor(scaledColor/16.0)*16.0;float mappingI=floor((floor(quantized_color.r)+floor(quantized_color.g*16.0)+floor(quantized_color.b*16.0*16.0))/16.0);float mappedX=floor(mappingI/64.0);float mappedY=floor(mod(mappingI,64.0));float halfPixel=0.5/64.0;vec2 uv=vec2((mappedX/64.0)+halfPixel,1.0-(mappedY/64.0)-halfPixel);return texture2D(uPaletteSampler,uv).rgb;}void main(void){vec2 imgPixel=vec2(fragCoord.x*uSize.x,fragCoord.y*uSize.y);vec2 noisePixel=vec2(mod(imgPixel.x,uNoiseSamplerSize.x),mod(imgPixel.y,uNoiseSamplerSize.y));vec2 noiseUV=vec2(noisePixel.x/uNoiseSamplerSize.x,noisePixel.y/uNoiseSamplerSize.y);float noise=(texture2D(uNoiseSampler,noiseUV).r-0.5)*2.0*uNoise;vec4 color=texture2D(uSampler,fragCoord);color.r=clamp(color.r+noise,0.0,1.0);color.g=clamp(color.g+noise,0.0,1.0);color.b=clamp(color.b+noise,0.0,1.0);color.rgb=samplePalette(color.rgb);gl_FragColor=color;}";function Gt(t){return(t&t-1)===0}function Ai(t,e,n){const i=Qt(t,t.VERTEX_SHADER,e),o=Qt(t,t.FRAGMENT_SHADER,n),s=t.createProgram();if(!s)throw new Error("Failed to create shader program");if(t.attachShader(s,i),t.attachShader(s,o),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS))throw Error(`Unable to initialize the shader program: ${t.getProgramInfoLog(s)}`);return s}function Qt(t,e,n){const i=t.createShader(e);if(!i)throw new Error("Failed to create shader");if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw Error(`An error occurred compiling the shaders: ${t.getShaderInfoLog(i)}`);return i}function Ti(t){const e=t.createBuffer(),n=t.createBuffer(),i=[-1,1,-1,-1,1,-1,1,1],o=[3,2,1,3,1,0];return t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(o),t.STATIC_DRAW),{vertex_buffer:e,index_buffer:n}}function vt(t,e,n){const i=t.createTexture();if(!i)throw new Error("Failed to create texture");return t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),Gt(e.width)&&Gt(e.height)?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n)),i}function Mi(t,e){let n=e;const i=t.getContext("webgl",{preserveDrawingBuffer:!0});if(!i){alert("WebGL not supported");return}i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT);const o=Ai(i,Ii,Si),{vertex_buffer:s,index_buffer:r}=Ti(i);i.useProgram(o);const a=i.getAttribLocation(o,"position");i.vertexAttribPointer(a,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(a);const l=i.getUniformLocation(o,"uSampler"),u=i.getUniformLocation(o,"uNoiseSampler"),f=i.getUniformLocation(o,"uNoise"),c=i.getUniformLocation(o,"uSize"),d=i.getUniformLocation(o,"uNoiseSamplerSize"),h=i.getUniformLocation(o,"uPaletteSampler");let p;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0);const g=()=>{p&&i.deleteTexture(p),p=vt(i,n.image,i.LINEAR)};g();let E,_,v=null;const y=()=>{E&&i.deleteTexture(E),E=vt(i,n.thresholdMap,i.NEAREST),_={width:n.thresholdMap.width,height:n.thresholdMap.height}};y();let M;const X=()=>{M&&i.deleteTexture(M),M=vt(i,n.palette,i.NEAREST)};X();const q=()=>{i.viewport(0,0,n.output_width,n.output_height),i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT),i.bindBuffer(i.ARRAY_BUFFER,s),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,p),i.uniform1i(l,0),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,E),i.uniform1i(u,1),i.activeTexture(i.TEXTURE2),i.bindTexture(i.TEXTURE_2D,M),i.uniform1i(h,2),i.uniform2f(d,_.width,_.height),i.uniform1f(f,n.noiseIntensity),i.uniform2f(c,n.output_width,n.output_height),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0)};function B(){v=requestAnimationFrame(()=>{q(),v=null})}return B(),{update(T){const O=n.image!==T.image,C=n.thresholdMap!==T.thresholdMap,Z=n.palette!==T.palette;n=T,O&&g(),C&&y(),Z&&X(),B()},destroy(){v!==null&&cancelAnimationFrame(v)}}}function Ci(t){let e,n,i;function o(r){t[5](r)}let s={data:t[1],width:t[2].width,height:t[2].height,twClass:"w-full"};return t[0]!==void 0&&(s.canvas=t[0]),e=new fi({props:s}),Q.push(()=>ee(e,"canvas",o)),{c(){V(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,a){H(e,r,a),i=!0},p(r,a){const l={};a&2&&(l.data=r[1]),a&4&&(l.width=r[2].width),a&4&&(l.height=r[2].height),!n&&a&1&&(n=!0,l.canvas=r[0],te(()=>n=!1)),e.$set(l)},i(r){i||(R(e.$$.fragment,r),i=!0)},o(r){L(e.$$.fragment,r),i=!1},d(r){Y(e,r)}}}function Di(t){let e,n=t[2].thresholdMap&&t[2].palette&&Zt(t);return{c(){n&&n.c(),e=st()},l(i){n&&n.l(i),e=st()},m(i,o){n&&n.m(i,o),U(i,e,o)},p(i,o){i[2].thresholdMap&&i[2].palette?n?n.p(i,o):(n=Zt(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:re,o:re,d(i){n&&n.d(i),i&&b(e)}}}function Ri(t){let e,n=t[2].palette&&Jt(t);return{c(){n&&n.c(),e=st()},l(i){n&&n.l(i),e=st()},m(i,o){n&&n.m(i,o),U(i,e,o)},p(i,o){i[2].palette?n?n.p(i,o):(n=Jt(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:re,o:re,d(i){n&&n.d(i),i&&b(e)}}}function Zt(t){let e,n,i,o,s,r;return{c(){e=k("canvas"),this.h()},l(a){e=I(a,"CANVAS",{class:!0,width:!0,height:!0,"aria-label":!0}),S(e).forEach(b),this.h()},h(){m(e,"class","pixelated w-full svelte-1gkt69q"),m(e,"width",n=t[2].width),m(e,"height",i=t[2].height),m(e,"aria-label","Dithered Image")},m(a,l){U(a,e,l),t[4](e),s||(r=Be(o=Mi.call(null,e,{image:t[1],noiseIntensity:t[2].noiseIntensity,palette:t[2].palette,output_width:t[2].width,output_height:t[2].height,thresholdMap:t[2].thresholdMap})),s=!0)},p(a,l){l&4&&n!==(n=a[2].width)&&m(e,"width",n),l&4&&i!==(i=a[2].height)&&m(e,"height",i),o&&dt(o.update)&&l&6&&o.update.call(null,{image:a[1],noiseIntensity:a[2].noiseIntensity,palette:a[2].palette,output_width:a[2].width,output_height:a[2].height,thresholdMap:a[2].thresholdMap})},d(a){a&&b(e),t[4](null),s=!1,r()}}}function Jt(t){let e,n,i,o,s,r;return{c(){e=k("canvas"),this.h()},l(a){e=I(a,"CANVAS",{class:!0,width:!0,height:!0}),S(e).forEach(b),this.h()},h(){m(e,"class","pixelated w-full svelte-1gkt69q"),m(e,"width",n=t[2].width),m(e,"height",i=t[2].height)},m(a,l){U(a,e,l),t[3](e),s||(r=Be(o=ki.call(null,e,{image:t[1],output_width:t[2].width,output_height:t[2].height,palette:t[2].palette,diffusionStrength:t[2].diffusionStrength,diffusionMatrix:t[2].diffusionMatrix,diffusionMatrixOriginX:t[2].diffusionMatrixOriginX})),s=!0)},p(a,l){l&4&&n!==(n=a[2].width)&&m(e,"width",n),l&4&&i!==(i=a[2].height)&&m(e,"height",i),o&&dt(o.update)&&l&6&&o.update.call(null,{image:a[1],output_width:a[2].width,output_height:a[2].height,palette:a[2].palette,diffusionStrength:a[2].diffusionStrength,diffusionMatrix:a[2].diffusionMatrix,diffusionMatrixOriginX:a[2].diffusionMatrixOriginX})},d(a){a&&b(e),t[3](null),s=!1,r()}}}function Li(t){let e,n,i,o;const s=[Ri,Di,Ci],r=[];function a(l,u){return l[2].mode==="error_diffusion"?0:l[2].mode==="ordered"?1:l[2].mode==="none"?2:-1}return~(n=a(t))&&(i=r[n]=s[n](t)),{c(){e=k("div"),i&&i.c(),this.h()},l(l){e=I(l,"DIV",{class:!0,style:!0});var u=S(e);i&&i.l(u),u.forEach(b),this.h()},h(){m(e,"class","shadow-lg bg-gray-200"),Se(e,"width","80vmin"),Se(e,"aspect-ratio",t[1].width/t[1].height)},m(l,u){U(l,e,u),~n&&r[n].m(e,null),o=!0},p(l,[u]){let f=n;n=a(l),n===f?~n&&r[n].p(l,u):(i&&(Fe(),L(r[f],1,1,()=>{r[f]=null}),Xe()),~n?(i=r[n],i?i.p(l,u):(i=r[n]=s[n](l),i.c()),R(i,1),i.m(e,null)):i=null),(!o||u&2)&&Se(e,"aspect-ratio",l[1].width/l[1].height)},i(l){o||(R(i),o=!0)},o(l){L(i),o=!1},d(l){l&&b(e),~n&&r[n].d()}}}function Pi(t,e,n){let{canvas:i=null}=e,{image_data:o}=e,{config:s}=e;function r(u){Q[u?"unshift":"push"](()=>{i=u,n(0,i)})}function a(u){Q[u?"unshift":"push"](()=>{i=u,n(0,i)})}function l(u){i=u,n(0,i)}return t.$$set=u=>{"canvas"in u&&n(0,i=u.canvas),"image_data"in u&&n(1,o=u.image_data),"config"in u&&n(2,s=u.config)},[i,o,s,r,a,l]}class Dn extends le{constructor(e){super(),ue(this,e,Pi,Li,fe,{canvas:0,image_data:1,config:2})}}function Kt(t,e,n){const i=t.slice();return i[4]=e[n],i}function xt(t){let e,n,i,o=!1,s,r,a=t[4].label+"",l,u,f,c,d,h;return c=Fn(t[3][0]),{c(){e=k("label"),n=k("input"),s=P(),r=k("div"),l=K(a),f=P(),this.h()},l(p){e=I(p,"LABEL",{class:!0});var g=S(e);n=I(g,"INPUT",{type:!0,name:!0,class:!0}),s=N(g),r=I(g,"DIV",{class:!0});var E=S(r);l=x(E,a),E.forEach(b),f=N(g),g.forEach(b),this.h()},h(){m(n,"type","radio"),m(n,"name","tabs"),n.__value=i=t[4].value,n.value=n.__value,m(n,"class","sr-only"),m(r,"class",u="flex items-center justify-center py-2 text-sm font-medium text-gray-700 border-b "+(t[4].value===t[0]?"border-indigo-500 border-b-2":"border-gray-300")+" cursor-pointer hover:bg-gray-900 hover:bg-opacity-5"),m(e,"class","flex-1"),c.p(n)},m(p,g){U(p,e,g),w(e,n),n.checked=n.__value===t[0],w(e,s),w(e,r),w(r,l),w(e,f),d||(h=ne(n,"change",t[2]),d=!0)},p(p,g){g&2&&i!==(i=p[4].value)&&(n.__value=i,n.value=n.__value,o=!0),(o||g&3)&&(n.checked=n.__value===p[0]),g&2&&a!==(a=p[4].label+"")&&Ne(l,a),g&3&&u!==(u="flex items-center justify-center py-2 text-sm font-medium text-gray-700 border-b "+(p[4].value===p[0]?"border-indigo-500 border-b-2":"border-gray-300")+" cursor-pointer hover:bg-gray-900 hover:bg-opacity-5")&&m(r,"class",u)},d(p){p&&b(e),c.r(),d=!1,h()}}}function Ni(t){let e,n=t[1],i=[];for(let o=0;o<n.length;o+=1)i[o]=xt(Kt(t,n,o));return{c(){e=k("nav");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=I(o,"NAV",{class:!0});var s=S(e);for(let r=0;r<i.length;r+=1)i[r].l(s);s.forEach(b),this.h()},h(){m(e,"class","flex w-full")},m(o,s){U(o,e,s);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,null)},p(o,[s]){if(s&3){n=o[1];let r;for(r=0;r<n.length;r+=1){const a=Kt(o,n,r);i[r]?i[r].p(a,s):(i[r]=xt(a),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=n.length}},i:re,o:re,d(o){o&&b(e),Ge(i,o)}}}function Oi(t,e,n){let{tabs:i}=e,{selected:o}=e;const s=[[]];function r(){o=this.__value,n(0,o)}return t.$$set=a=>{"tabs"in a&&n(1,i=a.tabs),"selected"in a&&n(0,o=a.selected)},[o,i,r,s]}class Ui extends le{constructor(e){super(),ue(this,e,Oi,Ni,fe,{tabs:1,selected:0})}}function Bi(t){let e,n,i,o,s,r,a;return{c(){e=k("div"),n=k("label"),i=K(t[1]),o=P(),s=k("input"),this.h()},l(l){e=I(l,"DIV",{});var u=S(e);n=I(u,"LABEL",{for:!0,class:!0});var f=S(n);i=x(f,t[1]),f.forEach(b),o=N(u),s=I(u,"INPUT",{id:!0,type:!0,min:!0,max:!0,step:!0,name:!0,class:!0}),u.forEach(b),this.h()},h(){m(n,"for",t[6]),m(n,"class","block mb-2 text-sm font-medium text-gray-900 dark:text-white"),m(s,"id",t[6]),m(s,"type","range"),m(s,"min",t[3]),m(s,"max",t[4]),m(s,"step",t[5]),m(s,"name",t[2]),m(s,"class","w-full h-1.5 mb-6 bg-white ring-1 ring-gray-300 shadow-sm rounded-lg appearance-none cursor-pointer accent-indigo-600 dark:bg-gray-700")},m(l,u){U(l,e,u),w(e,n),w(n,i),w(e,o),w(e,s),ot(s,t[0]),r||(a=[ne(s,"change",t[7]),ne(s,"input",t[7])],r=!0)},p(l,[u]){u&2&&Ne(i,l[1]),u&8&&m(s,"min",l[3]),u&16&&m(s,"max",l[4]),u&32&&m(s,"step",l[5]),u&4&&m(s,"name",l[2]),u&1&&ot(s,l[0])},i:re,o:re,d(l){l&&b(e),r=!1,Le(a)}}}function Fi(t,e,n){let{label:i}=e,{name:o=void 0}=e,{min:s=null}=e,{max:r=null}=e,{value:a=0}=e,{step:l=1}=e,u=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);function f(){a=Rt(this.value),n(0,a)}return t.$$set=c=>{"label"in c&&n(1,i=c.label),"name"in c&&n(2,o=c.name),"min"in c&&n(3,s=c.min),"max"in c&&n(4,r=c.max),"value"in c&&n(0,a=c.value),"step"in c&&n(5,l=c.step)},[a,i,o,s,r,l,u,f]}class Lt extends le{constructor(e){super(),ue(this,e,Fi,Bi,fe,{label:1,name:2,min:3,max:4,value:0,step:5})}}function qe(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function $t(t,e,n){const i=t.slice();return i[6]=e[n],i}function en(t){let e,n=t[6].name+"",i,o,s;return{c(){e=k("option"),i=K(n),this.h()},l(r){e=I(r,"OPTION",{});var a=S(e);i=x(a,n),a.forEach(b),this.h()},h(){e.__value=o=t[6].value,e.value=e.__value,e.selected=s=t[6].value===t[0]},m(r,a){U(r,e,a),w(e,i)},p(r,a){a&2&&n!==(n=r[6].name+"")&&Ne(i,n),a&2&&o!==(o=r[6].value)&&(e.__value=o,e.value=e.__value),a&3&&s!==(s=r[6].value===r[0])&&(e.selected=s)},d(r){r&&b(e)}}}function Xi(t){let e,n,i,o,s,r,a,l=t[1],u=[];for(let f=0;f<l.length;f+=1)u[f]=en($t(t,l,f));return{c(){e=k("div"),n=k("label"),i=K(t[2]),o=P(),s=k("select");for(let f=0;f<u.length;f+=1)u[f].c();this.h()},l(f){e=I(f,"DIV",{});var c=S(e);n=I(c,"LABEL",{for:!0,class:!0});var d=S(n);i=x(d,t[2]),d.forEach(b),o=N(c),s=I(c,"SELECT",{id:!0,name:!0,class:!0});var h=S(s);for(let p=0;p<u.length;p+=1)u[p].l(h);h.forEach(b),c.forEach(b),this.h()},h(){m(n,"for",t[4]),m(n,"class","block text-sm font-medium leading-6 text-gray-900"),m(s,"id",t[4]),m(s,"name",t[3]),m(s,"class","mt-2 block w-full rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6"),t[0]===void 0&&Xn(()=>t[5].call(s))},m(f,c){U(f,e,c),w(e,n),w(n,i),w(e,o),w(e,s);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(s,null);Bt(s,t[0],!0),r||(a=ne(s,"change",t[5]),r=!0)},p(f,[c]){if(c&4&&Ne(i,f[2]),c&3){l=f[1];let d;for(d=0;d<l.length;d+=1){const h=$t(f,l,d);u[d]?u[d].p(h,c):(u[d]=en(h),u[d].c(),u[d].m(s,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=l.length}c&8&&m(s,"name",f[3]),c&3&&Bt(s,f[0])},i:re,o:re,d(f){f&&b(e),Ge(u,f),r=!1,a()}}}function zi(t,e,n){let{options:i}=e,{selected:o}=e,{label:s}=e,{name:r=void 0}=e;const a=qe();function l(){o=zn(this),n(0,o),n(1,i)}return t.$$set=u=>{"options"in u&&n(1,i=u.options),"selected"in u&&n(0,o=u.selected),"label"in u&&n(2,s=u.label),"name"in u&&n(3,r=u.name)},[o,i,s,r,a,l]}class Rn extends le{constructor(e){super(),ue(this,e,zi,Xi,fe,{options:1,selected:0,label:2,name:3})}}function Vi(t){let e,n,i,o,s,r;function a(c){t[5](c)}let l={label:"Diffusion Mode",options:t[2]};t[1]!==void 0&&(l.selected=t[1]),e=new Rn({props:l}),Q.push(()=>ee(e,"selected",a));function u(c){t[6](c)}let f={label:"Diffusion Strength ("+t[0]+")",min:0,max:2,step:.01};return t[0]!==void 0&&(f.value=t[0]),o=new Lt({props:f}),Q.push(()=>ee(o,"value",u)),{c(){V(e.$$.fragment),i=P(),V(o.$$.fragment)},l(c){W(e.$$.fragment,c),i=N(c),W(o.$$.fragment,c)},m(c,d){H(e,c,d),U(c,i,d),H(o,c,d),r=!0},p(c,[d]){const h={};!n&&d&2&&(n=!0,h.selected=c[1],te(()=>n=!1)),e.$set(h);const p={};d&1&&(p.label="Diffusion Strength ("+c[0]+")"),!s&&d&1&&(s=!0,p.value=c[0],te(()=>s=!1)),o.$set(p)},i(c){r||(R(e.$$.fragment,c),R(o.$$.fragment,c),r=!0)},o(c){L(e.$$.fragment,c),L(o.$$.fragment,c),r=!1},d(c){Y(e,c),c&&b(i),Y(o,c)}}}function Wi(t,e,n){let{diffusionStrength:i}=e,{diffusionMatrix:o}=e,{diffusionOriginX:s}=e,r="floyd_steinberg";const a=[{name:"Basic",value:"basic"},{name:"Floyd-Steinberg",value:"floyd_steinberg"},{name:"Atkinson",value:"atkinson"},{name:"Jarvis-Judice-Ninke",value:"jarvis_judice_ninke"}],l={basic:{matrix:[[0,1/2],[1/2,0]],originX:0},floyd_steinberg:{matrix:[[0,0,7/16],[3/16,5/16,1/16]],originX:1},atkinson:{matrix:[[0,0,1/8,1/8],[1/8,1/8,1/8,0],[0,1/8,0,0]],originX:1},jarvis_judice_ninke:{matrix:[[0,0,0,7/48,5/48],[3/48,5/48,7/48,5/48,3/48],[1/48,3/48,5/48,3/48,1/48]],originX:2}};function u(c){r=c,n(1,r)}function f(c){i=c,n(0,i)}return t.$$set=c=>{"diffusionStrength"in c&&n(0,i=c.diffusionStrength),"diffusionMatrix"in c&&n(3,o=c.diffusionMatrix),"diffusionOriginX"in c&&n(4,s=c.diffusionOriginX)},t.$$.update=()=>{if(t.$$.dirty&2){const{matrix:c,originX:d}=l[r];n(3,o=c),n(4,s=d)}},[i,r,a,o,s,u,f]}class Hi extends le{constructor(e){super(),ue(this,e,Wi,Vi,fe,{diffusionStrength:0,diffusionMatrix:3,diffusionOriginX:4})}}function wt(t){const e=t.toString(16);return e.length==1?"0"+e:e}function Yi(t,e,n){return"#"+wt(t)+wt(e)+wt(n)}function tn(t,e,n){const i=t.slice();i[6]=e[n],i[9]=n;const o=Yi(...i[6]);return i[7]=o,i}function nn(t){let e,n,i,o,s,r,a,l,u;function f(...d){return t[4](t[9],...d)}r=new Te({props:{src:bn,class:"w-4 h-4 text-white"}});function c(){return t[5](t[9])}return{c(){e=k("li"),n=k("input"),o=P(),s=k("button"),V(r.$$.fragment),this.h()},l(d){e=I(d,"LI",{style:!0,class:!0});var h=S(e);n=I(h,"INPUT",{type:!0,class:!0}),o=N(h),s=I(h,"BUTTON",{class:!0});var p=S(s);W(r.$$.fragment,p),p.forEach(b),h.forEach(b),this.h()},h(){m(n,"type","color"),n.value=i=t[7],m(n,"class","absolute inset-0 w-full h-full opacity-0"),m(s,"class","absolute top-1/2 -translate-y-1/2 right-2 p-1 bg-black bg-opacity-40 rounded-full"),Se(e,"background-color",t[7]),m(e,"class","relative rounded-md h-10")},m(d,h){U(d,e,h),w(e,n),w(e,o),w(e,s),H(r,s,null),a=!0,l||(u=[ne(n,"input",f),ne(s,"click",c)],l=!0)},p(d,h){t=d,(!a||h&1&&i!==(i=t[7]))&&(n.value=i),(!a||h&1)&&Se(e,"background-color",t[7])},i(d){a||(R(r.$$.fragment,d),a=!0)},o(d){L(r.$$.fragment,d),a=!1},d(d){d&&b(e),Y(r),l=!1,Le(u)}}}function ji(t){let e,n,i,o,s,r,a,l,u,f,c,d=t[0],h=[];for(let g=0;g<d.length;g+=1)h[g]=nn(tn(t,d,g));const p=g=>L(h[g],1,1,()=>{h[g]=null});return s=new Te({props:{src:pn,class:"w-4 h-4"}}),{c(){e=k("ul");for(let g=0;g<h.length;g+=1)h[g].c();n=P(),i=k("li"),o=k("button"),V(s.$$.fragment),r=P(),a=k("span"),l=K("Color"),this.h()},l(g){e=I(g,"UL",{class:!0});var E=S(e);for(let M=0;M<h.length;M+=1)h[M].l(E);n=N(E),i=I(E,"LI",{});var _=S(i);o=I(_,"BUTTON",{class:!0});var v=S(o);W(s.$$.fragment,v),r=N(v),a=I(v,"SPAN",{});var y=S(a);l=x(y,"Color"),y.forEach(b),v.forEach(b),_.forEach(b),E.forEach(b),this.h()},h(){m(o,"class","flex items-center justify-center gap-1 w-full h-10 bg-emerald-500 text-white rounded-md"),m(e,"class","grid gap-2 grid-cols-3")},m(g,E){U(g,e,E);for(let _=0;_<h.length;_+=1)h[_]&&h[_].m(e,null);w(e,n),w(e,i),w(i,o),H(s,o,null),w(o,r),w(o,a),w(a,l),u=!0,f||(c=ne(o,"click",t[1]),f=!0)},p(g,[E]){if(E&13){d=g[0];let _;for(_=0;_<d.length;_+=1){const v=tn(g,d,_);h[_]?(h[_].p(v,E),R(h[_],1)):(h[_]=nn(v),h[_].c(),R(h[_],1),h[_].m(e,n))}for(Fe(),_=d.length;_<h.length;_+=1)p(_);Xe()}},i(g){if(!u){for(let E=0;E<d.length;E+=1)R(h[E]);R(s.$$.fragment,g),u=!0}},o(g){h=h.filter(Boolean);for(let E=0;E<h.length;E+=1)L(h[E]);L(s.$$.fragment,g),u=!1},d(g){g&&b(e),Ge(h,g),Y(s),f=!1,c()}}}function qi(){return[Math.random()*255,Math.random()*255,Math.random()*255].map(Math.round)}function Gi(t,e,n){let{colors:i}=e;function o(){n(0,i=[...i,qi()])}function s(u){n(0,i=i.filter((f,c)=>c!==u))}function r(u,f){const d=u.target.value;n(0,i[f]=ce(d),i)}const a=(u,f)=>r(f,u),l=u=>s(u);return t.$$set=u=>{"colors"in u&&n(0,i=u.colors)},[i,o,s,r,a,l]}class Qi extends le{constructor(e){super(),ue(this,e,Gi,ji,fe,{colors:0})}}const Zi=8,Ln=5,rn=1e3,Et=Ln,pe=Zi-Ln,Ji=.75;function Tt(t,e){return t<e?-1:t>e?1:0}class Mt{constructor(e){Ee(this,"contents",[]);Ee(this,"isSorted",!1);this.compareFn=e}sort(){this.isSorted||(this.contents.sort(this.compareFn),this.isSorted=!0)}push(e){this.contents.push(e),this.isSorted=!1}peek(e){return this.sort(),e===void 0&&(e=this.contents.length-1),this.contents[e]}pop(){return this.sort(),this.contents.pop()}size(){return this.contents.length}map(e){return this.contents.map(e)}[Symbol.iterator](){return this.sort(),this.contents[Symbol.iterator]()}}class Pt{constructor(e,n,i,o,s,r,a){Ee(this,"_count");Ee(this,"_avg");this.r1=e,this.r2=n,this.g1=i,this.g2=o,this.b1=s,this.b2=r,this.histogram=a}volume(){return(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)}count(e=!1){if(this._count===void 0||e){let n=0;for(const[i,o,s]of this.colors())n+=this.histogram.sampleWithReducedColor(i,o,s);this._count=n}return this._count}copy(){return new Pt(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histogram)}avg(e=!1){if(!this._avg||e){let n=0;const i=1<<pe;let o=0,s=0,r=0;for(const[a,l,u]of this.colors()){let f=this.histogram.sampleWithReducedColor(a,l,u);n+=f,o+=f*(a+.5)*i,s+=f*(l+.5)*i,r+=f*(u+.5)*i}n>0?this._avg=[Math.floor(o/n),Math.floor(s/n),Math.floor(r/n)]:this._avg=[Math.floor(i*(this.r1+this.r2+1)/2),Math.floor(i*(this.g1+this.g2+1)/2),Math.floor(i*(this.b1+this.b2+1)/2)]}return this._avg}contains(e){const n=e[0]>>pe,i=e[1]>>pe,o=e[2]>>pe;return n>=this.r1&&n<=this.r2&&i>=this.g1&&i<=this.g2&&o>=this.b1&&o<=this.b2}*colors(){for(let e=this.r1;e<=this.r2;e++)for(let n=this.g1;n<=this.g2;n++)for(let i=this.b1;i<=this.b2;i++)yield[e,n,i]}}class Ki{constructor(){Ee(this,"boxes");this.boxes=new Mt((e,n)=>Tt(e.vbox.count()*e.vbox.volume(),n.vbox.count()*n.vbox.volume()))}push(e){this.boxes.push({vbox:e,color:e.avg()})}palette(){return this.boxes.map(e=>e.color)}size(){return this.boxes.size()}map(e){for(const n of this.boxes)if(n.vbox.contains(e))return n.color;return this.nearest(e)}nearest(e){let n,i,o;for(const s of this.boxes)i=Math.sqrt(Math.pow(e[0]-s.color[0],2)+Math.pow(e[1]-s.color[1],2)+Math.pow(e[2]-s.color[2],2)),(n===void 0||i<n)&&(n=i,o=s.color);return o}}class ft{constructor(e){Ee(this,"histogram",new Array(1<<3*Et));for(let n=0;n<e.length;n+=4){let i=e[n]>>pe,o=e[n+1]>>pe,s=e[n+2]>>pe,r=ft.getColorIndex(i,o,s);this.histogram[r]=(this.histogram[r]??0)+1}}sample(e,n,i){const o=e>>pe,s=n>>pe,r=i>>pe;return this.sampleWithReducedColor(o,s,r)}sampleWithReducedColor(e,n,i){const o=ft.getColorIndex(e,n,i);return this.histogram[o]??0}static getColorIndex(e,n,i){return(e<<2*Et)+(n<<Et)+i}}function xi(t,e){let n=1e6,i=0,o=1e6,s=0,r=1e6,a=0;for(let l=0;l<t.length;l+=4){const u=t[l]>>pe,f=t[l+1]>>pe,c=t[l+2]>>pe;u<n?n=u:u>i&&(i=u),f<o?o=f:f>s&&(s=f),c<r?r=c:c>a&&(a=c)}return new Pt(n,i,o,s,r,a,e)}function $i(t,e,n,i,o){const s=o+"1",r=o+"2";for(let a=t[s];a<=t[r];a++)if(e[a]>i/2){let l=t.copy(),u=t.copy(),f=a-t[s],c=t[r]-a,d,h=0;for(f<=c?d=Math.min(t[r]-1,~~(a+c/2)):d=Math.max(t[s],~~(a-1-f/2));!e[d];)d++;for(h=n[d];!h&&e[d-1];)h=n[--d];return l[r]=d,u[s]=l[r]+1,[l,u]}throw new Error("VBox can't be cut")}function er(t,e){if(!e.count())return[e.copy(),void 0];const n=e.r2-e.r1+1,i=e.g2-e.g1+1,o=e.b2-e.b1+1,s=Math.max(n,i,o);if(e.count()==1)return[e.copy(),void 0];let r=0;const a=[],l=[];if(s==n)for(let f=e.r1;f<=e.r2;f++){let c=0;for(let d=e.g1;d<=e.g2;d++)for(let h=e.b1;h<=e.b2;h++)c+=t.sampleWithReducedColor(f,d,h);r+=c,a[f]=r}else if(s==i)for(let f=e.g1;f<=e.g2;f++){let c=0;for(let d=e.r1;d<=e.r2;d++)for(let h=e.b1;h<=e.b2;h++)c+=t.sampleWithReducedColor(d,f,h);r+=c,a[f]=r}else if(s==o)for(let f=e.b1;f<=e.b2;f++){let c=0;for(let d=e.r1;d<=e.r2;d++)for(let h=e.g1;h<=e.g2;h++)c+=t.sampleWithReducedColor(d,h,f);r+=c,a[f]=r}else throw new Error("Not Reached");a.forEach(function(f,c){l[c]=r-f});const u=s==n?"r":s==i?"g":"b";return $i(e,a,l,r,u)}function tr(t,e){if(t.length<4||e<2||e>256)throw new Error("Invalid Arguments. There must be at least one pixel, and the max color must be between 2 and 256");const n=new ft(t),i=xi(t,n),o=new Mt((l,u)=>Tt(l.count(),u.count()));o.push(i);const s=(l,u)=>{let f=l.size(),c=0,d;for(;c<rn;){if(f>=u||c++>rn)return;if(d=l.pop(),!d||!d.count()){l.push(d),c++;continue}const[h,p]=er(n,d);l.push(h),p&&(l.push(p),f++)}};s(o,Ji*e);const r=new Mt(function(l,u){return Tt(l.count()*l.volume(),u.count()*u.volume())});for(;o.size();)r.push(o.pop());s(r,e);const a=new Ki;for(;r.size();)a.push(r.pop());return a}function nr(t,e,n=10){const i=ir(t.data,n),o=tr(i,e);return o?o.palette():null}function ir(t,e){const n=Math.floor(t.length/4),i=Math.max(1,Math.round(n/e)),o=new Uint8ClampedArray(i*4);for(let s=0;s<i;s++){const r=Math.round(s*n/i);o[s*4+0]=t[r*4+0],o[s*4+1]=t[r*4+1],o[s*4+2]=t[r*4+2],o[s*4+3]=t[r*4+3]}return o}function rr(){return new Worker(""+new URL("../workers/worker-b8220752.js",import.meta.url).href)}let sn=ht(new rr);async function sr(t){if(!sn)throw new Error("Worker not initialized");return await sn.generatePalette(t)}function on(t){let e,n,i,o,s;return{c(){e=k("span"),n=k("span"),i=K(t[2]),o=P(),s=K(t[3]),this.h()},l(r){e=I(r,"SPAN",{id:!0,class:!0});var a=S(e);n=I(a,"SPAN",{class:!0});var l=S(n);i=x(l,t[2]),o=N(l),l.forEach(b),s=x(a,t[3]),a.forEach(b),this.h()},h(){m(n,"class","sr-only"),m(e,"id",t[6]),m(e,"class","text-gray-500")},m(r,a){U(r,e,a),w(e,n),w(n,i),w(n,o),w(e,s)},p(r,a){a&4&&Ne(i,r[2]),a&8&&Ne(s,r[3])},d(r){r&&b(e)}}}function or(t){let e,n,i,o,s,r,a,l,u,f,c,d=t[3]&&on(t);return{c(){e=k("div"),n=k("div"),i=k("input"),s=P(),r=k("div"),a=k("label"),l=K(t[2]),u=P(),d&&d.c(),this.h()},l(h){e=I(h,"DIV",{class:!0});var p=S(e);n=I(p,"DIV",{class:!0});var g=S(n);i=I(g,"INPUT",{id:!0,"aria-describedby":!0,name:!0,type:!0,class:!0}),g.forEach(b),s=N(p),r=I(p,"DIV",{class:!0});var E=S(r);a=I(E,"LABEL",{for:!0,class:!0});var _=S(a);l=x(_,t[2]),_.forEach(b),u=N(E),d&&d.l(E),E.forEach(b),p.forEach(b),this.h()},h(){m(i,"id",t[5]),m(i,"aria-describedby",o=t[3]?t[6]:void 0),m(i,"name",t[4]),m(i,"type","checkbox"),m(i,"class","h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600"),m(n,"class","flex h-6 items-center"),m(a,"for",t[5]),m(a,"class","font-medium text-gray-900"),m(r,"class","ml-3 text-sm leading-6"),m(e,"class","relative flex items-start")},m(h,p){U(h,e,p),w(e,n),w(n,i),t[9](i),i.checked=t[0],w(e,s),w(e,r),w(r,a),w(a,l),w(r,u),d&&d.m(r,null),f||(c=[ne(i,"input",t[7]),ne(i,"change",t[8]),ne(i,"change",t[10])],f=!0)},p(h,[p]){p&8&&o!==(o=h[3]?h[6]:void 0)&&m(i,"aria-describedby",o),p&16&&m(i,"name",h[4]),p&1&&(i.checked=h[0]),p&4&&Ne(l,h[2]),h[3]?d?d.p(h,p):(d=on(h),d.c(),d.m(r,null)):d&&(d.d(1),d=null)},i:re,o:re,d(h){h&&b(e),t[9](null),d&&d.d(),f=!1,Le(c)}}}function ar(t,e,n){let{checked:i=!1}=e,{label:o}=e,{description:s=void 0}=e,{name:r=void 0}=e,{input:a=null}=e;const l=qe(),u=qe();function f(p){kt.call(this,t,p)}function c(p){kt.call(this,t,p)}function d(p){Q[p?"unshift":"push"](()=>{a=p,n(1,a)})}function h(){i=this.checked,n(0,i)}return t.$$set=p=>{"checked"in p&&n(0,i=p.checked),"label"in p&&n(2,o=p.label),"description"in p&&n(3,s=p.description),"name"in p&&n(4,r=p.name),"input"in p&&n(1,a=p.input)},[i,a,o,s,r,l,u,f,c,d,h]}class Pn extends le{constructor(e){super(),ue(this,e,ar,or,fe,{checked:0,label:2,description:3,name:4,input:1})}}function an(t,e,n){const i=t.slice();return i[15]=e[n].name,i[16]=e[n].palette,i[18]=n,i}function lr(t){let e,n,i,o,s,r=t[4],a=[];for(let l=0;l<r.length;l+=1)a[l]=ln(an(t,r,l));return{c(){e=k("select"),n=k("option"),i=K("Choose a Preset ");for(let l=0;l<a.length;l+=1)a[l].c();this.h()},l(l){e=I(l,"SELECT",{class:!0});var u=S(e);n=I(u,"OPTION",{});var f=S(n);i=x(f,"Choose a Preset "),f.forEach(b);for(let c=0;c<a.length;c+=1)a[c].l(u);u.forEach(b),this.h()},h(){n.__value=-1,n.value=n.__value,n.selected=!0,n.disabled=!0,m(e,"class","mt-2 block w-full rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6")},m(l,u){U(l,e,u),w(e,n),w(n,i);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(e,null);o||(s=ne(e,"input",t[5]),o=!0)},p(l,u){if(u&16){r=l[4];let f;for(f=0;f<r.length;f+=1){const c=an(l,r,f);a[f]?a[f].p(c,u):(a[f]=ln(c),a[f].c(),a[f].m(e,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=r.length}},d(l){l&&b(e),Ge(a,l),o=!1,s()}}}function ur(t){let e,n,i,o,s,r,a;return{c(){e=k("label"),n=k("span"),i=K("Number of Colors"),o=P(),s=k("input"),this.h()},l(l){e=I(l,"LABEL",{class:!0});var u=S(e);n=I(u,"SPAN",{class:!0});var f=S(n);i=x(f,"Number of Colors"),f.forEach(b),o=N(u),s=I(u,"INPUT",{type:!0,min:!0,max:!0,class:!0}),u.forEach(b),this.h()},h(){m(n,"class","font-medium text-gray-900 text-sm"),m(s,"type","number"),m(s,"min",Dt),m(s,"max",Ct),m(s,"class","block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),m(e,"class","flex justify-between items-center")},m(l,u){U(l,e,u),w(e,n),w(n,i),w(e,o),w(e,s),ot(s,t[2]),r||(a=[ne(s,"input",t[11]),ne(s,"blur",t[12]),ne(s,"input",t[6])],r=!0)},p(l,u){u&4&&Rt(s.value)!==l[2]&&ot(s,l[2])},d(l){l&&b(e),r=!1,Le(a)}}}function ln(t){let e,n=t[15]+"",i,o;return{c(){e=k("option"),i=K(n),o=P(),this.h()},l(s){e=I(s,"OPTION",{});var r=S(e);i=x(r,n),o=N(r),r.forEach(b),this.h()},h(){e.__value=t[18],e.value=e.__value},m(s,r){U(s,e,r),w(e,i),w(e,o)},p:re,d(s){s&&b(e)}}}function fr(t){let e,n,i,o,s,r,a,l,u;function f(v){t[9](v)}function c(v){t[10](v)}let d={label:"Extract Colors from Image"};t[1]!==void 0&&(d.checked=t[1]),t[3]!==void 0&&(d.input=t[3]),n=new Pn({props:d}),Q.push(()=>ee(n,"checked",f)),Q.push(()=>ee(n,"input",c)),n.$on("input",t[6]);function h(v,y){return v[1]?ur:lr}let p=h(t),g=p(t);function E(v){t[13](v)}let _={};return t[0]!==void 0&&(_.colors=t[0]),a=new Qi({props:_}),Q.push(()=>ee(a,"colors",E)),{c(){e=k("fieldset"),V(n.$$.fragment),s=P(),g.c(),r=P(),V(a.$$.fragment),this.h()},l(v){e=I(v,"FIELDSET",{class:!0});var y=S(e);W(n.$$.fragment,y),s=N(y),g.l(y),r=N(y),W(a.$$.fragment,y),y.forEach(b),this.h()},h(){m(e,"class","grid gap-4")},m(v,y){U(v,e,y),H(n,e,null),w(e,s),g.m(e,null),w(e,r),H(a,e,null),u=!0},p(v,[y]){const M={};!i&&y&2&&(i=!0,M.checked=v[1],te(()=>i=!1)),!o&&y&8&&(o=!0,M.input=v[3],te(()=>o=!1)),n.$set(M),p===(p=h(v))&&g?g.p(v,y):(g.d(1),g=p(v),g&&(g.c(),g.m(e,r)));const X={};!l&&y&1&&(l=!0,X.colors=v[0],te(()=>l=!1)),a.$set(X)},i(v){u||(R(n.$$.fragment,v),R(a.$$.fragment,v),u=!0)},o(v){L(n.$$.fragment,v),L(a.$$.fragment,v),u=!1},d(v){v&&b(e),Y(n),g.d(),Y(a)}}}const Ct=256,Dt=2;function cr(t,e,n){let{image:i=null}=e,{palette:o=null}=e,{colors:s=["#000000","#ffffff"].map(ce)}=e;const r=[{name:"Black and White",palette:["#000000","#ffffff"].map(ce)},{name:"3Bit",palette:["#000000","#ffffff","#ff0000","#00ff00","#0000ff","#ffff00","#00ffff","#ff00ff"].map(ce)},{name:"Grayscale",palette:["#000000","#333333","#666666","#999999","#cccccc","#ffffff"].map(ce)},{name:"Red",palette:["#000000","#F46842","#AA2F0D","#ffffff"].map(ce)},{name:"RGBY",palette:["#ff0000","#00ff00","#0000ff","#ffff00"].map(ce)},{name:"Black, White, Red",palette:["#000000","#ffffff","#ff0000"].map(ce)},{name:"Black, White, Yellow",palette:["#000000","#ffffff","#ffff00"].map(ce)},{name:"Macintosh",palette:["#33321A","#E5FEFF"].map(ce)},{name:"IBM 5151",palette:["#00EB61","#25332F"].map(ce)},{name:"Zenith ZVM 1240",palette:["#40291e","#fdca55"].map(ce)},{name:"Commodore 1084",palette:["#423091","#88d7de"].map(ce)},{name:"IBM 8503",palette:["#25332F","#EBE5CE"].map(ce)},{name:"Game Boy DMG-01",palette:["#CADC9F","#0F380F","#306230","#8BAC0F","#9BBC0F"].map(ce)},{name:"MS Paint Vista",palette:["#000000","#464646","#787878","#b4b4b4","#dcdcdc","#ffffff","#990030","#9c5a3c","#ed1c24","#ffa3b1","#ff7e00","#e5aa7a","#ffc20e","#f5e49c","#fff200","#fff9bd","#a8e61d","#d3f9bc","#22b14c","#9dbb61","#00b7ef","#99d9ea","#4d6df3","#709ad1","#2f3699","#546d8e","#6f3198","#b5a5d5"].map(ce)}];async function a(v,y){const M=nr(v,y,5);if(!M)throw new Error("Failed to generate palette");return M}let l=!0,u=16;function f(v){const y=v.target,M=y.value;n(0,s=r[Number(M)].palette),y.value="-1"}let c=null;function d(){n(1,l=(c==null?void 0:c.checked)??!0),i&&l&&a(i,St(u,Dt,Ct)).then(v=>n(0,s=v))}i&&d();function h(v){l=v,n(1,l)}function p(v){c=v,n(3,c)}function g(){u=Rt(this.value),n(2,u)}const E=v=>{n(2,u=St(u,Dt,Ct)),console.log(u)};function _(v){s=v,n(0,s)}return t.$$set=v=>{"image"in v&&n(8,i=v.image),"palette"in v&&n(7,o=v.palette),"colors"in v&&n(0,s=v.colors)},t.$$.update=()=>{t.$$.dirty&1&&sr(s).then(v=>n(7,o=v))},[s,l,u,c,r,f,d,o,i,h,p,g,E,_]}class dr extends le{constructor(e){super(),ue(this,e,cr,fr,fe,{image:8,palette:7,colors:0})}}function hr(t){let e,n,i,o,s,r,a,l,u,f,c,d,h,p,g,E,_,v,y,M,X,q,B,T,O,C,Z,se,z,de,J;return g=new Te({props:{src:Hn,class:"w-4 h-4",solid:!0}}),{c(){e=k("fieldset"),n=k("div"),i=k("label"),o=K("Width"),r=P(),a=k("div"),l=k("input"),u=P(),f=k("div"),c=K("px"),h=P(),p=k("span"),V(g.$$.fragment),_=P(),v=k("div"),y=k("label"),M=K("Height"),q=P(),B=k("div"),T=k("input"),O=P(),C=k("div"),Z=K("px"),this.h()},l(F){e=I(F,"FIELDSET",{class:!0});var G=S(e);n=I(G,"DIV",{class:!0});var be=S(n);i=I(be,"LABEL",{for:!0,class:!0});var ie=S(i);o=x(ie,"Width"),ie.forEach(b),r=N(be),a=I(be,"DIV",{class:!0});var ve=S(a);l=I(ve,"INPUT",{name:!0,id:!0,type:!0,min:!0,max:!0,step:!0,class:!0,placeholder:!0}),u=N(ve),f=I(ve,"DIV",{class:!0});var ae=S(f);c=x(ae,"px"),ae.forEach(b),ve.forEach(b),be.forEach(b),h=N(G),p=I(G,"SPAN",{class:!0});var he=S(p);W(g.$$.fragment,he),he.forEach(b),_=N(G),v=I(G,"DIV",{class:!0});var ye=S(v);y=I(ye,"LABEL",{for:!0,class:!0});var Me=S(y);M=x(Me,"Height"),Me.forEach(b),q=N(ye),B=I(ye,"DIV",{class:!0});var me=S(B);T=I(me,"INPUT",{type:!0,id:!0,name:!0,min:!0,max:!0,step:!0,class:!0,placeholder:!0}),O=N(me),C=I(me,"DIV",{class:!0});var Ce=S(C);Z=x(Ce,"px"),Ce.forEach(b),me.forEach(b),ye.forEach(b),G.forEach(b),this.h()},h(){m(i,"for","width-"+t[9]),m(i,"class",s="block text-sm font-medium leading-6 "+(t[5]?"text-gray-400":"text-gray-900")),m(l,"name","width"),m(l,"id","width-"+t[9]),m(l,"type","number"),m(l,"min",t[3]),m(l,"max",t[1]),l.disabled=t[5],m(l,"step","1"),l.value=t[0],m(l,"class","block w-full rounded-md border-0 py-1.5 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 disabled:cursor-not-allowed disabled:bg-white disabled:text-gray-400 disabled:ring-gray-200"),m(l,"placeholder","600"),m(f,"class","pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400"),m(a,"class",d="relative mt-2 rounded-md "+(t[5]?"shadow-none":"shadow-sm")),m(n,"class","w-full"),m(p,"class",E="pb-2 cursor-not-allowed "+(t[5]?"text-gray-300":"text-gray-500")),m(y,"for","height-"+t[10]),m(y,"class",X="block text-sm font-medium leading-6 "+(t[5]?"text-gray-400":"text-gray-900")),m(T,"type","number"),m(T,"id","height-"+t[10]),m(T,"name","height"),m(T,"min",t[4]),m(T,"max",t[2]),m(T,"step","1"),T.value=t[6],T.disabled=t[5],m(T,"class","block w-full rounded-md border-0 py-1.5 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 disabled:cursor-not-allowed disabled:bg-white disabled:text-gray-400 disabled:ring-gray-200"),m(T,"placeholder","340"),m(C,"class","pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400"),m(B,"class",se="relative mt-2 rounded-md "+(t[5]?"shadow-none":"shadow-sm")),m(v,"class","w-full"),m(e,"class","flex gap-3 items-end justify-between")},m(F,G){U(F,e,G),w(e,n),w(n,i),w(i,o),w(n,r),w(n,a),w(a,l),w(a,u),w(a,f),w(f,c),w(e,h),w(e,p),H(g,p,null),w(e,_),w(e,v),w(v,y),w(y,M),w(v,q),w(v,B),w(B,T),w(B,O),w(B,C),w(C,Z),z=!0,de||(J=[ne(l,"input",t[7]),ne(T,"input",t[8])],de=!0)},p(F,[G]){(!z||G&32&&s!==(s="block text-sm font-medium leading-6 "+(F[5]?"text-gray-400":"text-gray-900")))&&m(i,"class",s),(!z||G&8)&&m(l,"min",F[3]),(!z||G&2)&&m(l,"max",F[1]),(!z||G&32)&&(l.disabled=F[5]),(!z||G&1&&l.value!==F[0])&&(l.value=F[0]),(!z||G&32&&d!==(d="relative mt-2 rounded-md "+(F[5]?"shadow-none":"shadow-sm")))&&m(a,"class",d),(!z||G&32&&E!==(E="pb-2 cursor-not-allowed "+(F[5]?"text-gray-300":"text-gray-500")))&&m(p,"class",E),(!z||G&32&&X!==(X="block text-sm font-medium leading-6 "+(F[5]?"text-gray-400":"text-gray-900")))&&m(y,"class",X),(!z||G&16)&&m(T,"min",F[4]),(!z||G&4)&&m(T,"max",F[2]),(!z||G&64&&T.value!==F[6])&&(T.value=F[6]),(!z||G&32)&&(T.disabled=F[5]),(!z||G&32&&se!==(se="relative mt-2 rounded-md "+(F[5]?"shadow-none":"shadow-sm")))&&m(B,"class",se)},i(F){z||(R(g.$$.fragment,F),z=!0)},o(F){L(g.$$.fragment,F),z=!1},d(F){F&&b(e),Y(g),de=!1,Le(J)}}}function mr(t,e,n){let i,{width:o}=e,{aspectRatio:s}=e,{maxWidth:r=null}=e,{maxHeight:a=null}=e,{minWidth:l=null}=e,{minHeight:u=null}=e,{disabled:f=!1}=e;function c(g){const E=g.target.value;E&&(l!==null&&E<l||r!==null&&E>r||n(0,o=E))}function d(g){const E=g.target.value;E&&(u!==null&&E<u||a!==null&&E>a||n(0,o=Math.round(s*E)))}let h=qe(),p=qe();return t.$$set=g=>{"width"in g&&n(0,o=g.width),"aspectRatio"in g&&n(11,s=g.aspectRatio),"maxWidth"in g&&n(1,r=g.maxWidth),"maxHeight"in g&&n(2,a=g.maxHeight),"minWidth"in g&&n(3,l=g.minWidth),"minHeight"in g&&n(4,u=g.minHeight),"disabled"in g&&n(5,f=g.disabled)},t.$$.update=()=>{t.$$.dirty&2049&&n(6,i=Math.round(o/s))},[o,r,a,l,u,f,i,c,d,h,p,s]}class Nn extends le{constructor(e){super(),ue(this,e,mr,hr,fe,{width:0,aspectRatio:11,maxWidth:1,maxHeight:2,minWidth:3,minHeight:4,disabled:5})}}const gr=t=>({}),un=t=>({});function _r(t){let e;const n=t[2].placeholder,i=tt(n,t,t[1],un),o=i||br();return{c(){o&&o.c()},l(s){o&&o.l(s)},m(s,r){o&&o.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&2)&&nt(i,n,s,s[1],e?rt(n,s[1],r,gr):it(s[1]),un)},i(s){e||(R(o,s),e=!0)},o(s){L(o,s),e=!1},d(s){o&&o.d(s)}}}function pr(t){let e,n,i,o;return{c(){e=k("canvas"),this.h()},l(s){e=I(s,"CANVAS",{class:!0,style:!0}),S(e).forEach(b),this.h()},h(){m(e,"class","w-full max-h-96 object-contain shadow-lg"),Se(e,"image-rendering","pixelated")},m(s,r){U(s,e,r),i||(o=Be(n=wr.call(null,e,t[0])),i=!0)},p(s,r){n&&dt(n.update)&&r&1&&n.update.call(null,s[0])},i:re,o:re,d(s){s&&b(e),i=!1,o()}}}function br(t){let e,n;return{c(){e=k("span"),n=K("No Image")},l(i){e=I(i,"SPAN",{});var o=S(e);n=x(o,"No Image"),o.forEach(b)},m(i,o){U(i,e,o),w(e,n)},p:re,d(i){i&&b(e)}}}function vr(t){let e,n,i,o;const s=[pr,_r],r=[];function a(l,u){return l[0]?0:1}return n=a(t),i=r[n]=s[n](t),{c(){e=k("div"),i.c(),this.h()},l(l){e=I(l,"DIV",{class:!0});var u=S(e);i.l(u),u.forEach(b),this.h()},h(){m(e,"class","w-full aspect-square rounded-lg bg-gray-100 p-8 grid place-items-center")},m(l,u){U(l,e,u),r[n].m(e,null),o=!0},p(l,[u]){let f=n;n=a(l),n===f?r[n].p(l,u):(Fe(),L(r[f],1,1,()=>{r[f]=null}),Xe(),i=r[n],i?i.p(l,u):(i=r[n]=s[n](l),i.c()),R(i,1),i.m(e,null))},i(l){o||(R(i),o=!0)},o(l){L(i),o=!1},d(l){l&&b(e),r[n].d()}}}function wr(t,e){const n=t.getContext("2d");if(!n)return;const i=()=>{t.width=e.width,t.height=e.height,n.putImageData(e,0,0)};let o=null;const s=()=>{o||(o=requestAnimationFrame(()=>{o=null,i()}))};return s(),{destroy(){o&&cancelAnimationFrame(o)},update:r=>{e=r,s()}}}function Er(t,e,n){let{$$slots:i={},$$scope:o}=e,{imageData:s}=e;return t.$$set=r=>{"imageData"in r&&n(0,s=r.imageData),"$$scope"in r&&n(1,o=r.$$scope)},[s,o,i]}class yr extends le{constructor(e){super(),ue(this,e,Er,vr,fe,{imageData:0})}}function kr(){return new Worker(""+new URL("../workers/worker-09b3192d.js",import.meta.url).href)}let yt=null;async function Ir(t){return yt||(yt=ht(new kr)),await yt.generate(t)}function fn(t){let e,n,i;function o(r){t[9](r)}let s={label:"Bayer Level ("+t[3]+")",min:0,max:5,step:1};return t[3]!==void 0&&(s.value=t[3]),e=new Lt({props:s}),Q.push(()=>ee(e,"value",o)),{c(){V(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,a){H(e,r,a),i=!0},p(r,a){const l={};a&8&&(l.label="Bayer Level ("+r[3]+")"),!n&&a&8&&(n=!0,l.value=r[3],te(()=>n=!1)),e.$set(l)},i(r){i||(R(e.$$.fragment,r),i=!0)},o(r){L(e.$$.fragment,r),i=!1},d(r){Y(e,r)}}}function cn(t){let e,n,i;function o(r){t[10](r)}let s={aspectRatio:1,minWidth:1,minHeight:1,maxHeight:3e3,maxWidth:3e3};return t[4]!==void 0&&(s.width=t[4]),e=new Nn({props:s}),Q.push(()=>ee(e,"width",o)),{c(){V(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,a){H(e,r,a),i=!0},p(r,a){const l={};!n&&a&16&&(n=!0,l.width=r[4],te(()=>n=!1)),e.$set(l)},i(r){i||(R(e.$$.fragment,r),i=!0)},o(r){L(e.$$.fragment,r),i=!1},d(r){Y(e,r)}}}function Sr(t){let e,n;return{c(){e=k("span"),n=K("Loading Threshold Map"),this.h()},l(i){e=I(i,"SPAN",{slot:!0});var o=S(e);n=x(o,"Loading Threshold Map"),o.forEach(b),this.h()},h(){m(e,"slot","placeholder")},m(i,o){U(i,e,o),w(e,n)},p:re,d(i){i&&b(e)}}}function Ar(t){let e,n,i,o,s,r,a,l,u,f;function c(_){t[7](_)}let d={label:"Noise Intensity ("+t[1]+")",min:0,max:1.5,step:.01};t[1]!==void 0&&(d.value=t[1]),e=new Lt({props:d}),Q.push(()=>ee(e,"value",c));function h(_){t[8](_)}let p={label:"Threshold Map",options:t[5]};t[2]!==void 0&&(p.selected=t[2]),o=new Rn({props:p}),Q.push(()=>ee(o,"selected",h));let g=t[2]==="bayer"&&fn(t),E=t[2]==="white_noise"&&cn(t);return u=new yr({props:{imageData:t[0],$$slots:{placeholder:[Sr]},$$scope:{ctx:t}}}),{c(){V(e.$$.fragment),i=P(),V(o.$$.fragment),r=P(),g&&g.c(),a=P(),E&&E.c(),l=P(),V(u.$$.fragment)},l(_){W(e.$$.fragment,_),i=N(_),W(o.$$.fragment,_),r=N(_),g&&g.l(_),a=N(_),E&&E.l(_),l=N(_),W(u.$$.fragment,_)},m(_,v){H(e,_,v),U(_,i,v),H(o,_,v),U(_,r,v),g&&g.m(_,v),U(_,a,v),E&&E.m(_,v),U(_,l,v),H(u,_,v),f=!0},p(_,[v]){const y={};v&2&&(y.label="Noise Intensity ("+_[1]+")"),!n&&v&2&&(n=!0,y.value=_[1],te(()=>n=!1)),e.$set(y);const M={};!s&&v&4&&(s=!0,M.selected=_[2],te(()=>s=!1)),o.$set(M),_[2]==="bayer"?g?(g.p(_,v),v&4&&R(g,1)):(g=fn(_),g.c(),R(g,1),g.m(a.parentNode,a)):g&&(Fe(),L(g,1,1,()=>{g=null}),Xe()),_[2]==="white_noise"?E?(E.p(_,v),v&4&&R(E,1)):(E=cn(_),E.c(),R(E,1),E.m(l.parentNode,l)):E&&(Fe(),L(E,1,1,()=>{E=null}),Xe());const X={};v&1&&(X.imageData=_[0]),v&2048&&(X.$$scope={dirty:v,ctx:_}),u.$set(X)},i(_){f||(R(e.$$.fragment,_),R(o.$$.fragment,_),R(g),R(E),R(u.$$.fragment,_),f=!0)},o(_){L(e.$$.fragment,_),L(o.$$.fragment,_),L(g),L(E),L(u.$$.fragment,_),f=!1},d(_){Y(e,_),_&&b(i),Y(o,_),_&&b(r),g&&g.d(_),_&&b(a),E&&E.d(_),_&&b(l),Y(u,_)}}}function Tr(t,e,n){let i,{thresholdMap:o}=e,{noiseIntensity:s}=e,r="bayer";const a=[{name:"Bayer",value:"bayer"},{name:"Blue Noise",value:"blue_noise"},{name:"White Noise",value:"white_noise"}];let l=3,u=256;function f(p){s=p,n(1,s)}function c(p){r=p,n(2,r)}function d(p){l=p,n(3,l)}function h(p){u=p,n(4,u)}return t.$$set=p=>{"thresholdMap"in p&&n(0,o=p.thresholdMap),"noiseIntensity"in p&&n(1,s=p.noiseIntensity)},t.$$.update=()=>{if(t.$$.dirty&16&&n(6,i=u),t.$$.dirty&92&&"ImageData"in globalThis){let p;switch(r){case"bayer":p={mode:"bayer",level:l};break;case"blue_noise":p={mode:"blue_noise"};break;case"white_noise":p={mode:"white_noise",width:u,height:i};break}Ir(p).then(g=>n(0,o=g))}},[o,s,r,l,u,a,i,f,c,d,h]}class Mr extends le{constructor(e){super(),ue(this,e,Tr,Ar,fe,{thresholdMap:0,noiseIntensity:1})}}function Cr(t){let e,n,i,o,s,r,a,l,u,f,c,d,h,p,g,E,_,v,y,M,X,q,B,T,O,C,Z,se,z,de,J,F,G,be,ie,ve,ae;function he(A){t[5](A)}let ye={label:"Original Size"};t[2]!==void 0&&(ye.checked=t[2]),s=new Pn({props:ye}),Q.push(()=>ee(s,"checked",he));function Me(A){t[6](A)}let me={aspectRatio:t[4],minWidth:12,minHeight:12,maxHeight:5e3,maxWidth:5e3,disabled:t[2]};t[3]!==void 0&&(me.width=t[3]),l=new Nn({props:me}),Q.push(()=>ee(l,"width",Me));function Ce(A){t[7](A)}let ze={tabs:[{label:"None",value:"none"},{label:"Ordered",value:"ordered"},{label:"Error Diffusion",value:"error_diffusion"}]};t[0].mode!==void 0&&(ze.selected=t[0].mode),g=new Ui({props:ze}),Q.push(()=>ee(g,"selected",Ce));function mt(A){t[8](A)}function gt(A){t[9](A)}function Ve(A){t[10](A)}let Oe={};t[0].diffusionStrength!==void 0&&(Oe.diffusionStrength=t[0].diffusionStrength),t[0].diffusionMatrix!==void 0&&(Oe.diffusionMatrix=t[0].diffusionMatrix),t[0].diffusionMatrixOriginX!==void 0&&(Oe.diffusionOriginX=t[0].diffusionMatrixOriginX),y=new Hi({props:Oe}),Q.push(()=>ee(y,"diffusionStrength",mt)),Q.push(()=>ee(y,"diffusionMatrix",gt)),Q.push(()=>ee(y,"diffusionOriginX",Ve));function _t(A){t[11](A)}function We(A){t[12](A)}let D={};t[0].thresholdMap!==void 0&&(D.thresholdMap=t[0].thresholdMap),t[0].noiseIntensity!==void 0&&(D.noiseIntensity=t[0].noiseIntensity),C=new Mr({props:D}),Q.push(()=>ee(C,"thresholdMap",_t)),Q.push(()=>ee(C,"noiseIntensity",We));function $(A){t[13](A)}let De={image:t[1]};return t[0].palette!==void 0&&(De.palette=t[0].palette),ie=new dr({props:De}),Q.push(()=>ee(ie,"palette",$)),{c(){e=k("div"),n=k("h2"),i=K("Output Image"),o=P(),V(s.$$.fragment),a=P(),V(l.$$.fragment),f=P(),c=k("div"),d=k("h2"),h=K("Dithering Options"),p=P(),V(g.$$.fragment),_=P(),v=k("div"),V(y.$$.fragment),T=P(),O=k("div"),V(C.$$.fragment),de=P(),J=k("div"),F=k("h2"),G=K("Colors"),be=P(),V(ie.$$.fragment),this.h()},l(A){e=I(A,"DIV",{class:!0});var j=S(e);n=I(j,"H2",{class:!0});var we=S(n);i=x(we,"Output Image"),we.forEach(b),o=N(j),W(s.$$.fragment,j),a=N(j),W(l.$$.fragment,j),j.forEach(b),f=N(A),c=I(A,"DIV",{class:!0});var oe=S(c);d=I(oe,"H2",{class:!0});var ge=S(d);h=x(ge,"Dithering Options"),ge.forEach(b),p=N(oe),W(g.$$.fragment,oe),_=N(oe),v=I(oe,"DIV",{class:!0});var _e=S(v);W(y.$$.fragment,_e),_e.forEach(b),T=N(oe),O=I(oe,"DIV",{class:!0});var ke=S(O);W(C.$$.fragment,ke),ke.forEach(b),oe.forEach(b),de=N(A),J=I(A,"DIV",{class:!0});var Ie=S(J);F=I(Ie,"H2",{class:!0});var He=S(F);G=x(He,"Colors"),He.forEach(b),be=N(Ie),W(ie.$$.fragment,Ie),Ie.forEach(b),this.h()},h(){m(n,"class","text-base font-semibold leading-7 text-black"),m(e,"class","grid gap-4"),m(d,"class","text-base font-semibold leading-7 text-black mb-2"),m(v,"class",B=t[0].mode==="error_diffusion"?"contents":"hidden"),m(O,"class",z=t[0].mode==="ordered"?"contents":"hidden"),m(c,"class","grid gap-4"),m(F,"class","text-base font-semibold leading-7 text-black mb-2"),m(J,"class","grid gap-3"),Ae(J,"hidden",t[0].mode==="none")},m(A,j){U(A,e,j),w(e,n),w(n,i),w(e,o),H(s,e,null),w(e,a),H(l,e,null),U(A,f,j),U(A,c,j),w(c,d),w(d,h),w(c,p),H(g,c,null),w(c,_),w(c,v),H(y,v,null),w(c,T),w(c,O),H(C,O,null),U(A,de,j),U(A,J,j),w(J,F),w(F,G),w(J,be),H(ie,J,null),ae=!0},p(A,[j]){const we={};!r&&j&4&&(r=!0,we.checked=A[2],te(()=>r=!1)),s.$set(we);const oe={};j&16&&(oe.aspectRatio=A[4]),j&4&&(oe.disabled=A[2]),!u&&j&8&&(u=!0,oe.width=A[3],te(()=>u=!1)),l.$set(oe);const ge={};!E&&j&1&&(E=!0,ge.selected=A[0].mode,te(()=>E=!1)),g.$set(ge);const _e={};!M&&j&1&&(M=!0,_e.diffusionStrength=A[0].diffusionStrength,te(()=>M=!1)),!X&&j&1&&(X=!0,_e.diffusionMatrix=A[0].diffusionMatrix,te(()=>X=!1)),!q&&j&1&&(q=!0,_e.diffusionOriginX=A[0].diffusionMatrixOriginX,te(()=>q=!1)),y.$set(_e),(!ae||j&1&&B!==(B=A[0].mode==="error_diffusion"?"contents":"hidden"))&&m(v,"class",B);const ke={};!Z&&j&1&&(Z=!0,ke.thresholdMap=A[0].thresholdMap,te(()=>Z=!1)),!se&&j&1&&(se=!0,ke.noiseIntensity=A[0].noiseIntensity,te(()=>se=!1)),C.$set(ke),(!ae||j&1&&z!==(z=A[0].mode==="ordered"?"contents":"hidden"))&&m(O,"class",z);const Ie={};j&2&&(Ie.image=A[1]),!ve&&j&1&&(ve=!0,Ie.palette=A[0].palette,te(()=>ve=!1)),ie.$set(Ie),(!ae||j&1)&&Ae(J,"hidden",A[0].mode==="none")},i(A){ae||(R(s.$$.fragment,A),R(l.$$.fragment,A),R(g.$$.fragment,A),R(y.$$.fragment,A),R(C.$$.fragment,A),R(ie.$$.fragment,A),ae=!0)},o(A){L(s.$$.fragment,A),L(l.$$.fragment,A),L(g.$$.fragment,A),L(y.$$.fragment,A),L(C.$$.fragment,A),L(ie.$$.fragment,A),ae=!1},d(A){A&&b(e),Y(s),Y(l),A&&b(f),A&&b(c),Y(g),Y(y),Y(C),A&&b(de),A&&b(J),Y(ie)}}}function Dr(t){return t?t.width/t.height:1}function Rr(t,e,n){let i,{image_data:o}=e,{config:s}=e,r=!0,a=o.width;function l(_){r=_,n(2,r)}function u(_){a=_,n(3,a)}function f(_){t.$$.not_equal(s.mode,_)&&(s.mode=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}function c(_){t.$$.not_equal(s.diffusionStrength,_)&&(s.diffusionStrength=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}function d(_){t.$$.not_equal(s.diffusionMatrix,_)&&(s.diffusionMatrix=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}function h(_){t.$$.not_equal(s.diffusionMatrixOriginX,_)&&(s.diffusionMatrixOriginX=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}function p(_){t.$$.not_equal(s.thresholdMap,_)&&(s.thresholdMap=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}function g(_){t.$$.not_equal(s.noiseIntensity,_)&&(s.noiseIntensity=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}function E(_){t.$$.not_equal(s.palette,_)&&(s.palette=_,n(0,s),n(4,i),n(2,r),n(1,o),n(3,a))}return t.$$set=_=>{"image_data"in _&&n(1,o=_.image_data),"config"in _&&n(0,s=_.config)},t.$$.update=()=>{t.$$.dirty&2&&n(4,i=Dr(o)),t.$$.dirty&17&&n(0,s.height=Math.round(s.width/i),s),t.$$.dirty&14&&n(0,s.width=r?o.width:a,s)},[s,o,r,a,i,l,u,f,c,d,h,p,g,E]}class dn extends le{constructor(e){super(),ue(this,e,Rr,Cr,fe,{image_data:1,config:0})}}function Lr(t){let e,n,i;function o(r){t[11](r)}let s={slot:"left",config:t[4],image_data:t[0]};return t[1]!==void 0&&(s.canvas=t[1]),e=new Dn({props:s}),Q.push(()=>ee(e,"canvas",o)),{c(){V(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,a){H(e,r,a),i=!0},p(r,a){const l={};a&16&&(l.config=r[4]),a&1&&(l.image_data=r[0]),!n&&a&2&&(n=!0,l.canvas=r[1],te(()=>n=!1)),e.$set(l)},i(r){i||(R(e.$$.fragment,r),i=!0)},o(r){L(e.$$.fragment,r),i=!1},d(r){Y(e,r)}}}function Pr(t){let e,n,i;function o(r){t[10](r)}let s={slot:"right",config:t[3],image_data:t[0]};return t[2]!==void 0&&(s.canvas=t[2]),e=new Dn({props:s}),Q.push(()=>ee(e,"canvas",o)),{c(){V(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,a){H(e,r,a),i=!0},p(r,a){const l={};a&8&&(l.config=r[3]),a&1&&(l.image_data=r[0]),!n&&a&4&&(n=!0,l.canvas=r[2],te(()=>n=!1)),e.$set(l)},i(r){i||(R(e.$$.fragment,r),i=!0)},o(r){L(e.$$.fragment,r),i=!1},d(r){Y(e,r)}}}function Nr(t){let e,n,i;return e=new Te({props:{src:vn,class:"w-4 h-4"}}),{c(){V(e.$$.fragment),n=K(`
					Save`)},l(o){W(e.$$.fragment,o),n=x(o,`
					Save`)},m(o,s){H(e,o,s),U(o,n,s),i=!0},p:re,i(o){i||(R(e.$$.fragment,o),i=!0)},o(o){L(e.$$.fragment,o),i=!1},d(o){Y(e,o),o&&b(n)}}}function Or(t){let e,n,i;return e=new Te({props:{src:vn,class:"w-4 h-4"}}),{c(){V(e.$$.fragment),n=K(`
					Save`)},l(o){W(e.$$.fragment,o),n=x(o,`
					Save`)},m(o,s){H(e,o,s),U(o,n,s),i=!0},p:re,i(o){i||(R(e.$$.fragment,o),i=!0)},o(o){L(e.$$.fragment,o),i=!1},d(o){Y(e,o),o&&b(n)}}}function Ur(t){let e,n,i,o,s,r,a,l,u,f,c,d,h,p,g,E,_,v,y,M,X,q,B,T,O,C,Z,se,z,de,J,F,G,be,ie,ve,ae,he,ye,Me,me,Ce,ze;i=new ai({props:{$$slots:{right:[Pr],left:[Lr]},$$scope:{ctx:t}}}),l=new Te({props:{src:bn,class:"w-5 h-5 text-white"}}),h=new Te({props:{src:t[5]?Ke:xe,class:"w-6 h-6 text-gray-500"}}),y=new zt({props:{disabled:!t[0],$$slots:{default:[Nr]},$$scope:{ctx:t}}}),y.$on("click",t[14]);function mt(D){t[15](D)}function gt(D){t[16](D)}let Ve={};t[4]!==void 0&&(Ve.config=t[4]),t[0]!==void 0&&(Ve.image_data=t[0]),q=new dn({props:Ve}),Q.push(()=>ee(q,"config",mt)),Q.push(()=>ee(q,"image_data",gt)),z=new Te({props:{src:t[6]?Ke:xe,class:"w-6 h-6 text-gray-500"}}),ie=new zt({props:{disabled:!t[0],$$slots:{default:[Or]},$$scope:{ctx:t}}}),ie.$on("click",t[18]);function Oe(D){t[19](D)}function _t(D){t[20](D)}let We={};return t[3]!==void 0&&(We.config=t[3]),t[0]!==void 0&&(We.image_data=t[0]),he=new dn({props:We}),Q.push(()=>ee(he,"config",Oe)),Q.push(()=>ee(he,"image_data",_t)),{c(){e=k("section"),n=k("div"),V(i.$$.fragment),o=P(),s=k("section"),r=k("header"),a=k("button"),V(l.$$.fragment),u=P(),f=k("aside"),c=k("header"),d=k("button"),V(h.$$.fragment),p=P(),g=k("div"),E=k("h1"),_=K("Options"),v=P(),V(y.$$.fragment),M=P(),X=k("div"),V(q.$$.fragment),O=P(),C=k("aside"),Z=k("header"),se=k("button"),V(z.$$.fragment),de=P(),J=k("div"),F=k("h1"),G=K("Options"),be=P(),V(ie.$$.fragment),ve=P(),ae=k("div"),V(he.$$.fragment),this.h()},l(D){e=I(D,"SECTION",{class:!0});var $=S(e);n=I($,"DIV",{class:!0});var De=S(n);W(i.$$.fragment,De),De.forEach(b),$.forEach(b),o=N(D),s=I(D,"SECTION",{class:!0});var A=S(s);r=I(A,"HEADER",{class:!0});var j=S(r);a=I(j,"BUTTON",{class:!0,title:!0});var we=S(a);W(l.$$.fragment,we),we.forEach(b),j.forEach(b),u=N(A),f=I(A,"ASIDE",{style:!0,class:!0});var oe=S(f);c=I(oe,"HEADER",{class:!0});var ge=S(c);d=I(ge,"BUTTON",{class:!0});var _e=S(d);W(h.$$.fragment,_e),_e.forEach(b),p=N(ge),g=I(ge,"DIV",{class:!0});var ke=S(g);E=I(ke,"H1",{class:!0});var Ie=S(E);_=x(Ie,"Options"),Ie.forEach(b),v=N(ke),W(y.$$.fragment,ke),ke.forEach(b),ge.forEach(b),M=N(oe),X=I(oe,"DIV",{class:!0});var He=S(X);W(q.$$.fragment,He),He.forEach(b),oe.forEach(b),O=N(A),C=I(A,"ASIDE",{style:!0,class:!0});var Qe=S(C);Z=I(Qe,"HEADER",{class:!0});var Ze=S(Z);se=I(Ze,"BUTTON",{class:!0});var Nt=S(se);W(z.$$.fragment,Nt),Nt.forEach(b),de=N(Ze),J=I(Ze,"DIV",{class:!0});var Je=S(J);F=I(Je,"H1",{class:!0});var Ot=S(F);G=x(Ot,"Options"),Ot.forEach(b),be=N(Je),W(ie.$$.fragment,Je),Je.forEach(b),Ze.forEach(b),ve=N(Qe),ae=I(Qe,"DIV",{class:!0});var Ut=S(ae);W(he.$$.fragment,Ut),Ut.forEach(b),Qe.forEach(b),A.forEach(b),this.h()},h(){m(n,"class","w-full h-full relative"),m(e,"class","overflow-hidden select-none fixed inset-0"),m(a,"class","p-2 bg-black bg-opacity-40 rounded-full touch-auto pointer-events-auto"),m(a,"title","Close Image & Reset"),m(r,"class","header svelte-1kb6xih"),m(d,"class","contents"),m(E,"class","font-bold"),m(g,"class","flex flex-1 items-center justify-between"),m(c,"class","py-4 px-4 flex-shrink-0 shadow-sm flex gap-2 items-center justify-between bg-white z-10"),m(X,"class","bg-gray-50 max-h-full flex-1 overflow-y-scroll p-4 py-8 flex flex-col gap-8"),Ae(X,"hidden",!t[5]),Se(f,"overflow","hidden"),m(f,"class","options-left touch-auto pointer-events-auto border border-gray-200 rounded-md flex flex-col max-h-full  svelte-1kb6xih"),m(se,"class","contents"),m(F,"class","font-bold"),m(J,"class","flex flex-1 items-center justify-between"),m(Z,"class","py-4 px-4 flex-shrink-0 shadow-sm flex gap-2 items-center justify-between bg-white z-10"),m(ae,"class","bg-gray-50 max-h-full flex-1 overflow-y-scroll p-4 py-8 flex flex-col gap-8"),Ae(ae,"hidden",!t[6]),Se(C,"overflow","hidden"),m(C,"class","options-right touch-auto pointer-events-auto border border-gray-200 rounded-md flex flex-col max-h-full  svelte-1kb6xih"),m(s,"class","gui-container touch-none pointer-events-none svelte-1kb6xih")},m(D,$){U(D,e,$),w(e,n),H(i,n,null),U(D,o,$),U(D,s,$),w(s,r),w(r,a),H(l,a,null),w(s,u),w(s,f),w(f,c),w(c,d),H(h,d,null),w(c,p),w(c,g),w(g,E),w(E,_),w(g,v),H(y,g,null),w(f,M),w(f,X),H(q,X,null),w(s,O),w(s,C),w(C,Z),w(Z,se),H(z,se,null),w(Z,de),w(Z,J),w(J,F),w(F,G),w(J,be),H(ie,J,null),w(C,ve),w(C,ae),H(he,ae,null),me=!0,Ce||(ze=[ne(a,"click",t[12]),ne(d,"click",t[13]),ne(se,"click",t[17])],Ce=!0)},p(D,[$]){const De={};$&4194335&&(De.$$scope={dirty:$,ctx:D}),i.$set(De);const A={};$&32&&(A.src=D[5]?Ke:xe),h.$set(A);const j={};$&1&&(j.disabled=!D[0]),$&4194304&&(j.$$scope={dirty:$,ctx:D}),y.$set(j);const we={};!B&&$&16&&(B=!0,we.config=D[4],te(()=>B=!1)),!T&&$&1&&(T=!0,we.image_data=D[0],te(()=>T=!1)),q.$set(we),(!me||$&32)&&Ae(X,"hidden",!D[5]);const oe={};$&64&&(oe.src=D[6]?Ke:xe),z.$set(oe);const ge={};$&1&&(ge.disabled=!D[0]),$&4194304&&(ge.$$scope={dirty:$,ctx:D}),ie.$set(ge);const _e={};!ye&&$&8&&(ye=!0,_e.config=D[3],te(()=>ye=!1)),!Me&&$&1&&(Me=!0,_e.image_data=D[0],te(()=>Me=!1)),he.$set(_e),(!me||$&64)&&Ae(ae,"hidden",!D[6])},i(D){me||(R(i.$$.fragment,D),R(l.$$.fragment,D),R(h.$$.fragment,D),R(y.$$.fragment,D),R(q.$$.fragment,D),R(z.$$.fragment,D),R(ie.$$.fragment,D),R(he.$$.fragment,D),me=!0)},o(D){L(i.$$.fragment,D),L(l.$$.fragment,D),L(h.$$.fragment,D),L(y.$$.fragment,D),L(q.$$.fragment,D),L(z.$$.fragment,D),L(ie.$$.fragment,D),L(he.$$.fragment,D),me=!1},d(D){D&&b(e),Y(i),D&&b(o),D&&b(s),Y(l),Y(h),Y(y),Y(q),Y(z),Y(ie),Y(he),Ce=!1,Le(ze)}}}let hn=300;function Br(t){return t?t.width/t.height:1}function Fr(t,e,n){let i,o;const s=_n();let r=null,a=null,{image_data:l}=e;async function u(O){O&&await jn(O,"dithered","png")}let f={mode:"ordered",width:hn,height:i,thresholdMap:null,noiseIntensity:.08,palette:null,diffusionStrength:1,diffusionMatrix:[[1]],diffusionMatrixOriginX:0},c={mode:"none",width:l.width,height:l.height,thresholdMap:null,noiseIntensity:.08,palette:null,diffusionStrength:1,diffusionMatrix:[[1]],diffusionMatrixOriginX:0},d=!1,h=!0;function p(O){a=O,n(2,a)}function g(O){r=O,n(1,r)}const E=()=>s("cancel"),_=()=>n(5,d=!d),v=()=>{r&&u(r)};function y(O){c=O,n(4,c)}function M(O){l=O,n(0,l)}const X=()=>n(6,h=!h),q=()=>{a&&u(a)};function B(O){f=O,n(3,f)}function T(O){l=O,n(0,l)}return t.$$set=O=>{"image_data"in O&&n(0,l=O.image_data)},t.$$.update=()=>{t.$$.dirty&1&&n(9,o=Br(l)),t.$$.dirty&512&&(i=Math.round(hn/o))},[l,r,a,f,c,d,h,s,u,o,p,g,E,_,v,y,M,X,q,B,T]}class Xr extends le{constructor(e){super(),ue(this,e,Fr,Ur,fe,{image_data:0})}}function mn(t){const n=new OffscreenCanvas(t.width,t.height).getContext("2d");if(!n)throw new Error("Could not get canvas context");return n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height)}function zr(t){let e,n;return e=new Kn({}),e.$on("image",t[3]),{c(){V(e.$$.fragment)},l(i){W(e.$$.fragment,i)},m(i,o){H(e,i,o),n=!0},p:re,i(i){n||(R(e.$$.fragment,i),n=!0)},o(i){L(e.$$.fragment,i),n=!1},d(i){Y(e,i)}}}function Vr(t){let e,n;return e=new Xr({props:{image_data:t[0]}}),e.$on("cancel",t[2]),{c(){V(e.$$.fragment)},l(i){W(e.$$.fragment,i)},m(i,o){H(e,i,o),n=!0},p(i,o){const s={};o&1&&(s.image_data=i[0]),e.$set(s)},i(i){n||(R(e.$$.fragment,i),n=!0)},o(i){L(e.$$.fragment,i),n=!1},d(i){Y(e,i)}}}function Wr(t){let e,n,i,o,s,r,a,l,u;e=new Vn({props:{icon:En,og_image:Hr}});const f=[Vr,zr],c=[];function d(h,p){return h[0]?0:1}return s=d(t),r=c[s]=f[s](t),{c(){V(e.$$.fragment),n=P(),i=P(),o=k("main"),r.c(),this.h()},l(h){W(e.$$.fragment,h),n=N(h),i=N(h),o=I(h,"MAIN",{class:!0});var p=S(o);r.l(p),p.forEach(b),this.h()},h(){m(o,"class","w-screen max-w-screen h-screen max-h-screen relative bg-gray-300")},m(h,p){H(e,h,p),U(h,n,p),U(h,i,p),U(h,o,p),c[s].m(o,null),a=!0,l||(u=[ne(document.body,"drop",It(t[1])),ne(document.body,"dragover",It(Yr))],l=!0)},p(h,[p]){let g=s;s=d(h),s===g?c[s].p(h,p):(Fe(),L(c[g],1,1,()=>{c[g]=null}),Xe(),r=c[s],r?r.p(h,p):(r=c[s]=f[s](h),r.c()),R(r,1),r.m(o,null))},i(h){a||(R(e.$$.fragment,h),R(r),a=!0)},o(h){L(e.$$.fragment,h),L(r),a=!1},d(h){Y(e,h),h&&b(n),h&&b(i),h&&b(o),c[s].d(),l=!1,Le(u)}}}const Hr="/og/dither-studio.webp",Yr=()=>{};function jr(t,e,n){let i=null;async function o(a){var u;const l=(u=a.dataTransfer)==null?void 0:u.files[0];if(l){if(!l.type.startsWith("image/")){alert("Please drop an image file");return}try{const f=await wn(l);n(0,i=mn(f))}catch(f){alert("Failed to load image"),console.error(f)}}}return[i,o,()=>n(0,i=null),a=>n(0,i=mn(a.detail))]}class Kr extends le{constructor(e){super(),ue(this,e,jr,Wr,fe,{})}}export{Kr as component,Jr as universal};

import{S as He,i as Ke,s as qe,a as I,k as h,J as Qe,h as a,c as S,l as _,m as g,n as i,b as A,G as m,U as C,H as Ne,o as Je,V as Ze,q as G,r as k,T as Fe,W as je,X as M,Y as Pe,Z as $e,u as Ce,_ as ce,$ as et,a0 as We,a1 as tt}from"../chunks/index.58e89b9b.js";/* empty css                          */const rt=""+new URL("../assets/img.58b560b7.jpg",import.meta.url).href,ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAARtJREFUGBkBEAHv/gQAgKB/aX+hf1t/oX9pf6F/BL+Bv4G/gb+Bv4G/gb+Bv4EEcX8xf3F/MX9xfzF/cX8xfwS/gb+Bv4G/gb+Bv4G/gb+BBB1/XX8Nf01/HX9dfw1/TX8Ev4G/gb+Bv4G/gb+Bv4G/gQRxfzF/cX8xf3F/MX9xfzF/BL+Bv4G/gb+Bv4G/gb+Bv4EECH9Ifxh/WH8Ef0R/FH9UfwS/gb+Bv4G/gb+Bv4G/gb+BBHF/MX9xfzF/cX8xf3F/MX8Ev4G/gb+Bv4G/gb+Bv4G/gQQdf11/DX9Nfx1/XX8Nf01/BL+Bv4G/gb+Bv4G/gb+Bv4EEcX8xf3F/MX9xfzF/cX8xfwS/gb+Bv4G/gb+Bv4G/gb+BIZOCkuKxtP8AAAAASUVORK5CYII=",Xe={width:16,height:16},it=""+new URL("../assets/blue_noise.b61cfddd.png",import.meta.url).href,Ge={width:470,height:470},nt=`precision highp float;

attribute vec2 position;
varying vec2 fragCoord;

// Just a simple vertex shader that passes on the 2d position to the fragment shader
void main() {
    fragCoord.x = position.x * 0.5 + 0.5;
    fragCoord.y = position.y * 0.5 + 0.5;
    
    gl_Position = vec4(position, 0.0, 1.0);
}`,st=`precision highp float;
varying vec2 fragCoord;

uniform sampler2D uSampler;
uniform float uThreshold;
uniform sampler2D uNoiseSampler;
uniform vec2 uNoiseSamplerSize;

uniform float uNoise;
uniform float uMonochrome;

uniform vec2 uSize;

uniform vec3 uDarkColor;
uniform vec3 uLightColor;

void main(void) {
    //Map the current image pixel to the noise texture
    vec2 imgPixel = vec2(fragCoord.x * uSize.x, fragCoord.y * uSize.y);
    vec2 noisePixel = vec2( mod(imgPixel.x, uNoiseSamplerSize.x),  mod(imgPixel.y, uNoiseSamplerSize.y));
    
    vec2 noiseUV = vec2(noisePixel.x / uNoiseSamplerSize.x, noisePixel.y / uNoiseSamplerSize.y);
    float noise = (texture2D(uNoiseSampler, noiseUV).r - 0.5) * 2.0 * uNoise;

    //Get the color of the current pixel from the image
    vec4 color = texture2D(uSampler, fragCoord);

   // Convert to grayscale using the NTSC standard coefficients
    float gray = dot(color.rgb, vec3(0.299, 0.587, 0.114));    

    color.r = color.r * (1.0 - uMonochrome) + gray * uMonochrome;
    color.g = color.g * (1.0 - uMonochrome) + gray * uMonochrome;
    color.b = color.b * (1.0 - uMonochrome) + gray * uMonochrome;

    vec3 thresholds = vec3(
        step(uThreshold, color.r + noise),
        step(uThreshold, color.g + noise),
        step(uThreshold, color.b + noise)
    );

    if(uMonochrome > 0.0) {
        color.rgb = vec3(
            mix(uDarkColor.r, uLightColor.r, thresholds.r),
            mix(uDarkColor.g, uLightColor.g, thresholds.g),
            mix(uDarkColor.b, uLightColor.b, thresholds.b)
        );
    } else {
        color.rgb = thresholds;
    }

    gl_FragColor = color;
}`;function at(e,n,o){const t=ke(e,e.VERTEX_SHADER,n),c=ke(e,e.FRAGMENT_SHADER,o),s=e.createProgram();if(!s)throw new Error("Failed to create shader program");if(e.attachShader(s,t),e.attachShader(s,c),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS))throw Error(`Unable to initialize the shader program: ${e.getProgramInfoLog(s)}`);return s}function ke(e,n,o){const t=e.createShader(n);if(!t)throw new Error("Failed to create shader");if(e.shaderSource(t,o),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))throw Error(`An error occurred compiling the shaders: ${e.getShaderInfoLog(t)}`);return t}function Me(e,n,o=()=>{}){const t=e.createTexture();if(!t)throw new Error("Failed to create texture");e.bindTexture(e.TEXTURE_2D,t);const c=0,s=e.RGBA,f=1,l=1,p=0,E=e.RGBA,d=e.UNSIGNED_BYTE,w=new Uint8Array([0,0,255,255]);e.texImage2D(e.TEXTURE_2D,c,s,f,l,p,E,d,w);const T=new Image;return T.onload=()=>{e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,c,s,E,d,T),fe(T.width)&&fe(T.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),o()},T.src=n,t}function lt(e){const n=e.createTexture();if(!n)throw new Error("Failed to create texture");e.bindTexture(e.TEXTURE_2D,n);const o=0,t=e.RGBA,c=1,s=1,f=0,l=e.RGBA,p=e.UNSIGNED_BYTE,E=new Uint8Array([0,0,255,255]);return e.texImage2D(e.TEXTURE_2D,o,t,c,s,f,l,p,E),n}function ut(e,n,o){const c=e.RGBA,s=e.RGBA,f=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,c,s,f,o),fe(o.width)&&fe(o.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR))}function fe(e){return(e&e-1)===0}function ct(e){const n=e.createBuffer(),o=e.createBuffer(),t=[-1,1,-1,-1,1,-1,1,1],c=[3,2,1,3,1,0];return e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(c),e.STATIC_DRAW),{vertex_buffer:n,index_buffer:o}}function ft(e,n){let o=n;const t=e.getContext("webgl",{preserveDrawingBuffer:!0});if(!t){alert("WebGL not supported");return}const c=()=>{ut(t,R,o.image)};t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT);const s=at(t,nt,st),{vertex_buffer:f,index_buffer:l}=ct(t),p=t.getAttribLocation(s,"position");t.vertexAttribPointer(p,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(p);const E=t.getUniformLocation(s,"uSampler"),d=t.getUniformLocation(s,"uThreshold"),w=t.getUniformLocation(s,"uNoiseSampler"),T=t.getUniformLocation(s,"uNoise"),x=t.getUniformLocation(s,"uSize"),O=t.getUniformLocation(s,"uNoiseSamplerSize"),z=t.getUniformLocation(s,"uMonochrome"),q=t.getUniformLocation(s,"uDarkColor"),X=t.getUniformLocation(s,"uLightColor"),R=lt(t);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),c();const V=Me(t,ot,U);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0);const L=Me(t,it,U);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.useProgram(s);let y=null;const v=()=>{switch(t.viewport(0,0,o.width,o.height),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.bindBuffer(t.ARRAY_BUFFER,f),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,l),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,R),t.uniform1i(E,0),o.mode){case"bayer":t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,V),t.uniform1i(w,1),t.uniform2f(O,Xe.width,Xe.height);break;case"blue_noise":t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,L),t.uniform1i(w,1),t.uniform2f(O,Ge.width,Ge.height);break}t.uniform1f(d,o.threshold),t.uniform1f(T,o.noiseIntensity),t.uniform2f(x,o.width,o.height),t.uniform1f(z,o.monochrome?1:0),t.uniform3f(q,...Oe(o.colorDark)),t.uniform3f(X,...Oe(o.colorLight)),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)};function U(){y=requestAnimationFrame(()=>{v(),y=null})}return U(),{update(b){const D=o.image!==b.image;o=b,D&&c(),U()},destroy(){y!==null&&cancelAnimationFrame(y)}}}function Oe(e){const n=parseInt(e.slice(1,3),16)/255,o=parseInt(e.slice(3,5),16)/255,t=parseInt(e.slice(5,7),16)/255;return[n,o,t]}const{document:ze}=Ze;function Ve(e){let n,o,t,c,s,f,l,p,E,d,w,T,x,O,z,q,X,R,V,L,y,v,U,b,D,Q,me,J,de,te,j,Y,Z,he,_e,$,N,re,F,W,pe,H,Ee,oe,P,ie,ne,K,Te,ve,be,B=e[3]&&Ye(e);return{c(){n=h("img"),t=I(),c=h("div"),s=h("label"),f=G("Threshold "),l=G(e[1]),p=I(),E=h("div"),d=h("input"),w=I(),T=h("div"),x=h("label"),O=G("Noise Intensity "),z=G(e[2]),q=I(),X=h("div"),R=h("input"),V=I(),L=h("div"),y=h("div"),v=h("input"),U=I(),b=h("div"),D=h("label"),Q=G("Monochrome"),me=I(),J=h("p"),de=G("If the dither should be monochrome, or in color"),te=I(),B&&B.c(),j=I(),Y=h("div"),Z=h("label"),he=G("Width"),_e=I(),$=h("div"),N=h("input"),re=I(),F=h("select"),W=h("option"),pe=G("Bayer"),H=h("option"),Ee=G("Blue Noise"),oe=I(),P=h("canvas"),ne=I(),K=h("button"),Te=G("Save"),this.h()},l(r){n=_(r,"IMG",{src:!0,alt:!0,class:!0}),t=S(r),c=_(r,"DIV",{});var u=g(c);s=_(u,"LABEL",{for:!0,class:!0});var ee=g(s);f=k(ee,"Threshold "),l=k(ee,e[1]),ee.forEach(a),p=S(u),E=_(u,"DIV",{class:!0});var Re=g(E);d=_(Re,"INPUT",{type:!0,min:!0,id:!0,max:!0,step:!0,class:!0}),Re.forEach(a),u.forEach(a),w=S(r),T=_(r,"DIV",{});var se=g(T);x=_(se,"LABEL",{for:!0,class:!0});var Ae=g(x);O=k(Ae,"Noise Intensity "),z=k(Ae,e[2]),Ae.forEach(a),q=S(se),X=_(se,"DIV",{class:!0});var Ue=g(X);R=_(Ue,"INPUT",{type:!0,min:!0,id:!0,max:!0,step:!0,class:!0}),Ue.forEach(a),se.forEach(a),V=S(r),L=_(r,"DIV",{class:!0});var ae=g(L);y=_(ae,"DIV",{class:!0});var Be=g(y);v=_(Be,"INPUT",{type:!0,class:!0}),Be.forEach(a),U=S(ae),b=_(ae,"DIV",{class:!0});var le=g(b);D=_(le,"LABEL",{for:!0,class:!0});var Ie=g(D);Q=k(Ie,"Monochrome"),Ie.forEach(a),me=S(le),J=_(le,"P",{id:!0,class:!0});var Se=g(J);de=k(Se,"If the dither should be monochrome, or in color"),Se.forEach(a),le.forEach(a),ae.forEach(a),te=S(r),B&&B.l(r),j=S(r),Y=_(r,"DIV",{});var ue=g(Y);Z=_(ue,"LABEL",{for:!0,class:!0});var De=g(Z);he=k(De,"Width"),De.forEach(a),_e=S(ue),$=_(ue,"DIV",{class:!0});var we=g($);N=_(we,"INPUT",{type:!0,min:!0,id:!0,step:!0,class:!0}),we.forEach(a),ue.forEach(a),re=S(r),F=_(r,"SELECT",{});var ge=g(F);W=_(ge,"OPTION",{});var Le=g(W);pe=k(Le,"Bayer"),Le.forEach(a),H=_(ge,"OPTION",{});var ye=g(H);Ee=k(ye,"Blue Noise"),ye.forEach(a),ge.forEach(a),oe=S(r),P=_(r,"CANVAS",{class:!0,width:!0,height:!0}),g(P).forEach(a),ne=S(r),K=_(r,"BUTTON",{class:!0});var xe=g(K);Te=k(xe,"Save"),xe.forEach(a),this.h()},h(){var r;Fe(n.src,o=(r=e[7])==null?void 0:r.src)||i(n,"src",o),i(n,"alt",""),i(n,"class","w-full pixelated svelte-1gkt69q"),i(s,"for","threshold"),i(s,"class","block text-sm font-medium leading-6 text-gray-900"),i(d,"type","range"),i(d,"min","0"),i(d,"id","threshold"),i(d,"max","1"),i(d,"step","0.01"),i(d,"class","block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),i(E,"class","mt-2"),i(x,"for","noise"),i(x,"class","block text-sm font-medium leading-6 text-gray-900"),i(R,"type","range"),i(R,"min","0"),i(R,"id","noise"),i(R,"max","1.5"),i(R,"step","0.01"),i(R,"class","block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),i(X,"class","mt-2"),i(v,"type","checkbox"),i(v,"class","h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600"),i(y,"class","flex h-6 items-center"),i(D,"for","comments"),i(D,"class","font-medium text-gray-900"),i(J,"id","comments-description"),i(J,"class","text-gray-500"),i(b,"class","ml-3 text-sm leading-6"),i(L,"class","relative flex items-start"),i(Z,"for","width"),i(Z,"class","block text-sm font-medium leading-6 text-gray-900"),i(N,"type","number"),i(N,"min","10"),i(N,"id","width"),i(N,"step","1"),i(N,"class","block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),i($,"class","mt-2"),W.__value="bayer",W.value=W.__value,H.__value="blue_noise",H.value=H.__value,e[6]===void 0&&je(()=>e[18].call(F)),i(P,"class","w-full pixelated svelte-1gkt69q"),i(P,"width",e[0]),i(P,"height",e[8]),i(K,"class","")},m(r,u){A(r,n,u),A(r,t,u),A(r,c,u),m(c,s),m(s,f),m(s,l),m(c,p),m(c,E),m(E,d),M(d,e[1]),A(r,w,u),A(r,T,u),m(T,x),m(x,O),m(x,z),m(T,q),m(T,X),m(X,R),M(R,e[2]),A(r,V,u),A(r,L,u),m(L,y),m(y,v),v.checked=e[3],m(L,U),m(L,b),m(b,D),m(D,Q),m(b,me),m(b,J),m(J,de),A(r,te,u),B&&B.m(r,u),A(r,j,u),A(r,Y,u),m(Y,Z),m(Z,he),m(Y,_e),m(Y,$),m($,N),M(N,e[0]),A(r,re,u),A(r,F,u),m(F,W),m(W,pe),m(F,H),m(H,Ee),Pe(F,e[6],!0),A(r,oe,u),A(r,P,u),A(r,ne,u),A(r,K,u),m(K,Te),ve||(be=[C(d,"change",e[12]),C(d,"input",e[12]),C(R,"change",e[13]),C(R,"input",e[13]),C(v,"change",e[14]),C(N,"input",e[17]),C(F,"change",e[18]),$e(ie=ft.call(null,P,{image:e[7],threshold:e[1],noiseIntensity:e[2],monochrome:e[3],colorLight:e[4],colorDark:e[5],mode:e[6],width:e[0],height:e[8]})),C(K,"click",e[10])],ve=!0)},p(r,u){var ee;u&128&&!Fe(n.src,o=(ee=r[7])==null?void 0:ee.src)&&i(n,"src",o),u&2&&Ce(l,r[1]),u&2&&M(d,r[1]),u&4&&Ce(z,r[2]),u&4&&M(R,r[2]),u&8&&(v.checked=r[3]),r[3]?B?B.p(r,u):(B=Ye(r),B.c(),B.m(j.parentNode,j)):B&&(B.d(1),B=null),u&1&&ce(N.value)!==r[0]&&M(N,r[0]),u&64&&Pe(F,r[6]),u&1&&i(P,"width",r[0]),u&256&&i(P,"height",r[8]),ie&&et(ie.update)&&u&511&&ie.update.call(null,{image:r[7],threshold:r[1],noiseIntensity:r[2],monochrome:r[3],colorLight:r[4],colorDark:r[5],mode:r[6],width:r[0],height:r[8]})},d(r){r&&a(n),r&&a(t),r&&a(c),r&&a(w),r&&a(T),r&&a(V),r&&a(L),r&&a(te),B&&B.d(r),r&&a(j),r&&a(Y),r&&a(re),r&&a(F),r&&a(oe),r&&a(P),r&&a(ne),r&&a(K),ve=!1,We(be)}}}function Ye(e){let n,o,t,c,s;return{c(){n=h("input"),o=I(),t=h("input"),this.h()},l(f){n=_(f,"INPUT",{type:!0}),o=S(f),t=_(f,"INPUT",{type:!0}),this.h()},h(){i(n,"type","color"),i(t,"type","color")},m(f,l){A(f,n,l),M(n,e[4]),A(f,o,l),A(f,t,l),M(t,e[5]),c||(s=[C(n,"input",e[15]),C(t,"input",e[16])],c=!0)},p(f,l){l&16&&M(n,f[4]),l&32&&M(t,f[5])},d(f){f&&a(n),f&&a(o),f&&a(t),c=!1,We(s)}}}function mt(e){let n,o,t,c,s,f,l=e[7]&&Ve(e);return{c(){n=I(),o=h("div"),t=h("input"),c=I(),l&&l.c(),this.h()},l(p){Qe("svelte-1hm2pfs",ze.head).forEach(a),n=S(p),o=_(p,"DIV",{class:!0});var d=g(o);t=_(d,"INPUT",{type:!0,id:!0,accept:!0}),c=S(d),l&&l.l(d),d.forEach(a),this.h()},h(){ze.title="Dithering",i(t,"type","file"),i(t,"id","image-input"),i(t,"accept","image/*"),i(o,"class","max-w-xl mx-auto px-4")},m(p,E){A(p,n,E),A(p,o,E),m(o,t),m(o,c),l&&l.m(o,null),s||(f=C(t,"input",e[9]),s=!0)},p(p,[E]){p[7]?l?l.p(p,E):(l=Ve(p),l.c(),l.m(o,null)):l&&(l.d(1),l=null)},i:Ne,o:Ne,d(p){p&&a(n),p&&a(o),l&&l.d(),s=!1,f()}}}function dt(e,n,o){let t,c=.33,s=.3,f=!1,l="#ede6cc",p="#21263f",E=600,d=1,w="blue_noise",T=null;function x(v){const U=v.target.files[0];if(!U)return;const b=new FileReader;b.onload=D=>{if(typeof b.result!="string")return;const Q=new Image;Q.onload=()=>{o(7,T=Q),o(11,d=T.width/T.height)},Q.src=b.result},b.readAsDataURL(U)}Je(()=>{const v=new Image;v.onload=()=>{o(7,T=v),o(11,d=T.width/T.height)},v.src=rt});function O(){const v=document.querySelector("canvas");if(!v)return;const U=document.createElement("canvas");U.width=v.width,U.height=v.height;const b=U.getContext("2d");if(!b)return;b.drawImage(v,0,0,E,t);const D=document.createElement("a");D.download="dithered.png",D.href=U.toDataURL("image/png"),D.click()}function z(){c=ce(this.value),o(1,c)}function q(){s=ce(this.value),o(2,s)}function X(){f=this.checked,o(3,f)}function R(){l=this.value,o(4,l)}function V(){p=this.value,o(5,p)}function L(){E=ce(this.value),o(0,E)}function y(){w=tt(this),o(6,w)}return e.$$.update=()=>{e.$$.dirty&2049&&o(8,t=E/d)},[E,c,s,f,l,p,w,T,t,x,O,d,z,q,X,R,V,L,y]}class pt extends He{constructor(n){super(),Ke(this,n,dt,mt,qe,{})}}export{pt as component};

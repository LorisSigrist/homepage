var Zt=Object.defineProperty;var qt=(e,t,n)=>t in e?Zt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Re=(e,t,n)=>(qt(e,typeof t!="symbol"?t+"":t,n),n);import{S as Te,i as Ie,s as Le,k as g,q as j,a as C,y as ee,l as v,m as A,r as Z,h as m,c as U,z as te,n as c,b as W,G as h,A as ne,N as q,g as P,d as F,B as re,Q as Be,R as Qt,T as wt,u as ut,H as ye,U as xt,V as Kt,O as ke,P as Jt,C as tt,D as nt,E as rt,F as it,W as en,p as st,X as Ve,Y as ot,w as me,Z as Ot,_ as Ae,J as tn,f as $e,$ as we,v as xe,M as at}from"../chunks/index.47904ce3.js";/* empty css                          */import{I as Pe,L as nn,A as rn,a as sn,P as on,X as an}from"../chunks/Icon.6cd62dd7.js";function ln(e){let t,n,r,s,i,o,a,l,u,d,f,_,L,D,T,w,I,R,b,p,y,N,S,B,$,x;return L=new Pe({props:{src:nn,class:"w-4 h-4",solid:!0}}),{c(){t=g("fieldset"),n=g("div"),r=g("label"),s=j("Width"),i=C(),o=g("div"),a=g("input"),l=C(),u=g("div"),d=j("px"),f=C(),_=g("span"),ee(L.$$.fragment),D=C(),T=g("div"),w=g("label"),I=j("Height"),R=C(),b=g("div"),p=g("input"),y=C(),N=g("div"),S=j("px"),this.h()},l(M){t=v(M,"FIELDSET",{class:!0});var O=A(t);n=v(O,"DIV",{class:!0});var Q=A(n);r=v(Q,"LABEL",{for:!0,class:!0});var ie=A(r);s=Z(ie,"Width"),ie.forEach(m),i=U(Q),o=v(Q,"DIV",{class:!0});var se=A(o);a=v(se,"INPUT",{name:!0,id:!0,type:!0,min:!0,max:!0,step:!0,class:!0,placeholder:!0}),l=U(se),u=v(se,"DIV",{class:!0});var K=A(u);d=Z(K,"px"),K.forEach(m),se.forEach(m),Q.forEach(m),f=U(O),_=v(O,"SPAN",{class:!0});var pe=A(_);te(L.$$.fragment,pe),pe.forEach(m),D=U(O),T=v(O,"DIV",{class:!0});var oe=A(T);w=v(oe,"LABEL",{for:!0,class:!0});var le=A(w);I=Z(le,"Height"),le.forEach(m),R=U(oe),b=v(oe,"DIV",{class:!0});var ue=A(b);p=v(ue,"INPUT",{type:!0,id:!0,name:!0,min:!0,max:!0,step:!0,class:!0,placeholder:!0}),y=U(ue),N=v(ue,"DIV",{class:!0});var k=A(N);S=Z(k,"px"),k.forEach(m),ue.forEach(m),oe.forEach(m),O.forEach(m),this.h()},h(){c(r,"for","width-"+e[4]),c(r,"class","block text-sm font-medium leading-6 text-gray-900"),c(a,"name","width"),c(a,"id","width-"+e[4]),c(a,"type","number"),c(a,"min","12"),c(a,"max","3000"),c(a,"step","1"),a.value=e[0],c(a,"class","block w-full rounded-md border-0 py-1.5 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),c(a,"placeholder","600"),c(u,"class","pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400"),c(o,"class","relative mt-2 rounded-md shadow-sm"),c(n,"class","w-full"),c(_,"class","text-gray-500 pb-2 cursor-not-allowed"),c(w,"for","height-"+e[5]),c(w,"class","block text-sm font-medium leading-6 text-gray-900"),c(p,"type","number"),c(p,"id","height-"+e[5]),c(p,"name","height"),c(p,"min","12"),c(p,"max","3000"),c(p,"step","1"),p.value=e[1],c(p,"class","block w-full rounded-md border-0 py-1.5 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),c(p,"placeholder","340"),c(N,"class","pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400"),c(b,"class","relative mt-2 rounded-md shadow-sm"),c(T,"class","w-full"),c(t,"class","flex gap-3 items-end justify-between")},m(M,O){W(M,t,O),h(t,n),h(n,r),h(r,s),h(n,i),h(n,o),h(o,a),h(o,l),h(o,u),h(u,d),h(t,f),h(t,_),ne(L,_,null),h(t,D),h(t,T),h(T,w),h(w,I),h(T,R),h(T,b),h(b,p),h(b,y),h(b,N),h(N,S),B=!0,$||(x=[q(a,"input",e[2]),q(p,"input",e[3])],$=!0)},p(M,[O]){(!B||O&1&&a.value!==M[0])&&(a.value=M[0]),(!B||O&2&&p.value!==M[1])&&(p.value=M[1])},i(M){B||(P(L.$$.fragment,M),B=!0)},o(M){F(L.$$.fragment,M),B=!1},d(M){M&&m(t),re(L),$=!1,Be(x)}}}function yt(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function un(e,t,n){let r,{width:s}=t,{aspectRatio:i}=t;function o(d){const f=d.target.value;f&&n(0,s=f)}function a(d){const f=d.target.value;f&&n(0,s=Math.round(i*f))}let l=yt(),u=yt();return e.$$set=d=>{"width"in d&&n(0,s=d.width),"aspectRatio"in d&&n(6,i=d.aspectRatio)},e.$$.update=()=>{e.$$.dirty&65&&n(1,r=Math.round(s/i))},[s,r,o,a,l,u,i]}class Vt extends Te{constructor(t){super(),Ie(this,t,un,ln,Le,{width:0,aspectRatio:6})}}function Tt(e,t,n){const r=e.slice();return r[6]=t[n],r}function It(e){let t,n=e[6].name+"",r,s,i;return{c(){t=g("option"),r=j(n),this.h()},l(o){t=v(o,"OPTION",{});var a=A(t);r=Z(a,n),a.forEach(m),this.h()},h(){t.__value=s=e[6].value,t.value=t.__value,t.selected=i=e[6].value===e[0]},m(o,a){W(o,t,a),h(t,r)},p(o,a){a&2&&n!==(n=o[6].name+"")&&ut(r,n),a&2&&s!==(s=o[6].value)&&(t.__value=s,t.value=t.__value),a&3&&i!==(i=o[6].value===o[0])&&(t.selected=i)},d(o){o&&m(t)}}}function cn(e){let t,n,r,s,i,o,a,l=e[1],u=[];for(let d=0;d<l.length;d+=1)u[d]=It(Tt(e,l,d));return{c(){t=g("div"),n=g("label"),r=j(e[2]),s=C(),i=g("select");for(let d=0;d<u.length;d+=1)u[d].c();this.h()},l(d){t=v(d,"DIV",{});var f=A(t);n=v(f,"LABEL",{for:!0,class:!0});var _=A(n);r=Z(_,e[2]),_.forEach(m),s=U(f),i=v(f,"SELECT",{id:!0,name:!0,class:!0});var L=A(i);for(let D=0;D<u.length;D+=1)u[D].l(L);L.forEach(m),f.forEach(m),this.h()},h(){c(n,"for",e[4]),c(n,"class","block text-sm font-medium leading-6 text-gray-900"),c(i,"id",e[4]),c(i,"name",e[3]),c(i,"class","mt-2 block w-full rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6"),e[0]===void 0&&Qt(()=>e[5].call(i))},m(d,f){W(d,t,f),h(t,n),h(n,r),h(t,s),h(t,i);for(let _=0;_<u.length;_+=1)u[_]&&u[_].m(i,null);wt(i,e[0],!0),o||(a=q(i,"change",e[5]),o=!0)},p(d,[f]){if(f&4&&ut(r,d[2]),f&3){l=d[1];let _;for(_=0;_<l.length;_+=1){const L=Tt(d,l,_);u[_]?u[_].p(L,f):(u[_]=It(L),u[_].c(),u[_].m(i,null))}for(;_<u.length;_+=1)u[_].d(1);u.length=l.length}f&8&&c(i,"name",d[3]),f&3&&wt(i,d[0])},i:ye,o:ye,d(d){d&&m(t),xt(u,d),o=!1,a()}}}function dn(e,t,n){let{options:r}=t,{selected:s}=t,{label:i}=t,{name:o=void 0}=t,a=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);function l(){s=Kt(this),n(0,s),n(1,r)}return e.$$set=u=>{"options"in u&&n(1,r=u.options),"selected"in u&&n(0,s=u.selected),"label"in u&&n(2,i=u.label),"name"in u&&n(3,o=u.name)},[s,r,i,o,a,l]}class hn extends Te{constructor(t){super(),Ie(this,t,dn,cn,Le,{options:1,selected:0,label:2,name:3})}}function fn(e){let t,n,r,s,i,o,a;return{c(){t=g("div"),n=g("label"),r=j(e[1]),s=C(),i=g("input"),this.h()},l(l){t=v(l,"DIV",{});var u=A(t);n=v(u,"LABEL",{for:!0,class:!0});var d=A(n);r=Z(d,e[1]),d.forEach(m),s=U(u),i=v(u,"INPUT",{id:!0,type:!0,min:!0,max:!0,step:!0,name:!0,class:!0}),u.forEach(m),this.h()},h(){c(n,"for",e[6]),c(n,"class","block mb-2 text-sm font-medium text-gray-900 dark:text-white"),c(i,"id",e[6]),c(i,"type","range"),c(i,"min",e[3]),c(i,"max",e[4]),c(i,"step",e[5]),c(i,"name",e[2]),c(i,"class","w-full h-1.5 mb-6 bg-white ring-1 ring-gray-300 shadow-sm rounded-lg appearance-none cursor-pointer accent-indigo-600 dark:bg-gray-700")},m(l,u){W(l,t,u),h(t,n),h(n,r),h(t,s),h(t,i),ke(i,e[0]),o||(a=[q(i,"change",e[7]),q(i,"input",e[7])],o=!0)},p(l,[u]){u&2&&ut(r,l[1]),u&8&&c(i,"min",l[3]),u&16&&c(i,"max",l[4]),u&32&&c(i,"step",l[5]),u&4&&c(i,"name",l[2]),u&1&&ke(i,l[0])},i:ye,o:ye,d(l){l&&m(t),o=!1,Be(a)}}}function mn(e,t,n){let{label:r}=t,{name:s=void 0}=t,{min:i=null}=t,{max:o=null}=t,{value:a=0}=t,{step:l=1}=t,u=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);function d(){a=Jt(this.value),n(0,a)}return e.$$set=f=>{"label"in f&&n(1,r=f.label),"name"in f&&n(2,s=f.name),"min"in f&&n(3,i=f.min),"max"in f&&n(4,o=f.max),"value"in f&&n(0,a=f.value),"step"in f&&n(5,l=f.step)},[a,r,s,i,o,l,u,d]}class lt extends Te{constructor(t){super(),Ie(this,t,mn,fn,Le,{label:1,name:2,min:3,max:4,value:0,step:5})}}var pn="precision highp float;attribute vec2 position;varying vec2 fragCoord;void main(){fragCoord.x=position.x*0.5+0.5;fragCoord.y=position.y*0.5+0.5;gl_Position=vec4(position,0.0,1.0);}",_n="precision highp float;varying vec2 fragCoord;uniform sampler2D uSampler;uniform float uThreshold;uniform sampler2D uNoiseSampler;uniform vec2 uNoiseSamplerSize;uniform float uNoise;uniform float uMonochrome;uniform vec2 uSize;uniform vec3 uDarkColor;uniform vec3 uLightColor;void main(void){vec2 imgPixel=vec2(fragCoord.x*uSize.x,fragCoord.y*uSize.y);vec2 noisePixel=vec2(mod(imgPixel.x,uNoiseSamplerSize.x),mod(imgPixel.y,uNoiseSamplerSize.y));vec2 noiseUV=vec2(noisePixel.x/uNoiseSamplerSize.x,noisePixel.y/uNoiseSamplerSize.y);float noise=(texture2D(uNoiseSampler,noiseUV).r-0.5)*2.0*uNoise;vec4 color=texture2D(uSampler,fragCoord);float gray=dot(color.rgb,vec3(0.299,0.587,0.114));color.r=color.r*(1.0-uMonochrome)+gray*uMonochrome;color.g=color.g*(1.0-uMonochrome)+gray*uMonochrome;color.b=color.b*(1.0-uMonochrome)+gray*uMonochrome;vec3 thresholds=vec3(step(uThreshold,color.r+noise),step(uThreshold,color.g+noise),step(uThreshold,color.b+noise));if(uMonochrome>0.0){color.rgb=vec3(mix(uDarkColor.r,uLightColor.r,thresholds.r),mix(uDarkColor.g,uLightColor.g,thresholds.g),mix(uDarkColor.b,uLightColor.b,thresholds.b));}else{color.rgb=thresholds;}gl_FragColor=color;}";function gn(e,t,n){const r=Lt(e,e.VERTEX_SHADER,t),s=Lt(e,e.FRAGMENT_SHADER,n),i=e.createProgram();if(!i)throw new Error("Failed to create shader program");if(e.attachShader(i,r),e.attachShader(i,s),e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS))throw Error(`Unable to initialize the shader program: ${e.getProgramInfoLog(i)}`);return i}function Lt(e,t,n){const r=e.createShader(t);if(!r)throw new Error("Failed to create shader");if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw Error(`An error occurred compiling the shaders: ${e.getShaderInfoLog(r)}`);return r}function vn(e){const t=e.createTexture();if(!t)throw new Error("Failed to create texture");e.bindTexture(e.TEXTURE_2D,t);const n=0,r=e.RGBA,s=1,i=1,o=0,a=e.RGBA,l=e.UNSIGNED_BYTE,u=new Uint8Array([0,0,255,255]);return e.texImage2D(e.TEXTURE_2D,n,r,s,i,o,a,l,u),t}function En(e,t,n){const s=e.RGBA,i=e.RGBA,o=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,s,i,o,n),ze(n.width)&&ze(n.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR))}function ze(e){return(e&e-1)===0}function bn(e){const t=e.createBuffer(),n=e.createBuffer(),r=[-1,1,-1,-1,1,-1,1,1],s=[3,2,1,3,1,0];return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(s),e.STATIC_DRAW),{vertex_buffer:t,index_buffer:n}}function An(e,t){const n=e.createTexture();if(!n)throw new Error("Failed to create texture");return e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),ze(t.width)&&ze(t.height)?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),n}function wn(e,t){let n=t;const r=e.getContext("webgl",{preserveDrawingBuffer:!0});if(!r){alert("WebGL not supported");return}const s=()=>{En(r,R,n.image)};r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT);const i=gn(r,pn,_n),{vertex_buffer:o,index_buffer:a}=bn(r),l=r.getAttribLocation(i,"position");r.vertexAttribPointer(l,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(l);const u=r.getUniformLocation(i,"uSampler"),d=r.getUniformLocation(i,"uThreshold"),f=r.getUniformLocation(i,"uNoiseSampler"),_=r.getUniformLocation(i,"uNoise"),L=r.getUniformLocation(i,"uSize"),D=r.getUniformLocation(i,"uNoiseSamplerSize"),T=r.getUniformLocation(i,"uMonochrome"),w=r.getUniformLocation(i,"uDarkColor"),I=r.getUniformLocation(i,"uLightColor"),R=vn(r);r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),s();let b,p;r.useProgram(i);let y=null;const N=()=>{b&&r.deleteTexture(b),b=An(r,n.thresholdMap),p={width:n.thresholdMap.width,height:n.thresholdMap.height}};N();const S=()=>{r.viewport(0,0,n.output_width,n.output_height),r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT),r.bindBuffer(r.ARRAY_BUFFER,o),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,a),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,R),r.uniform1i(u,0),r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,b),r.uniform1i(f,1),r.uniform2f(D,p.width,p.height),r.uniform1f(d,n.threshold),r.uniform1f(_,n.noiseIntensity),r.uniform2f(L,n.output_width,n.output_height),r.uniform1f(T,n.monochrome?1:0),r.uniform3f(w,...Dt(n.colorDark)),r.uniform3f(I,...Dt(n.colorLight)),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0)};function B(){y=requestAnimationFrame(()=>{S(),y=null})}return B(),{update($){const x=n.image!==$.image,M=n.thresholdMap!==$.thresholdMap;n=$,x&&s(),M&&N(),B()},destroy(){y!==null&&cancelAnimationFrame(y)}}}function Dt(e){const t=parseInt(e.slice(1,3),16)/255,n=parseInt(e.slice(3,5),16)/255,r=parseInt(e.slice(5,7),16)/255;return[t,n,r]}function yn(e){let t,n,r,s,i;const o=e[3].default,a=tt(o,e,e[2],null);return{c(){t=g("button"),a&&a.c(),this.h()},l(l){t=v(l,"BUTTON",{type:!0,class:!0});var u=A(t);a&&a.l(u),u.forEach(m),this.h()},h(){t.disabled=e[0],c(t,"type","button"),c(t,"class",n=e[1][e[0]?"disabled":"normal"]+" rounded-md w-full px-2.5 py-1.5 text-sm font-semibold focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 flex items-center justify-center gap-2")},m(l,u){W(l,t,u),a&&a.m(t,null),r=!0,s||(i=q(t,"click",e[4]),s=!0)},p(l,[u]){a&&a.p&&(!r||u&4)&&nt(a,o,l,l[2],r?it(o,l[2],u,null):rt(l[2]),null),(!r||u&1)&&(t.disabled=l[0]),(!r||u&1&&n!==(n=l[1][l[0]?"disabled":"normal"]+" rounded-md w-full px-2.5 py-1.5 text-sm font-semibold focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 flex items-center justify-center gap-2"))&&c(t,"class",n)},i(l){r||(P(a,l),r=!0)},o(l){F(a,l),r=!1},d(l){l&&m(t),a&&a.d(l),s=!1,i()}}}function Tn(e,t,n){let{$$slots:r={},$$scope:s}=t,{disabled:i=!1}=t;const o={normal:"bg-indigo-600 text-white shadow-sm hover:bg-indigo-500",disabled:"bg-gray-200 text-gray-400 shadow-none cursor-not-allowed"};function a(l){en.call(this,e,l)}return e.$$set=l=>{"disabled"in l&&n(0,i=l.disabled),"$$scope"in l&&n(2,s=l.$$scope)},[i,o,s,r,a]}class In extends Te{constructor(t){super(),Ie(this,t,Tn,yn,Le,{disabled:0})}}async function Ln(e,t,n="png"){const r=new OffscreenCanvas(e.width,e.height),s=r.getContext("2d");if(!s)return;s.drawImage(e,0,0,e.width,e.height);const i=await r.convertToBlob({type:"image/"+n,quality:1}),o=URL.createObjectURL(i),a=document.createElement("a");a.download=`${t}.${n}`,a.href=o,a.click(),a.remove(),URL.revokeObjectURL(o)}function St(e){return new Promise((t,n)=>{e.type.startsWith("image/")||n(new Error("Not an image file"));const r=new FileReader;r.onload=s=>{if(typeof r.result!="string")return;const i=new Image;i.onload=()=>{t(i)},i.onerror=o=>{n(o)},i.src=r.result},r.onerror=s=>{n(s)},r.readAsDataURL(e)})}async function Dn(e){return new Promise((t,n)=>{const r=new Image;r.onload=()=>{t(r)},r.onerror=s=>{n(s)},r.src=e})}var Sn=class extends EventTarget{dispatchTypedEvent(e,t){return super.dispatchEvent(t)}};class be{constructor(t){this.id=-1,this.nativePointer=t,this.pageX=t.pageX,this.pageY=t.pageY,this.clientX=t.clientX,this.clientY=t.clientY,self.Touch&&t instanceof Touch?this.id=t.identifier:Ce(t)&&(this.id=t.pointerId)}getCoalesced(){if("getCoalescedEvents"in this.nativePointer){const t=this.nativePointer.getCoalescedEvents().map(n=>new be(n));if(t.length>0)return t}return[this]}}const Ce=e=>"pointerId"in e,Ke=e=>"changedTouches"in e,Rt=()=>{};class Rn{constructor(t,{start:n=()=>!0,move:r=Rt,end:s=Rt,rawUpdates:i=!1,avoidPointerEvents:o=!1}={}){this._element=t,this.startPointers=[],this.currentPointers=[],this._excludeFromButtonsCheck=new Set,this._pointerStart=a=>{if(Ce(a)&&a.buttons===0)this._excludeFromButtonsCheck.add(a.pointerId);else if(!(a.buttons&1))return;const l=new be(a);this.currentPointers.some(u=>u.id===l.id)||this._triggerPointerStart(l,a)&&(Ce(a)?((a.target&&"setPointerCapture"in a.target?a.target:this._element).setPointerCapture(a.pointerId),this._element.addEventListener(this._rawUpdates?"pointerrawupdate":"pointermove",this._move),this._element.addEventListener("pointerup",this._pointerEnd),this._element.addEventListener("pointercancel",this._pointerEnd)):(window.addEventListener("mousemove",this._move),window.addEventListener("mouseup",this._pointerEnd)))},this._touchStart=a=>{for(const l of Array.from(a.changedTouches))this._triggerPointerStart(new be(l),a)},this._move=a=>{if(!Ke(a)&&(!Ce(a)||!this._excludeFromButtonsCheck.has(a.pointerId))&&a.buttons===0){this._pointerEnd(a);return}const l=this.currentPointers.slice(),u=Ke(a)?Array.from(a.changedTouches).map(f=>new be(f)):[new be(a)],d=[];for(const f of u){const _=this.currentPointers.findIndex(L=>L.id===f.id);_!==-1&&(d.push(f),this.currentPointers[_]=f)}d.length!==0&&this._moveCallback(l,d,a)},this._triggerPointerEnd=(a,l)=>{if(!Ke(l)&&l.buttons&1)return!1;const u=this.currentPointers.findIndex(f=>f.id===a.id);if(u===-1)return!1;this.currentPointers.splice(u,1),this.startPointers.splice(u,1),this._excludeFromButtonsCheck.delete(a.id);const d=!(l.type==="mouseup"||l.type==="touchend"||l.type==="pointerup");return this._endCallback(a,l,d),!0},this._pointerEnd=a=>{if(this._triggerPointerEnd(new be(a),a))if(Ce(a)){if(this.currentPointers.length)return;this._element.removeEventListener(this._rawUpdates?"pointerrawupdate":"pointermove",this._move),this._element.removeEventListener("pointerup",this._pointerEnd),this._element.removeEventListener("pointercancel",this._pointerEnd)}else window.removeEventListener("mousemove",this._move),window.removeEventListener("mouseup",this._pointerEnd)},this._touchEnd=a=>{for(const l of Array.from(a.changedTouches))this._triggerPointerEnd(new be(l),a)},this._startCallback=n,this._moveCallback=r,this._endCallback=s,this._rawUpdates=i&&"onpointerrawupdate"in window,self.PointerEvent&&!o?this._element.addEventListener("pointerdown",this._pointerStart):(this._element.addEventListener("mousedown",this._pointerStart),this._element.addEventListener("touchstart",this._touchStart),this._element.addEventListener("touchmove",this._move),this._element.addEventListener("touchend",this._touchEnd),this._element.addEventListener("touchcancel",this._touchEnd))}stop(){this._element.removeEventListener("pointerdown",this._pointerStart),this._element.removeEventListener("mousedown",this._pointerStart),this._element.removeEventListener("touchstart",this._touchStart),this._element.removeEventListener("touchmove",this._move),this._element.removeEventListener("touchend",this._touchEnd),this._element.removeEventListener("touchcancel",this._touchEnd),this._element.removeEventListener(this._rawUpdates?"pointerrawupdate":"pointermove",this._move),this._element.removeEventListener("pointerup",this._pointerEnd),this._element.removeEventListener("pointercancel",this._pointerEnd),window.removeEventListener("mousemove",this._move),window.removeEventListener("mouseup",this._pointerEnd)}_triggerPointerStart(t,n){return this._startCallback(t,n)?(this.currentPointers.push(t),this.startPointers.push(t),!0):!1}}function kt(e,t){return t?Math.sqrt((t.clientX-e.clientX)**2+(t.clientY-e.clientY)**2):0}function Mt(e,t){return t?{clientX:(e.clientX+t.clientX)/2,clientY:(e.clientY+t.clientY)/2}:e}function kn(e,t,n){return Math.min(Math.max(e,t),n)}const Ye=class extends Sn{constructor(n){super();Re(this,"element");Re(this,"transform",new DOMMatrix);Re(this,"pointerTracker");this.element=n,this.element.addEventListener("wheel",this.onWheel.bind(this)),this.pointerTracker=new Rn(this.element,{start:(r,s)=>this.pointerTracker.currentPointers.length===2?!1:(s.preventDefault(),!0),move:r=>{this.onPointerMove(r,this.pointerTracker.currentPointers)},avoidPointerEvents:this.isSafari()}),this.element.addEventListener("wheel",this.onWheel.bind(this))}get x(){return this.transform.e}get y(){return this.transform.f}get scale(){return this.transform.a}set x(n){this.transform.e=n}set y(n){this.transform.f=n}set scale(n){this.transform.a=n,this.transform.d=n}onWheel(n){n.preventDefault();const r=this.element.getBoundingClientRect();let{deltaY:s}=n;const{ctrlKey:i,deltaMode:o}=n;o===1&&(s*=15);const a=s>0,l=i?100:300,u=1-(a?-s:s)/l,d=a?1/u:u,f=n.clientX-r.left,_=n.clientY-r.top;this.applyTransformation({scaleDiff:d,originX:f,originY:_})}applyTransformation(n={}){const{panX:r=0,panY:s=0,originX:i=0,originY:o=0,scaleDiff:a=1}=n,l=new DOMMatrix().translate(i,o).scale(a).translate(-i,-o),u=new DOMMatrix().translate(r,s);l.multiplySelf(u),l.multiplySelf(this.transform);const d=l.a,f=l.e,_=l.f;this.updateTransform(d,f,_)}onPointerMove(n,r){const s=this.element.getBoundingClientRect(),i=Mt(n[0],n[1]),o=Mt(r[0],r[1]),a=i.clientX-s.left,l=i.clientY-s.top,u=kt(n[0],n[1]),d=kt(r[0],r[1]),f=u?d/u:1;this.applyTransformation({originX:a,originY:l,scaleDiff:f,panX:o.clientX-i.clientX,panY:o.clientY-i.clientY})}updateTransform(n,r,s){if(n=kn(n,Ye.MIN_SCALE,Ye.MAX_SCALE),n===this.scale&&r===this.x&&s===this.y)return;this.x=r,this.y=s,this.scale=n;const i=new CustomEvent("panzoom:change",{bubbles:!0,detail:{x:this.x,y:this.y,scale:this.scale,matrix:this.transform}});this.dispatchTypedEvent("panzoom:change",i)}isSafari(){return/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)}destroy(){this.pointerTracker.stop()}};let Ue=Ye;Re(Ue,"MIN_SCALE",.01),Re(Ue,"MAX_SCALE",1e5);const Mn=e=>({}),Ct=e=>({}),Cn=e=>({}),Ut=e=>({});function Un(e){let t,n,r,s,i,o,a,l,u,d,f,_,L,D;const T=e[6].left,w=tt(T,e,e[5],Ut),I=e[6].right,R=tt(I,e,e[5],Ct);return f=new Pe({props:{src:rn,class:"w-6 h-6 text-white"}}),{c(){t=g("div"),n=g("div"),r=g("div"),s=g("div"),w&&w.c(),i=C(),o=g("div"),a=g("div"),R&&R.c(),l=C(),u=g("div"),d=g("div"),ee(f.$$.fragment),this.h()},l(b){t=v(b,"DIV",{class:!0});var p=A(t);n=v(p,"DIV",{class:!0});var y=A(n);r=v(y,"DIV",{class:!0});var N=A(r);s=v(N,"DIV",{style:!0,class:!0});var S=A(s);w&&w.l(S),S.forEach(m),N.forEach(m),i=U(y),o=v(y,"DIV",{class:!0});var B=A(o);a=v(B,"DIV",{style:!0,class:!0});var $=A(a);R&&R.l($),$.forEach(m),B.forEach(m),y.forEach(m),l=U(p),u=v(p,"DIV",{class:!0});var x=A(u);d=v(x,"DIV",{class:!0});var M=A(d);te(f.$$.fragment,M),M.forEach(m),x.forEach(m),p.forEach(m),this.h()},h(){c(s,"style",e[2]),c(s,"class","w-full h-full origin-top-left grid place-items-center"),c(r,"class","mask-left svelte-90j1r"),c(a,"style",e[2]),c(a,"class","w-full h-full origin-top-left grid place-items-center"),c(o,"class","mask-right svelte-90j1r"),c(n,"class","w-full h-full grid place-items-center"),c(d,"class","w-12 h-12 rounded-full bg-black absolute top-1/2 -translate-x-1/2 left-1/2 grid place-items-center"),c(u,"class","handle relative shadow-lg svelte-90j1r"),c(t,"class","pz-container svelte-90j1r"),st(t,"--split-point",e[1]+"%")},m(b,p){W(b,t,p),h(t,n),h(n,r),h(r,s),w&&w.m(s,null),h(n,i),h(n,o),h(o,a),R&&R.m(a,null),h(t,l),h(t,u),h(u,d),ne(f,d,null),e[7](t),_=!0,L||(D=[Ve(e[4].call(null,n)),Ve(e[3].call(null,u)),q(u,"pointercancel",ot(Pn))],L=!0)},p(b,[p]){w&&w.p&&(!_||p&32)&&nt(w,T,b,b[5],_?it(T,b[5],p,Cn):rt(b[5]),Ut),(!_||p&4)&&c(s,"style",b[2]),R&&R.p&&(!_||p&32)&&nt(R,I,b,b[5],_?it(I,b[5],p,Mn):rt(b[5]),Ct),(!_||p&4)&&c(a,"style",b[2]),p&2&&st(t,"--split-point",b[1]+"%")},i(b){_||(P(w,b),P(R,b),P(f.$$.fragment,b),_=!0)},o(b){F(w,b),F(R,b),F(f.$$.fragment,b),_=!1},d(b){b&&m(t),w&&w.d(b),R&&R.d(b),re(f),e[7](null),L=!1,Be(D)}}}function Bn(e,t,n){return Math.min(Math.max(e,t),n)}const Pn=()=>{};function Nn(e,t,n){let{$$slots:r={},$$scope:s}=t,i=null,o=50;function a(f){f.addEventListener("pointerdown",_=>{const L=_.clientX,D=o,T=document.body.style.cursor;document.body.style.cursor="col-resize";const w=R=>{const b=i?i.clientWidth:window.innerWidth,p=R.clientX-L,y=D+p/b*100;n(1,o=Bn(y,0,100))},I=()=>{document.body.style.cursor=T,window.removeEventListener("pointermove",w),window.removeEventListener("pointerup",I),window.removeEventListener("pointercancel",I)};window.addEventListener("pointermove",w),window.addEventListener("pointerup",I),window.addEventListener("pointercancel",I)})}let l="transform: none;";function u(f){const _=new Ue(f);function L(D){const{x:T,y:w,scale:I,matrix:R}=D.detail;n(2,l=`transform: translate(${T}px, ${w}px) scale(${I})`)}return _.addEventListener("panzoom:change",L),{destroy(){_.removeEventListener("panzoom:change",L),_.destroy()}}}function d(f){me[f?"unshift":"push"](()=>{i=f,n(0,i)})}return e.$$set=f=>{"$$scope"in f&&n(5,s=f.$$scope)},[i,o,l,a,u,s,r,d]}class Xn extends Te{constructor(t){super(),Ie(this,t,Nn,Un,Le,{})}}const Fn=""+new URL("../assets/cat.58b560b7.jpg",import.meta.url).href,$n="data:image/avif;base64,AAAAHGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZgAAAOptZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAImlsb2MAAAAAREAAAQABAAAAAAEOAAEAAAAAAAAApwAAACNpaW5mAAAAAAABAAAAFWluZmUCAAAAAAEAAGF2MDEAAAAAamlwcnAAAABLaXBjbwAAABNjb2xybmNseAACAAIABoAAAAAMYXYxQ4EEDAAAAAAUaXNwZQAAAAAAAAJyAAACcgAAABBwaXhpAAAAAAMICAgAAAAXaXBtYQAAAAAAAAABAAEEgYIDhAAAAK9tZGF0EgAKChkmZxnHggQEDQgylgERQAEEEEEA9NBi7JFlrqXV1mwMry34uIYK7WRdWYJ/ZZ0EIyWW8aLm92oz5LY0W+l2FiKsHpp4BB3Vrk+iwHuzboac7wmSHHHRWklZdZ2hpEAi4E31lf1tjXnXie8fh4lzApbqjH5Pj7ZN6761WygYVdc2zvJOsflFZstng6rQU/oulDZSO6fQWKvzpO9pseyXBLfms64=",xn=""+new URL("../assets/david.0e7e3b46.png",import.meta.url).href,Je=new Map;function On(e){const t=zt(e),n=Math.pow(2,2*e);return t.map(s=>s.map(i=>i/n))}function zt(e){if(Je.has(e))return Je.get(e);if(e===0)return[[0,2],[3,1]];const t=zt(e-1),n=new Array(t.length*2).fill(0).map(()=>new Array(t.length*2).fill(0));for(let r=0;r<t.length;r++)for(let s=0;s<t[r].length;s++)n[r][s]=t[r][s]*4,n[r][s+t.length]=t[r][s]*4+2,n[r+t.length][s]=t[r][s]*4+3,n[r+t.length][s+t.length]=t[r][s]*4+1;return Je.set(e,n),n}const Vn=""+new URL("../assets/blue_noise.b61cfddd.png",import.meta.url).href,Oe={width:470,height:470};async function zn(e){switch(e.mode){case"bayer":return await Gn(e);case"blue_noise":return await Wn();case"white_noise":return await Yn(e)}}async function Yn(e){const t=new ImageData(e.width,e.height),n=t.data;for(let r=0;r<n.length;r+=4){const s=Math.random()*255;n[r]=s,n[r+1]=s,n[r+2]=s,n[r+3]=255}return t}let et=null;async function Wn(){et||(et=await Dn(Vn));const t=new OffscreenCanvas(Oe.width,Oe.height).getContext("2d");return t.drawImage(et,0,0),t.getImageData(0,0,Oe.width,Oe.height)}async function Gn(e){const t=new OffscreenCanvas(Math.pow(2,e.level+1),Math.pow(2,e.level+1)),n=On(e.level),r=t.getContext("2d");for(let s=0;s<n.length;s++)for(let i=0;i<n[s].length;i++){const o=n[s][i]*255/4;r.fillStyle=`rgb(${o}, ${o}, ${o})`,r.fillRect(i,s,1,1)}return r.getImageData(0,0,t.width,t.height)}function Hn(e){let t,n,r,s;return{c(){t=g("canvas"),this.h()},l(i){t=v(i,"CANVAS",{class:!0,style:!0}),A(t).forEach(m),this.h()},h(){c(t,"class","w-full max-h-96 object-contain shadow-lg"),st(t,"image-rendering","pixelated")},m(i,o){W(i,t,o),r||(s=Ve(n=jn.call(null,t,e[0])),r=!0)},p(i,[o]){n&&Ot(n.update)&&o&1&&n.update.call(null,i[0])},i:ye,o:ye,d(i){i&&m(t),r=!1,s()}}}function jn(e,t){const n=e.getContext("2d");if(!n)return;const r=()=>{e.width=t.width,e.height=t.height,n.putImageData(t,0,0)};let s=null;const i=()=>{s||(s=requestAnimationFrame(()=>{s=null,r()}))};return i(),{destroy(){s&&cancelAnimationFrame(s)},update:o=>{t=o,i()}}}function Zn(e,t,n){let{imageData:r}=t;return e.$$set=s=>{"imageData"in s&&n(0,r=s.imageData)},[r]}class qn extends Te{constructor(t){super(),Ie(this,t,Zn,Hn,Le,{imageData:0})}}function Bt(e,t,n){const r=e.slice();return r[34]=t[n],r}function Qn(e){let t,n,r,s,i,o,a,l,u,d,f,_,L,D,T,w,I,R,b=e[14],p=[];for(let y=0;y<b.length;y+=1)p[y]=Pt(Bt(e,b,y));return d=new Pe({props:{src:on,class:"w-12 h-12 text-gray-400"}}),{c(){t=g("div"),n=g("div"),r=g("p"),s=j("Select or Drop an Image to Start"),i=C(),o=g("div");for(let y=0;y<p.length;y+=1)p[y].c();a=C(),l=g("label"),u=g("div"),ee(d.$$.fragment),f=C(),_=g("span"),L=j("Choose an Image"),D=C(),T=g("input"),this.h()},l(y){t=v(y,"DIV",{class:!0});var N=A(t);n=v(N,"DIV",{class:!0});var S=A(n);r=v(S,"P",{class:!0});var B=A(r);s=Z(B,"Select or Drop an Image to Start"),B.forEach(m),i=U(S),o=v(S,"DIV",{class:!0});var $=A(o);for(let Q=0;Q<p.length;Q+=1)p[Q].l($);a=U($),l=v($,"LABEL",{for:!0,class:!0});var x=A(l);u=v(x,"DIV",{class:!0});var M=A(u);te(d.$$.fragment,M),M.forEach(m),f=U(x),_=v(x,"SPAN",{class:!0});var O=A(_);L=Z(O,"Choose an Image"),O.forEach(m),D=U(x),T=v(x,"INPUT",{type:!0,class:!0,id:!0,accept:!0}),x.forEach(m),$.forEach(m),S.forEach(m),N.forEach(m),this.h()},h(){c(r,"class","text-2xl text-gray-500"),c(u,"class","grid place-items-center h-full w-full"),c(_,"class","sr-only"),c(T,"type","file"),c(T,"class","sr-only"),c(T,"id","image-input"),c(T,"accept","image/*"),c(l,"for","image-input"),c(l,"class","block spect-square h-24 w-24 object-cover rounded-md shadow-md border-2 border-white bg-white hover:bg-gray-100"),c(o,"class","flex gap-3 justify-center"),c(n,"class","grid gap-4"),c(t,"class","w-full h-full grid place-items-center")},m(y,N){W(y,t,N),h(t,n),h(n,r),h(r,s),h(n,i),h(n,o);for(let S=0;S<p.length;S+=1)p[S]&&p[S].m(o,null);h(o,a),h(o,l),h(l,u),ne(d,u,null),h(l,f),h(l,_),h(_,L),h(l,D),h(l,T),w=!0,I||(R=q(T,"input",e[18]),I=!0)},p(y,N){if(N[0]&540672){b=y[14];let S;for(S=0;S<b.length;S+=1){const B=Bt(y,b,S);p[S]?p[S].p(B,N):(p[S]=Pt(B),p[S].c(),p[S].m(o,a))}for(;S<p.length;S+=1)p[S].d(1);p.length=b.length}},i(y){w||(P(d.$$.fragment,y),w=!0)},o(y){F(d.$$.fragment,y),w=!1},d(y){y&&m(t),xt(p,y),re(d),I=!1,R()}}}function Kn(e){let t,n,r,s,i,o,a,l;return n=new Xn({props:{$$slots:{right:[er],left:[Jn]},$$scope:{ctx:e}}}),i=new Pe({props:{src:an,class:"w-5 h-5 text-white"}}),{c(){t=g("div"),ee(n.$$.fragment),r=C(),s=g("button"),ee(i.$$.fragment),this.h()},l(u){t=v(u,"DIV",{class:!0});var d=A(t);te(n.$$.fragment,d),r=U(d),s=v(d,"BUTTON",{class:!0,title:!0});var f=A(s);te(i.$$.fragment,f),f.forEach(m),d.forEach(m),this.h()},h(){c(s,"class","absolute top-0 right-0 m-4 p-2 bg-black bg-opacity-40 rounded-full"),c(s,"title","Close Image & Reset"),c(t,"class","w-full h-full relative")},m(u,d){W(u,t,d),ne(n,t,null),h(t,r),h(t,s),ne(i,s,null),o=!0,a||(l=q(s,"click",e[22]),a=!0)},p(u,d){const f={};d[0]&16344|d[1]&64&&(f.$$scope={dirty:d,ctx:u}),n.$set(f)},i(u){o||(P(n.$$.fragment,u),P(i.$$.fragment,u),o=!0)},o(u){F(n.$$.fragment,u),F(i.$$.fragment,u),o=!1},d(u){u&&m(t),re(n),re(i),a=!1,l()}}}function Pt(e){let t,n,r,s,i;function o(){return e[23](e[34])}return{c(){t=g("button"),n=g("img"),this.h()},l(a){t=v(a,"BUTTON",{class:!0});var l=A(t);n=v(l,"IMG",{class:!0,src:!0,alt:!0}),l.forEach(m),this.h()},h(){c(n,"class","aspect-square h-24 w-24 object-cover rounded-md shadow-md border-2 border-white"),at(n.src,r=e[34])||c(n,"src",r),c(n,"alt",""),c(t,"class","hover:opacity-75 transition-opacity")},m(a,l){W(a,t,l),h(t,n),s||(i=q(t,"click",o),s=!0)},p(a,l){e=a},d(a){a&&m(t),s=!1,i()}}}function Jn(e){let t,n,r;return{c(){t=g("img"),this.h()},l(s){t=v(s,"IMG",{slot:!0,src:!0,alt:!0,style:!0,class:!0}),this.h()},h(){c(t,"slot","left"),at(t.src,n=e[4].src)||c(t,"src",n),c(t,"alt",""),c(t,"style",r=`width: ${e[3]}px; height: ${e[13]}px`),c(t,"class","pixelated max-w-none svelte-1gkt69q")},m(s,i){W(s,t,i)},p(s,i){i[0]&16&&!at(t.src,n=s[4].src)&&c(t,"src",n),i[0]&8200&&r!==(r=`width: ${s[3]}px; height: ${s[13]}px`)&&c(t,"style",r)},d(s){s&&m(t)}}}function er(e){let t,n,r,s,i;return{c(){t=g("canvas"),this.h()},l(o){t=v(o,"CANVAS",{class:!0,slot:!0,style:!0,width:!0,height:!0,"aria-label":!0}),A(t).forEach(m),this.h()},h(){c(t,"class","pixelated svelte-1gkt69q"),c(t,"slot","right"),c(t,"style",n=`width: ${e[3]}px; height: ${e[13]}px`),c(t,"width",e[3]),c(t,"height",e[13]),c(t,"aria-label","Dithered Image")},m(o,a){W(o,t,a),e[21](t),s||(i=Ve(r=wn.call(null,t,{image:e[4],threshold:e[6],noiseIntensity:e[7],monochrome:e[8],colorLight:e[9],colorDark:e[10],output_width:e[3],output_height:e[13],thresholdMap:e[12]})),s=!0)},p(o,a){a[0]&8200&&n!==(n=`width: ${o[3]}px; height: ${o[13]}px`)&&c(t,"style",n),a[0]&8&&c(t,"width",o[3]),a[0]&8192&&c(t,"height",o[13]),r&&Ot(r.update)&&a[0]&14296&&r.update.call(null,{image:o[4],threshold:o[6],noiseIntensity:o[7],monochrome:o[8],colorLight:o[9],colorDark:o[10],output_width:o[3],output_height:o[13],thresholdMap:o[12]})},d(o){o&&m(t),e[21](null),s=!1,i()}}}function Nt(e){let t,n,r;function s(o){e[25](o)}let i={label:"Bayer Level ("+e[1]+")",min:0,max:5,step:1};return e[1]!==void 0&&(i.value=e[1]),t=new lt({props:i}),me.push(()=>Ae(t,"value",s)),{c(){ee(t.$$.fragment)},l(o){te(t.$$.fragment,o)},m(o,a){ne(t,o,a),r=!0},p(o,a){const l={};a[0]&2&&(l.label="Bayer Level ("+o[1]+")"),!n&&a[0]&2&&(n=!0,l.value=o[1],we(()=>n=!1)),t.$set(l)},i(o){r||(P(t.$$.fragment,o),r=!0)},o(o){F(t.$$.fragment,o),r=!1},d(o){re(t,o)}}}function Xt(e){let t,n,r;function s(o){e[26](o)}let i={aspectRatio:1};return e[2]!==void 0&&(i.width=e[2]),t=new Vt({props:i}),me.push(()=>Ae(t,"width",s)),{c(){ee(t.$$.fragment)},l(o){te(t.$$.fragment,o)},m(o,a){ne(t,o,a),r=!0},p(o,a){const l={};!n&&a[0]&4&&(n=!0,l.width=o[2],we(()=>n=!1)),t.$set(l)},i(o){r||(P(t.$$.fragment,o),r=!0)},o(o){F(t.$$.fragment,o),r=!1},d(o){re(t,o)}}}function Ft(e){let t,n,r;return n=new qn({props:{imageData:e[12]}}),{c(){t=g("div"),ee(n.$$.fragment),this.h()},l(s){t=v(s,"DIV",{class:!0});var i=A(t);te(n.$$.fragment,i),i.forEach(m),this.h()},h(){c(t,"class","w-full aspect-square rounded-lg bg-gray-100 p-8 grid place-items-center")},m(s,i){W(s,t,i),ne(n,t,null),r=!0},p(s,i){const o={};i[0]&4096&&(o.imageData=s[12]),n.$set(o)},i(s){r||(P(n.$$.fragment,s),r=!0)},o(s){F(n.$$.fragment,s),r=!1},d(s){s&&m(t),re(n)}}}function $t(e){let t,n,r,s,i,o,a,l,u,d,f,_,L,D;return{c(){t=g("fieldset"),n=g("div"),r=g("input"),s=C(),i=g("label"),o=j("Light"),a=C(),l=g("div"),u=g("input"),d=C(),f=g("label"),_=j("Dark"),this.h()},l(T){t=v(T,"FIELDSET",{});var w=A(t);n=v(w,"DIV",{class:!0});var I=A(n);r=v(I,"INPUT",{type:!0,name:!0,id:!0}),s=U(I),i=v(I,"LABEL",{for:!0,class:!0});var R=A(i);o=Z(R,"Light"),R.forEach(m),I.forEach(m),a=U(w),l=v(w,"DIV",{class:!0});var b=A(l);u=v(b,"INPUT",{type:!0,name:!0,id:!0}),d=U(b),f=v(b,"LABEL",{for:!0,class:!0});var p=A(f);_=Z(p,"Dark"),p.forEach(m),b.forEach(m),w.forEach(m),this.h()},h(){c(r,"type","color"),c(r,"name","color-light"),c(r,"id","color-light"),c(i,"for","color-light"),c(i,"class","font-medium text-gray-900"),c(n,"class","flex gap-3"),c(u,"type","color"),c(u,"name","color-dark"),c(u,"id","color-dark"),c(f,"for","color-dark"),c(f,"class","font-medium text-gray-900"),c(l,"class","flex gap-3")},m(T,w){W(T,t,w),h(t,n),h(n,r),ke(r,e[9]),h(n,s),h(n,i),h(i,o),h(t,a),h(t,l),h(l,u),ke(u,e[10]),h(l,d),h(l,f),h(f,_),L||(D=[q(r,"input",e[30]),q(u,"input",e[31])],L=!0)},p(T,w){w[0]&512&&ke(r,T[9]),w[0]&1024&&ke(u,T[10])},d(T){T&&m(t),L=!1,Be(D)}}}function tr(e){let t,n,r;return t=new Pe({props:{src:sn,class:"w-4 h-4"}}),{c(){ee(t.$$.fragment),n=j(`
				Save`)},l(s){te(t.$$.fragment,s),n=Z(s,`
				Save`)},m(s,i){ne(t,s,i),W(s,n,i),r=!0},p:ye,i(s){r||(P(t.$$.fragment,s),r=!0)},o(s){F(t.$$.fragment,s),r=!1},d(s){re(t,s),s&&m(n)}}}function nr(e){let t,n,r,s,i,o,a,l,u,d,f,_,L,D,T,w,I,R,b,p,y,N,S,B,$,x,M,O,Q,ie,se,K,pe,oe,le,ue,k,G,ae,_e,We,Ge,ce,He,je,Ze,De,fe,Ne,qe,ct;const dt=[Kn,Qn],ge=[];function ht(E,X){return E[4]&&E[12]?0:1}i=ht(e),o=ge[i]=dt[i](e);function Yt(E){e[24](E)}let ft={label:"Dither Mode",options:e[16]};e[0]!==void 0&&(ft.selected=e[0]),D=new hn({props:ft}),me.push(()=>Ae(D,"selected",Yt));let V=e[0]==="bayer"&&Nt(e),z=e[0]==="white_noise"&&Xt(e),Y=e[12]&&Ft(e);function Wt(E){e[27](E)}let mt={label:"Threshold ("+e[6]+")",min:0,max:1,step:.01};e[6]!==void 0&&(mt.value=e[6]),B=new lt({props:mt}),me.push(()=>Ae(B,"value",Wt));function Gt(E){e[28](E)}let pt={label:"Noise Intensity ("+e[7]+")",min:0,max:1.5,step:.01};e[7]!==void 0&&(pt.value=e[7]),M=new lt({props:pt}),me.push(()=>Ae(M,"value",Gt));let H=e[8]&&$t(e);function Ht(E){e[32](E)}function jt(E){e[33](E)}let Qe={};return e[3]!==void 0&&(Qe.width=e[3]),e[5]!==void 0&&(Qe.aspectRatio=e[5]),ce=new Vt({props:Qe}),me.push(()=>Ae(ce,"width",Ht)),me.push(()=>Ae(ce,"aspectRatio",jt)),fe=new In({props:{disabled:!(e[4]&&e[12]),$$slots:{default:[tr]},$$scope:{ctx:e}}}),fe.$on("click",e[15]),{c(){t=C(),n=C(),r=g("main"),s=g("section"),o.c(),a=C(),l=g("aside"),u=g("section"),d=g("div"),f=g("h2"),_=j("Threshold Map"),L=C(),ee(D.$$.fragment),w=C(),V&&V.c(),I=C(),z&&z.c(),R=C(),Y&&Y.c(),b=C(),p=g("div"),y=g("h2"),N=j("Dithering Options"),S=C(),ee(B.$$.fragment),x=C(),ee(M.$$.fragment),Q=C(),ie=g("div"),se=g("div"),K=g("input"),pe=C(),oe=g("div"),le=g("label"),ue=j("Monochrome"),k=C(),H&&H.c(),G=C(),ae=g("div"),_e=g("h2"),We=j("Output Options"),Ge=C(),ee(ce.$$.fragment),Ze=C(),De=g("footer"),ee(fe.$$.fragment),this.h()},l(E){tn("svelte-1hm2pfs",document.head).forEach(m),t=U(E),n=U(E),r=v(E,"MAIN",{class:!0});var ve=A(r);s=v(ve,"SECTION",{class:!0});var Me=A(s);o.l(Me),Me.forEach(m),a=U(ve),l=v(ve,"ASIDE",{class:!0});var Ee=A(l);u=v(Ee,"SECTION",{class:!0});var de=A(u);d=v(de,"DIV",{class:!0});var J=A(d);f=v(J,"H2",{class:!0});var Se=A(f);_=Z(Se,"Threshold Map"),Se.forEach(m),L=U(J),te(D.$$.fragment,J),w=U(J),V&&V.l(J),I=U(J),z&&z.l(J),R=U(J),Y&&Y.l(J),J.forEach(m),b=U(de),p=v(de,"DIV",{class:!0});var he=A(p);y=v(he,"H2",{class:!0});var _t=A(y);N=Z(_t,"Dithering Options"),_t.forEach(m),S=U(he),te(B.$$.fragment,he),x=U(he),te(M.$$.fragment,he),Q=U(he),ie=v(he,"DIV",{class:!0});var Xe=A(ie);se=v(Xe,"DIV",{class:!0});var gt=A(se);K=v(gt,"INPUT",{type:!0,id:!0,class:!0}),gt.forEach(m),pe=U(Xe),oe=v(Xe,"DIV",{class:!0});var vt=A(oe);le=v(vt,"LABEL",{for:!0,class:!0});var Et=A(le);ue=Z(Et,"Monochrome"),Et.forEach(m),vt.forEach(m),Xe.forEach(m),k=U(he),H&&H.l(he),he.forEach(m),G=U(de),ae=v(de,"DIV",{class:!0});var Fe=A(ae);_e=v(Fe,"H2",{class:!0});var bt=A(_e);We=Z(bt,"Output Options"),bt.forEach(m),Ge=U(Fe),te(ce.$$.fragment,Fe),Fe.forEach(m),de.forEach(m),Ze=U(Ee),De=v(Ee,"FOOTER",{class:!0});var At=A(De);te(fe.$$.fragment,At),At.forEach(m),Ee.forEach(m),ve.forEach(m),this.h()},h(){document.title="Dithering",c(s,"class","flex-1 overflow-hidden select-none"),c(f,"class","text-base font-semibold leading-7 text-black mb-2"),c(d,"class","grid gap-3"),c(y,"class","text-base font-semibold leading-7 text-black mb-2"),c(K,"type","checkbox"),c(K,"id","monochrome"),c(K,"class","h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600"),c(se,"class","flex h-6 items-center"),c(le,"for","monochrome"),c(le,"class","font-medium text-gray-900"),c(oe,"class","ml-3 text-sm leading-6"),c(ie,"class","relative flex items-start"),c(p,"class","grid gap-3"),c(_e,"class","text-base font-semibold leading-7 text-black mb-4"),c(ae,"class","border-t border-gray-100 py-4"),c(u,"class","grid gap-5 overflow-y-auto overflow-x-visible py-8 px-4"),c(De,"class","py-4 px-4 flex-shrink-0"),c(l,"class","bg-white w-full md:max-w-md border-t md:border-t-0 md:border-l border-l-0 border-gray-100 z-50 overflow-y-hidden md:h-full flex-1 shadow-lg flex flex-col divide-y divide-gray-200 justify-between"),c(r,"class","w-screen max-w-screen h-screen max-h-screen flex md:flex-row flex-col bg-gray-300")},m(E,X){W(E,t,X),W(E,n,X),W(E,r,X),h(r,s),ge[i].m(s,null),h(r,a),h(r,l),h(l,u),h(u,d),h(d,f),h(f,_),h(d,L),ne(D,d,null),h(d,w),V&&V.m(d,null),h(d,I),z&&z.m(d,null),h(d,R),Y&&Y.m(d,null),h(u,b),h(u,p),h(p,y),h(y,N),h(p,S),ne(B,p,null),h(p,x),ne(M,p,null),h(p,Q),h(p,ie),h(ie,se),h(se,K),K.checked=e[8],h(ie,pe),h(ie,oe),h(oe,le),h(le,ue),h(p,k),H&&H.m(p,null),h(u,G),h(u,ae),h(ae,_e),h(_e,We),h(ae,Ge),ne(ce,ae,null),h(l,Ze),h(l,De),ne(fe,De,null),Ne=!0,qe||(ct=[q(document.body,"drop",ot(e[17])),q(document.body,"dragover",ot(rr)),q(K,"change",e[29])],qe=!0)},p(E,X){let ve=i;i=ht(E),i===ve?ge[i].p(E,X):(xe(),F(ge[ve],1,1,()=>{ge[ve]=null}),$e(),o=ge[i],o?o.p(E,X):(o=ge[i]=dt[i](E),o.c()),P(o,1),o.m(s,null));const Me={};!T&&X[0]&1&&(T=!0,Me.selected=E[0],we(()=>T=!1)),D.$set(Me),E[0]==="bayer"?V?(V.p(E,X),X[0]&1&&P(V,1)):(V=Nt(E),V.c(),P(V,1),V.m(d,I)):V&&(xe(),F(V,1,1,()=>{V=null}),$e()),E[0]==="white_noise"?z?(z.p(E,X),X[0]&1&&P(z,1)):(z=Xt(E),z.c(),P(z,1),z.m(d,R)):z&&(xe(),F(z,1,1,()=>{z=null}),$e()),E[12]?Y?(Y.p(E,X),X[0]&4096&&P(Y,1)):(Y=Ft(E),Y.c(),P(Y,1),Y.m(d,null)):Y&&(xe(),F(Y,1,1,()=>{Y=null}),$e());const Ee={};X[0]&64&&(Ee.label="Threshold ("+E[6]+")"),!$&&X[0]&64&&($=!0,Ee.value=E[6],we(()=>$=!1)),B.$set(Ee);const de={};X[0]&128&&(de.label="Noise Intensity ("+E[7]+")"),!O&&X[0]&128&&(O=!0,de.value=E[7],we(()=>O=!1)),M.$set(de),X[0]&256&&(K.checked=E[8]),E[8]?H?H.p(E,X):(H=$t(E),H.c(),H.m(p,null)):H&&(H.d(1),H=null);const J={};!He&&X[0]&8&&(He=!0,J.width=E[3],we(()=>He=!1)),!je&&X[0]&32&&(je=!0,J.aspectRatio=E[5],we(()=>je=!1)),ce.$set(J);const Se={};X[0]&4112&&(Se.disabled=!(E[4]&&E[12])),X[1]&64&&(Se.$$scope={dirty:X,ctx:E}),fe.$set(Se)},i(E){Ne||(P(o),P(D.$$.fragment,E),P(V),P(z),P(Y),P(B.$$.fragment,E),P(M.$$.fragment,E),P(ce.$$.fragment,E),P(fe.$$.fragment,E),Ne=!0)},o(E){F(o),F(D.$$.fragment,E),F(V),F(z),F(Y),F(B.$$.fragment,E),F(M.$$.fragment,E),F(ce.$$.fragment,E),F(fe.$$.fragment,E),Ne=!1},d(E){E&&m(t),E&&m(n),E&&m(r),ge[i].d(),re(D),V&&V.d(),z&&z.d(),Y&&Y.d(),re(B),re(M),H&&H.d(),re(ce),re(fe),qe=!1,Be(ct)}}}const rr=()=>{};function ir(e,t,n){let r,s,i;const o=[Fn,$n,xn];let a=.5,l=.3,u=!1,d="#ede6cc",f="#21263f",_=null,L="blue_noise",D=3,T=256,w=300,I=null;async function R(){_&&await Ln(_,"dithered","png")}const b=[{name:"Bayer",value:"bayer"},{name:"Blue Noise",value:"blue_noise"},{name:"White Noise",value:"white_noise"}];async function p(k){var ae;const G=(ae=k.dataTransfer)==null?void 0:ae.files[0];if(G){if(!G.type.startsWith("image/")){alert("Please drop an image file");return}try{n(4,I=await St(G))}catch(_e){alert("Failed to load image"),console.error(_e)}}}async function y(k){const G=k.target.files[0];if(G)try{n(4,I=await St(G))}catch(ae){alert("Failed to load image"),console.error(ae)}}async function N(k){const G=new Image;G.onload=()=>{n(4,I=G)},G.src=k}let S=null;function B(k){me[k?"unshift":"push"](()=>{_=k,n(11,_)})}const $=()=>n(4,I=null),x=k=>N(k);function M(k){L=k,n(0,L)}function O(k){D=k,n(1,D)}function Q(k){T=k,n(2,T)}function ie(k){a=k,n(6,a)}function se(k){l=k,n(7,l)}function K(){u=this.checked,n(8,u)}function pe(){d=this.value,n(9,d)}function oe(){f=this.value,n(10,f)}function le(k){w=k,n(3,w)}function ue(k){i=k,n(5,i),n(4,I)}return e.$$.update=()=>{if(e.$$.dirty[0]&4&&n(20,r=T),e.$$.dirty[0]&16&&n(5,i=I!=null&&I.width&&(I!=null&&I.height)?I.width/I.height:1),e.$$.dirty[0]&40&&n(13,s=w/i),e.$$.dirty[0]&1048583&&"ImageData"in globalThis){let k;switch(L){case"bayer":k={mode:"bayer",level:D};break;case"blue_noise":k={mode:"blue_noise"};break;case"white_noise":k={mode:"white_noise",width:T,height:r};break}zn(k).then(G=>n(12,S=G))}},[L,D,T,w,I,i,a,l,u,d,f,_,S,s,o,R,b,p,y,N,r,B,$,x,M,O,Q,ie,se,K,pe,oe,le,ue]}class ur extends Te{constructor(t){super(),Ie(this,t,ir,nr,Le,{},null,[-1,-1])}}export{ur as component};

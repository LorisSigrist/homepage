import{S as Qe,i as Je,s as Ze,k as d,a as I,l as h,m as A,c as S,h as l,n,b as v,G as f,U as G,H as Xe,o as je,q as C,r as X,T as Ge,V as $e,W as M,X as ke,Y as et,u as Me,Z as me,_ as tt,$ as qe,a0 as rt}from"../chunks/index.e8656bf8.js";/* empty css                          */const ot=""+new URL("../assets/img.58b560b7.jpg",import.meta.url).href,it="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAARtJREFUGBkBEAHv/gQAgKB/aX+hf1t/oX9pf6F/BL+Bv4G/gb+Bv4G/gb+Bv4EEcX8xf3F/MX9xfzF/cX8xfwS/gb+Bv4G/gb+Bv4G/gb+BBB1/XX8Nf01/HX9dfw1/TX8Ev4G/gb+Bv4G/gb+Bv4G/gQRxfzF/cX8xf3F/MX9xfzF/BL+Bv4G/gb+Bv4G/gb+Bv4EECH9Ifxh/WH8Ef0R/FH9UfwS/gb+Bv4G/gb+Bv4G/gb+BBHF/MX9xfzF/cX8xf3F/MX8Ev4G/gb+Bv4G/gb+Bv4G/gQQdf11/DX9Nfx1/XX8Nf01/BL+Bv4G/gb+Bv4G/gb+Bv4EEcX8xf3F/MX9xfzF/cX8xfwS/gb+Bv4G/gb+Bv4G/gb+BIZOCkuKxtP8AAAAASUVORK5CYII=",Oe={width:16,height:16},nt=""+new URL("../assets/blue_noise.b61cfddd.png",import.meta.url).href,ze={width:470,height:470},st=`precision highp float;

attribute vec2 position;
varying vec2 fragCoord;

// Just a simple vertex shader that passes on the 2d position to the fragment shader
void main() {
    fragCoord.x = position.x * 0.5 + 0.5;
    fragCoord.y = position.y * 0.5 + 0.5;
    
    gl_Position = vec4(position, 0.0, 1.0);
}`,at=`precision highp float;
varying vec2 fragCoord;

uniform sampler2D uSampler;
uniform float uThreshold;
uniform sampler2D uNoiseSampler;
uniform vec2 uNoiseSamplerSize;

uniform float uNoise;
uniform float uMonochrome;

uniform vec2 uSize;

uniform vec3 uDarkColor;
uniform vec3 uLightColor;

void main(void) {
    //Map the current image pixel to the noise texture
    vec2 imgPixel = vec2(fragCoord.x * uSize.x, fragCoord.y * uSize.y);
    vec2 noisePixel = vec2( mod(imgPixel.x, uNoiseSamplerSize.x),  mod(imgPixel.y, uNoiseSamplerSize.y));
    
    vec2 noiseUV = vec2(noisePixel.x / uNoiseSamplerSize.x, noisePixel.y / uNoiseSamplerSize.y);
    float noise = (texture2D(uNoiseSampler, noiseUV).r - 0.5) * 2.0 * uNoise;

    //Get the color of the current pixel from the image
    vec4 color = texture2D(uSampler, fragCoord);

   // Convert to grayscale using the NTSC standard coefficients
    float gray = dot(color.rgb, vec3(0.299, 0.587, 0.114));    

    color.r = color.r * (1.0 - uMonochrome) + gray * uMonochrome;
    color.g = color.g * (1.0 - uMonochrome) + gray * uMonochrome;
    color.b = color.b * (1.0 - uMonochrome) + gray * uMonochrome;

    vec3 thresholds = vec3(
        step(uThreshold, color.r + noise),
        step(uThreshold, color.g + noise),
        step(uThreshold, color.b + noise)
    );

    if(uMonochrome > 0.0) {
        color.rgb = vec3(
            mix(uDarkColor.r, uLightColor.r, thresholds.r),
            mix(uDarkColor.g, uLightColor.g, thresholds.g),
            mix(uDarkColor.b, uLightColor.b, thresholds.b)
        );
    } else {
        color.rgb = thresholds;
    }

    gl_FragColor = color;
}`;function lt(e,i,o){const t=Ve(e,e.VERTEX_SHADER,i),c=Ve(e,e.FRAGMENT_SHADER,o),a=e.createProgram();if(!a)throw new Error("Failed to create shader program");if(e.attachShader(a,t),e.attachShader(a,c),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw Error(`Unable to initialize the shader program: ${e.getProgramInfoLog(a)}`);return a}function Ve(e,i,o){const t=e.createShader(i);if(!t)throw new Error("Failed to create shader");if(e.shaderSource(t,o),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))throw Error(`An error occurred compiling the shaders: ${e.getShaderInfoLog(t)}`);return t}function Ye(e,i,o=()=>{}){const t=e.createTexture();if(!t)throw new Error("Failed to create texture");e.bindTexture(e.TEXTURE_2D,t);const c=0,a=e.RGBA,s=1,m=1,p=0,g=e.RGBA,E=e.UNSIGNED_BYTE,D=new Uint8Array([0,0,255,255]);e.texImage2D(e.TEXTURE_2D,c,a,s,m,p,g,E,D);const _=new Image;return _.onload=()=>{e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,c,a,g,E,_),de(_.width)&&de(_.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),o()},_.src=i,t}function ut(e){const i=e.createTexture();if(!i)throw new Error("Failed to create texture");e.bindTexture(e.TEXTURE_2D,i);const o=0,t=e.RGBA,c=1,a=1,s=0,m=e.RGBA,p=e.UNSIGNED_BYTE,g=new Uint8Array([0,0,255,255]);return e.texImage2D(e.TEXTURE_2D,o,t,c,a,s,m,p,g),i}function ct(e,i,o){const c=e.RGBA,a=e.RGBA,s=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,i),e.texImage2D(e.TEXTURE_2D,0,c,a,s,o),de(o.width)&&de(o.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR))}function de(e){return(e&e-1)===0}function ft(e){const i=e.createBuffer(),o=e.createBuffer(),t=[-1,1,-1,-1,1,-1,1,1],c=[3,2,1,3,1,0];return e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(c),e.STATIC_DRAW),{vertex_buffer:i,index_buffer:o}}function mt(e,i){let o=i;const t=e.getContext("webgl",{preseveDrawingBuffer:!0});if(!t){alert("WebGL not supported");return}const c=()=>{ct(t,R,o.image)};t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT);const a=lt(t,st,at),{vertex_buffer:s,index_buffer:m}=ft(t),p=t.getAttribLocation(a,"position");t.vertexAttribPointer(p,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(p);const g=t.getUniformLocation(a,"uSampler"),E=t.getUniformLocation(a,"uThreshold"),D=t.getUniformLocation(a,"uNoiseSampler"),_=t.getUniformLocation(a,"uNoise"),x=t.getUniformLocation(a,"uSize"),O=t.getUniformLocation(a,"uNoiseSamplerSize"),z=t.getUniformLocation(a,"uMonochrome"),K=t.getUniformLocation(a,"uDarkColor"),k=t.getUniformLocation(a,"uLightColor"),R=ut(t);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),c();const V=Ye(t,it,U);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0);const L=Ye(t,nt,U);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.useProgram(a);let y=null;const T=()=>{switch(t.viewport(0,0,o.width,o.height),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.bindBuffer(t.ARRAY_BUFFER,s),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,m),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,R),t.uniform1i(g,0),o.mode){case"bayer":t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,V),t.uniform1i(D,1),t.uniform2f(O,Oe.width,Oe.height);break;case"blue_noise":t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,L),t.uniform1i(D,1),t.uniform2f(O,ze.width,ze.height);break}t.uniform1f(E,o.threshold),t.uniform1f(_,o.noiseIntensity),t.uniform2f(x,o.width,o.height),t.uniform1f(z,o.monochrome?1:0),t.uniform3f(K,...We(o.colorDark)),t.uniform3f(k,...We(o.colorLight)),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)};function U(){y=requestAnimationFrame(()=>{T(),y=null})}return U(),{update(b){const w=o.image!==b.image;o=b,w&&c(),U()},destroy(){y!==null&&cancelAnimationFrame(y)}}}function We(e){const i=parseInt(e.slice(1,3),16)/255,o=parseInt(e.slice(3,5),16)/255,t=parseInt(e.slice(5,7),16)/255;return[i,o,t]}function He(e){let i,o,t,c,a,s,m,p,g,E,D,_,x,O,z,K,k,R,V,L,y,T,U,b,w,q,he,Q,_e,re,j,Y,J,pe,Ee,$,N,oe,F,W,ve,H,Te,ie,P,ne,se,ee,Ae,ae,Z,ge,be,Be,B=e[3]&&Ke(e);return{c(){i=d("img"),t=I(),c=d("div"),a=d("label"),s=C("Threshold "),m=C(e[1]),p=I(),g=d("div"),E=d("input"),D=I(),_=d("div"),x=d("label"),O=C("Noise Intensity "),z=C(e[2]),K=I(),k=d("div"),R=d("input"),V=I(),L=d("div"),y=d("div"),T=d("input"),U=I(),b=d("div"),w=d("label"),q=C("Monochrome"),he=I(),Q=d("p"),_e=C("If the dither should be monochrome, or in color"),re=I(),B&&B.c(),j=I(),Y=d("div"),J=d("label"),pe=C("Width"),Ee=I(),$=d("div"),N=d("input"),oe=I(),F=d("select"),W=d("option"),ve=C("Bayer"),H=d("option"),Te=C("Blue Noise"),ie=I(),P=d("canvas"),se=I(),ee=d("p"),Ae=C("Right click and save the image to download it."),ae=I(),Z=d("button"),ge=C("Save"),this.h()},l(r){i=h(r,"IMG",{src:!0,alt:!0,class:!0}),t=S(r),c=h(r,"DIV",{});var u=A(c);a=h(u,"LABEL",{for:!0,class:!0});var te=A(a);s=X(te,"Threshold "),m=X(te,e[1]),te.forEach(l),p=S(u),g=h(u,"DIV",{class:!0});var Ie=A(g);E=h(Ie,"INPUT",{type:!0,min:!0,id:!0,max:!0,step:!0,class:!0}),Ie.forEach(l),u.forEach(l),D=S(r),_=h(r,"DIV",{});var le=A(_);x=h(le,"LABEL",{for:!0,class:!0});var Re=A(x);O=X(Re,"Noise Intensity "),z=X(Re,e[2]),Re.forEach(l),K=S(le),k=h(le,"DIV",{class:!0});var Se=A(k);R=h(Se,"INPUT",{type:!0,min:!0,id:!0,max:!0,step:!0,class:!0}),Se.forEach(l),le.forEach(l),V=S(r),L=h(r,"DIV",{class:!0});var ue=A(L);y=h(ue,"DIV",{class:!0});var we=A(y);T=h(we,"INPUT",{type:!0,class:!0}),we.forEach(l),U=S(ue),b=h(ue,"DIV",{class:!0});var ce=A(b);w=h(ce,"LABEL",{for:!0,class:!0});var De=A(w);q=X(De,"Monochrome"),De.forEach(l),he=S(ce),Q=h(ce,"P",{id:!0,class:!0});var Le=A(Q);_e=X(Le,"If the dither should be monochrome, or in color"),Le.forEach(l),ce.forEach(l),ue.forEach(l),re=S(r),B&&B.l(r),j=S(r),Y=h(r,"DIV",{});var fe=A(Y);J=h(fe,"LABEL",{for:!0,class:!0});var ye=A(J);pe=X(ye,"Width"),ye.forEach(l),Ee=S(fe),$=h(fe,"DIV",{class:!0});var xe=A($);N=h(xe,"INPUT",{type:!0,min:!0,id:!0,step:!0,class:!0}),xe.forEach(l),fe.forEach(l),oe=S(r),F=h(r,"SELECT",{});var Ue=A(F);W=h(Ue,"OPTION",{});var Ne=A(W);ve=X(Ne,"Bayer"),Ne.forEach(l),H=h(Ue,"OPTION",{});var Fe=A(H);Te=X(Fe,"Blue Noise"),Fe.forEach(l),Ue.forEach(l),ie=S(r),P=h(r,"CANVAS",{class:!0,width:!0,height:!0}),A(P).forEach(l),se=S(r),ee=h(r,"P",{});var Pe=A(ee);Ae=X(Pe,"Right click and save the image to download it."),Pe.forEach(l),ae=S(r),Z=h(r,"BUTTON",{});var Ce=A(Z);ge=X(Ce,"Save"),Ce.forEach(l),this.h()},h(){var r;Ge(i.src,o=(r=e[7])==null?void 0:r.src)||n(i,"src",o),n(i,"alt",""),n(i,"class","w-full pixelated svelte-1gkt69q"),n(a,"for","threshold"),n(a,"class","block text-sm font-medium leading-6 text-gray-900"),n(E,"type","range"),n(E,"min","0"),n(E,"id","threshold"),n(E,"max","1"),n(E,"step","0.01"),n(E,"class","block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),n(g,"class","mt-2"),n(x,"for","noise"),n(x,"class","block text-sm font-medium leading-6 text-gray-900"),n(R,"type","range"),n(R,"min","0"),n(R,"id","noise"),n(R,"max","1.5"),n(R,"step","0.01"),n(R,"class","block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),n(k,"class","mt-2"),n(T,"type","checkbox"),n(T,"class","h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600"),n(y,"class","flex h-6 items-center"),n(w,"for","comments"),n(w,"class","font-medium text-gray-900"),n(Q,"id","comments-description"),n(Q,"class","text-gray-500"),n(b,"class","ml-3 text-sm leading-6"),n(L,"class","relative flex items-start"),n(J,"for","width"),n(J,"class","block text-sm font-medium leading-6 text-gray-900"),n(N,"type","number"),n(N,"min","10"),n(N,"id","width"),n(N,"step","1"),n(N,"class","block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"),n($,"class","mt-2"),W.__value="bayer",W.value=W.__value,H.__value="blue_noise",H.value=H.__value,e[6]===void 0&&$e(()=>e[18].call(F)),n(P,"class","w-full pixelated svelte-1gkt69q"),n(P,"width",e[0]),n(P,"height",e[8])},m(r,u){v(r,i,u),v(r,t,u),v(r,c,u),f(c,a),f(a,s),f(a,m),f(c,p),f(c,g),f(g,E),M(E,e[1]),v(r,D,u),v(r,_,u),f(_,x),f(x,O),f(x,z),f(_,K),f(_,k),f(k,R),M(R,e[2]),v(r,V,u),v(r,L,u),f(L,y),f(y,T),T.checked=e[3],f(L,U),f(L,b),f(b,w),f(w,q),f(b,he),f(b,Q),f(Q,_e),v(r,re,u),B&&B.m(r,u),v(r,j,u),v(r,Y,u),f(Y,J),f(J,pe),f(Y,Ee),f(Y,$),f($,N),M(N,e[0]),v(r,oe,u),v(r,F,u),f(F,W),f(W,ve),f(F,H),f(H,Te),ke(F,e[6],!0),v(r,ie,u),v(r,P,u),v(r,se,u),v(r,ee,u),f(ee,Ae),v(r,ae,u),v(r,Z,u),f(Z,ge),be||(Be=[G(E,"change",e[12]),G(E,"input",e[12]),G(R,"change",e[13]),G(R,"input",e[13]),G(T,"change",e[14]),G(N,"input",e[17]),G(F,"change",e[18]),et(ne=mt.call(null,P,{image:e[7],threshold:e[1],noiseIntensity:e[2],monochrome:e[3],colorLight:e[4],colorDark:e[5],mode:e[6],width:e[0],height:e[8]})),G(Z,"click",e[10])],be=!0)},p(r,u){var te;u&128&&!Ge(i.src,o=(te=r[7])==null?void 0:te.src)&&n(i,"src",o),u&2&&Me(m,r[1]),u&2&&M(E,r[1]),u&4&&Me(z,r[2]),u&4&&M(R,r[2]),u&8&&(T.checked=r[3]),r[3]?B?B.p(r,u):(B=Ke(r),B.c(),B.m(j.parentNode,j)):B&&(B.d(1),B=null),u&1&&me(N.value)!==r[0]&&M(N,r[0]),u&64&&ke(F,r[6]),u&1&&n(P,"width",r[0]),u&256&&n(P,"height",r[8]),ne&&tt(ne.update)&&u&511&&ne.update.call(null,{image:r[7],threshold:r[1],noiseIntensity:r[2],monochrome:r[3],colorLight:r[4],colorDark:r[5],mode:r[6],width:r[0],height:r[8]})},d(r){r&&l(i),r&&l(t),r&&l(c),r&&l(D),r&&l(_),r&&l(V),r&&l(L),r&&l(re),B&&B.d(r),r&&l(j),r&&l(Y),r&&l(oe),r&&l(F),r&&l(ie),r&&l(P),r&&l(se),r&&l(ee),r&&l(ae),r&&l(Z),be=!1,qe(Be)}}}function Ke(e){let i,o,t,c,a;return{c(){i=d("input"),o=I(),t=d("input"),this.h()},l(s){i=h(s,"INPUT",{type:!0}),o=S(s),t=h(s,"INPUT",{type:!0}),this.h()},h(){n(i,"type","color"),n(t,"type","color")},m(s,m){v(s,i,m),M(i,e[4]),v(s,o,m),v(s,t,m),M(t,e[5]),c||(a=[G(i,"input",e[15]),G(t,"input",e[16])],c=!0)},p(s,m){m&16&&M(i,s[4]),m&32&&M(t,s[5])},d(s){s&&l(i),s&&l(o),s&&l(t),c=!1,qe(a)}}}function dt(e){let i,o,t,c,a,s=e[7]&&He(e);return{c(){i=d("div"),o=d("input"),t=I(),s&&s.c(),this.h()},l(m){i=h(m,"DIV",{class:!0});var p=A(i);o=h(p,"INPUT",{type:!0,id:!0,accept:!0}),t=S(p),s&&s.l(p),p.forEach(l),this.h()},h(){n(o,"type","file"),n(o,"id","image-input"),n(o,"accept","image/*"),n(i,"class","max-w-xl mx-auto px-4")},m(m,p){v(m,i,p),f(i,o),f(i,t),s&&s.m(i,null),c||(a=G(o,"input",e[9]),c=!0)},p(m,[p]){m[7]?s?s.p(m,p):(s=He(m),s.c(),s.m(i,null)):s&&(s.d(1),s=null)},i:Xe,o:Xe,d(m){m&&l(i),s&&s.d(),c=!1,a()}}}function ht(e,i,o){let t,c=.33,a=.3,s=!1,m="#ede6cc",p="#21263f",g=600,E=1,D="blue_noise",_=null;function x(T){const U=T.target.files[0];if(!U)return;const b=new FileReader;b.onload=w=>{if(typeof b.result!="string")return;const q=new Image;q.onload=()=>{o(7,_=q),o(11,E=_.width/_.height)},q.src=b.result},b.readAsDataURL(U)}je(()=>{const T=new Image;T.onload=()=>{o(7,_=T),o(11,E=_.width/_.height)},T.src=ot});function O(){const T=document.querySelector("canvas");if(!T)return;const U=document.createElement("canvas");U.width=T.width,U.height=T.height;const b=U.getContext("2d");if(!b)return;b.drawImage(T,0,0,g,t);const w=document.createElement("a");w.download="dithered.png",w.href=U.toDataURL("image/png"),w.click()}function z(){c=me(this.value),o(1,c)}function K(){a=me(this.value),o(2,a)}function k(){s=this.checked,o(3,s)}function R(){m=this.value,o(4,m)}function V(){p=this.value,o(5,p)}function L(){g=me(this.value),o(0,g)}function y(){D=rt(this),o(6,D)}return e.$$.update=()=>{e.$$.dirty&2049&&o(8,t=g/E)},[g,c,a,s,m,p,D,_,t,x,O,E,z,K,k,R,V,L,y]}class Et extends Qe{constructor(i){super(),Je(this,i,ht,dt,Ze,{})}}export{Et as component};

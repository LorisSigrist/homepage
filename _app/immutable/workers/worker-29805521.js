(function(){"use strict";function O(t){const e=new ImageData(64,64);for(let n=0;n<16;n++)for(let s=0;s<16;s++)for(let r=0;r<16;r++){const i=[n*16,s*16,r*16],[a,l]=z(i),c=I(i,t),o=4*(l*e.width+a);e.data[o]=c[0],e.data[o+1]=c[1],e.data[o+2]=c[2],e.data[o+3]=255}return e}function z(t){const[e,n,s]=t,r=Math.floor((e+n*16+s*16*16)/16),i=Math.floor(r/64),a=Math.floor(r%64);return[i,a]}function I(t,e){let n=[0,0,0],s=1/0;for(const r of e){const i=N(t,r);i<s&&(n=r,s=i)}return n}function N(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const k=Symbol("Comlink.proxy"),_=Symbol("Comlink.endpoint"),H=Symbol("Comlink.releaseProxy"),x=Symbol("Comlink.finalizer"),h=Symbol("Comlink.thrown"),S=t=>typeof t=="object"&&t!==null||typeof t=="function",W={canHandle:t=>S(t)&&t[k],serialize(t){const{port1:e,port2:n}=new MessageChannel;return M(t,e),[n,[n]]},deserialize(t){return t.start(),F(t)}},D={canHandle:t=>S(t)&&h in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},A=new Map([["proxy",W],["throw",D]]);function V(t,e){for(const n of t)if(e===n||n==="*"||n instanceof RegExp&&n.test(e))return!0;return!1}function M(t,e=globalThis,n=["*"]){e.addEventListener("message",function s(r){if(!r||!r.data)return;if(!V(n,r.origin)){console.warn(`Invalid origin '${r.origin}' for comlink proxy`);return}const{id:i,type:a,path:l}=Object.assign({path:[]},r.data),c=(r.data.argumentList||[]).map(d);let o;try{const u=l.slice(0,-1).reduce((f,m)=>f[m],t),g=l.reduce((f,m)=>f[m],t);switch(a){case"GET":o=g;break;case"SET":u[l.slice(-1)[0]]=d(r.data.value),o=!0;break;case"APPLY":o=g.apply(u,c);break;case"CONSTRUCT":{const f=new g(...c);o=X(f)}break;case"ENDPOINT":{const{port1:f,port2:m}=new MessageChannel;M(t,m),o=Y(f,[f])}break;case"RELEASE":o=void 0;break;default:return}}catch(u){o={value:u,[h]:0}}Promise.resolve(o).catch(u=>({value:u,[h]:0})).then(u=>{const[g,f]=p(u);e.postMessage(Object.assign(Object.assign({},g),{id:i}),f),a==="RELEASE"&&(e.removeEventListener("message",s),C(e),x in t&&typeof t[x]=="function"&&t[x]())}).catch(u=>{const[g,f]=p({value:new TypeError("Unserializable return value"),[h]:0});e.postMessage(Object.assign(Object.assign({},g),{id:i}),f)})}),e.start&&e.start()}function j(t){return t.constructor.name==="MessagePort"}function C(t){j(t)&&t.close()}function F(t,e){return P(t,[],e)}function w(t){if(t)throw new Error("Proxy has been released and is not useable")}function R(t){return y(t,{type:"RELEASE"}).then(()=>{C(t)})}const E=new WeakMap,b="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(E.get(t)||0)-1;E.set(t,e),e===0&&R(t)});function U(t,e){const n=(E.get(e)||0)+1;E.set(e,n),b&&b.register(t,e,t)}function G(t){b&&b.unregister(t)}function P(t,e=[],n=function(){}){let s=!1;const r=new Proxy(n,{get(i,a){if(w(s),a===H)return()=>{G(r),R(t),s=!0};if(a==="then"){if(e.length===0)return{then:()=>r};const l=y(t,{type:"GET",path:e.map(c=>c.toString())}).then(d);return l.then.bind(l)}return P(t,[...e,a])},set(i,a,l){w(s);const[c,o]=p(l);return y(t,{type:"SET",path:[...e,a].map(u=>u.toString()),value:c},o).then(d)},apply(i,a,l){w(s);const c=e[e.length-1];if(c===_)return y(t,{type:"ENDPOINT"}).then(d);if(c==="bind")return P(t,e.slice(0,-1));const[o,u]=T(l);return y(t,{type:"APPLY",path:e.map(g=>g.toString()),argumentList:o},u).then(d)},construct(i,a){w(s);const[l,c]=T(a);return y(t,{type:"CONSTRUCT",path:e.map(o=>o.toString()),argumentList:l},c).then(d)}});return U(r,t),r}function q(t){return Array.prototype.concat.apply([],t)}function T(t){const e=t.map(p);return[e.map(n=>n[0]),q(e.map(n=>n[1]))]}const L=new WeakMap;function Y(t,e){return L.set(t,e),t}function X(t){return Object.assign(t,{[k]:!0})}function p(t){for(const[e,n]of A)if(n.canHandle(t)){const[s,r]=n.serialize(t);return[{type:"HANDLER",name:e,value:s},r]}return[{type:"RAW",value:t},L.get(t)||[]]}function d(t){switch(t.type){case"HANDLER":return A.get(t.name).deserialize(t.value);case"RAW":return t.value}}function y(t,e,n){return new Promise(s=>{const r=$();t.addEventListener("message",function i(a){!a.data||!a.data.id||a.data.id!==r||(t.removeEventListener("message",i),s(a.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:r},e),n)})}function $(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}M({generatePalette:O})})();
